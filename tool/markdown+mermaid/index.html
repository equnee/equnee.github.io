<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=0"><meta name="description" content="用 Markdown + Mermaid 写文档 [ 🍧 Peach ] "><meta name="theme-color"><title>用 Markdown + Mermaid 写文档 [ 🍧 Peach ] </title><link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/css/index.css"><script src="https://cdn.bootcss.com/highlight.js/9.6.0/highlight.min.js" defer></script><script src="/js/paper.js" defer></script><script src="https://www.googletagmanager.com/gtag/js?id=G-5GZQ6P3RMX" async></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-5GZQ6P3RMX');</script><script src="https://www.unpkg.com/valine/dist/Valine.min.js" defer></script><script>window.addEventListener('DOMContentLoaded', () => {
  new Valine({
    el: '#comments',
    appId: 'MJAdR7lH7cWVJLyn1Tgnw5Sj-gzGzoHsz',
    appKey: 'de2VP0VpE5bWgR2aA8wkwxn2',
    notify: false,
    verify: false,
    avatar: 'mp',
    placeholder: 'say something',
  })
})</script><script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js" defer></script><script>window.addEventListener('DOMContentLoaded', () => {
  tocbot.init({
    // Where to render the table of contents.
    tocSelector: '.toc__content',
    // Where to grab the headings to build the table of contents.
    contentSelector: '.article__content',
    // Which headings to grab inside of the contentSelector element.
    headingSelector: 'h1, h2, h3, h4, h5, h6',
    // For headings inside relative or absolute positioned containers within content.
    hasInnerContainers: true,
    orderedList: false,
    collapseDepth: 2,
  });
})</script><link rel="preload" href="https://cdn.bootcss.com/highlight.js/9.6.0/styles/github.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><link rel="stylesheet" href="https://cdn.bootcss.com/highlight.js/9.6.0/styles/github.min.css"><link rel="preload" href="https://fonts.googleapis.com/css?family=Abril+Fatface&amp;display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface&amp;display=swap"><link rel="preload" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@200;300;400;500;600;700;900&amp;display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@200;300;400;500;600;700;900&amp;display=swap"><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css"><meta name="generator" content="Hexo 5.4.2"></head><body><div class="mask-border"></div><div class="head"><div class="head__inner"><h1><a href="/">🍧 Peach</a></h1><p>蜜桃想学打代码</p></div></div><div class="paper-container"><div class="main"><div class="location-bar"><div class="line-1"><div class="horizontal-line" style="height: 3px"></div></div><div class="line-2"><div class="horizontal-line" style="height: 1px"></div></div><p class="text">用 Markdown + Mermaid 写文档</p><div class="switch-button"><input class="container_toggle" type="checkbox" id="switch" name="mode"><label for="switch">Toggle</label></div><div class="line-3"><div class="horizontal-line" style="height: 1px"></div></div></div><div class="main__2-col"><article class="post-view__article"><div class="article__infomation"><div class="posts-item"><h2 class="posts-item__title"><a href="">用 Markdown + Mermaid 写文档</a></h2><span class="post__date">2020-04-02</span><a href="/tags/Mermaid/"><span class="post__tags">#Mermaid</span></a><a href="/tags/Markdown/"><span class="post__tags">#Markdown</span></a></div></div><div class="article__content"><h2 id="一-Markdown"><a href="#一-Markdown" class="headerlink" title="一. Markdown"></a>一. Markdown</h2><h2 id="二-Mermaid"><a href="#二-Mermaid" class="headerlink" title="二. Mermaid"></a>二. Mermaid</h2><h3 id="1-mermaid-语法"><a href="#1-mermaid-语法" class="headerlink" title="1. mermaid 语法"></a>1. mermaid 语法</h3><ul>
<li><a href="https://mermaid.js.org/">Mermaid</a>是一种基于Javascript的绘图工具，使用类似于Markdown的语法，可以方便快捷地通过代码创建和修改图表。掌握了Markdown语法后，学习Mermaid就不成问题。</li>
<li>可创建：</li>
</ul>
<h3 id="2-Hexo-mermaid插件"><a href="#2-Hexo-mermaid插件" class="headerlink" title="2. Hexo + mermaid插件"></a>2. Hexo + mermaid插件</h3><blockquote>
<p>from: <a href="https://github.com/webappdevelp/hexo-filter-mermaid-diagrams">https://github.com/webappdevelp/hexo-filter-mermaid-diagrams</a></p>
</blockquote>
<h4 id="（1）安装插件"><a href="#（1）安装插件" class="headerlink" title="（1）安装插件"></a>（1）安装插件</h4><figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">$ yarn add hexo-filter-mermaid-diagrams <br>或 $ npm install hexo-filter-mermaid-diagrams<br></code></pre></td></tr></table></figure>

<h4 id="（2）编辑配置"><a href="#（2）编辑配置" class="headerlink" title="（2）编辑配置"></a>（2）编辑配置</h4><p>安装完成后，编辑hexo配置文件：<code>config.yml</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><code class="hljs plaintext"># mermaid chart<br>mermaid: <br>  enable: true  <br>  version: &quot;7.1.2&quot; <br>  options:  <br></code></pre></td></tr></table></figure>

<h4 id="（3）添加脚本"><a href="#（3）添加脚本" class="headerlink" title="（3）添加脚本"></a>（3）添加脚本</h4><p>修改完配置文件后，编辑博客页面组件的footer部分。这是为了将 mermaid.js 以 script 形式插入到 html 尾部，使其能正常渲染。</p>
<p>footer文件如，<code>footer.pug</code>， <code>after_footer.pug</code> , <code>after-footer.ejs</code> 或 <code>swig</code>，该文件通常存放在主题目录下的<code>layout</code>目录中。</p>
<p>若博客使用pug模版引擎渲染，在 <code>after_footer.pug</code>文件中添加如下代码:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><code class="hljs pug">if theme.mermaid.enable == true<br>  script(type=&#x27;text/javascript&#x27;, id=&#x27;maid-script&#x27; mermaidoptioins=theme.mermaid.options src=&#x27;https://unpkg.com/mermaid@&#x27;+ theme.mermaid.version + &#x27;/dist/mermaid.min.js&#x27; + &#x27;?v=&#x27; + theme.version)<br>  script.<br>    if (window.mermaid) &#123;<br>      var options = JSON.parse(document.getElementById(&#x27;maid-script&#x27;).getAttribute(&#x27;mermaidoptioins&#x27;));<br>      mermaid.initialize(options);<br>    &#125;<br></code></pre></td></tr></table></figure>

<p>若使用ejs引擎渲染，则在<code>after-footer.ejs</code>文件中添加如下代码：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><code class="hljs plaintext">&lt;% if (theme.mermaid.enable) &#123; %&gt;<br>  &lt;script src=&#x27;https://unpkg.com/mermaid@&lt;%= theme.mermaid.version %&gt;/dist/mermaid.min.js&#x27;&gt;&lt;/script&gt;<br>  &lt;script&gt;<br>    if (window.mermaid) &#123;<br>      mermaid.initialize(&#123;theme: &#x27;neutral&#x27;&#125;);<br>    &#125;<br>  &lt;/script&gt;<br>&lt;% &#125; %&gt;<br></code></pre></td></tr></table></figure>

<p>swig模版引擎：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><code class="hljs plaintext">&#123;% if theme.mermaid.enable %&#125;<br>  &lt;script src=&#x27;https://unpkg.com/mermaid@&#123;&#123; theme.mermaid.version &#125;&#125;/dist/mermaid.min.js&#x27;&gt;&lt;/script&gt;<br>  &lt;script&gt;<br>    if (window.mermaid) &#123;<br>      mermaid.initialize(&#123;&#123; JSON.stringify(theme.mermaid.options) &#125;&#125;);<br>    &#125;<br>  &lt;/script&gt;<br>&#123;% endif %&#125;<br></code></pre></td></tr></table></figure>

<h4 id="（4）踩坑"><a href="#（4）踩坑" class="headerlink" title="（4）踩坑"></a>（4）踩坑</h4><p>以上为官方文档中的配置方法，而我在配置的时间过程中，还遇到以下问题可供参考：</p>
<ol>
<li><p><strong>html页面中，mermaid段落仅显示为<u><em>代码块</em></u>，开发者工具中该段落为普通源代码。</strong></p>
<p>这是因为插件没有生效，应确保正确完成上面两个步骤（安装插件、打开配置）。</p>
</li>
</ol>
<ol start="2">
<li><p><strong>html页面中，mermaid段落显示为<u><em>空白图片</em></u>，开发者工具中查看该段落为<code>svg</code>文件，<br>控制台报错： Uncaught TypeError: Cannot read properties of null (reading’mermaid’)。</strong></p>
<p>此时插件已经生效，而js代码文件引入有误，无法成功渲染。</p>
<p>继续查看html代码发现，文件底部的<code>&lt;sctipt&gt;</code>标签中，显示我引入mermaid的url为：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;maid-script&quot;</span> </span><br><span class="hljs-tag">        <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://unpkg.com/mermaid@10.0.2/dist/mermaid.min.js?v=undefined&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>这段代码是由官方提供的脚本，在<code>footer</code>文件中根据用户的配置组合成的：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript">script(type=<span class="hljs-string">&#x27;text/javascript&#x27;</span>, id=<span class="hljs-string">&#x27;maid-script&#x27;</span> <br>mermaidoptioins=theme.mermaid.options src=<span class="hljs-string">&#x27;https://unpkg.com/mermaid@&#x27;</span>+ theme.mermaid.version + <span class="hljs-string">&#x27;/dist/mermaid.min.js&#x27;</span> + <span class="hljs-string">&#x27;?v=&#x27;</span> + theme.version)<br></code></pre></td></tr></table></figure>

<p>如果配置有误则会生成错误的url，看起来是version的问题，于是我将url改为直接引入<code>jsdelivr</code>上的资源，遂能正常渲染：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript">src=<span class="hljs-string">&#x27;https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js&#x27;</span>)<br></code></pre></td></tr></table></figure>

</li>
</ol>
</div></article><div class="post-view__sidebar"><div class="sidebar"><div class="tocbot"><h2>Toc</h2><div class="toc__content"></div></div><h2>Links</h2><div class="sidebar__link"><ul><li><a href="https://github.com/equnee">Github</a></li><li><a href="https://codepen.io/equne">Codepen</a></li><li><a href="mailto:equne@qq.com">Mail</a></li></ul></div><h2>Friends</h2><div class="sidebar__friend"></div><h2>Archives</h2><div class="sidebar__archives"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/">2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/">2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/">2020</a></li></ul></div><h2>Categories</h2><div class="sidebar__categories"><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%B7%A5%E5%85%B7/">工具</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">设计模式</a></li></ul></div><h2>Tags</h2><div class="sidebar__tags"><ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mac/" rel="tag">Mac</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Markdown/" rel="tag">Markdown</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mermaid/" rel="tag">Mermaid</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/singleton/" rel="tag">singleton</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/windows/" rel="tag">windows</a></li></ul></div></div></div></div><div class="horizontal-line" style="height: 1px"></div><div class="main__bottom"><div class="pre-next"><a class="pre-button" href="/guide/mac_mrd_windows/">Mac远程连接Windows（Microsoft Remote Desktop）</a><a class="next-button">没有更多</a></div><div id="comments"></div></div></div></div><div class="footer"><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span>©️2019-2023 Author By  <b><a class="link" href="https://github.com/equnee">equne</a></b></span><span>&nbsp;Powered By <b><a class="link" href="https://hexo.io/zh-cn/">hexo  </a></b></span><script type="text/javascript" id="maid-script" src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script><script>if (window.mermaid) {
  var options = JSON.parse(document.getElementById('maid-script').getAttribute('mermaidoptioins'));
  mermaid.initialize({
    securityLevel: 'loose',
    theme: 'neutral',
  });
}</script></div><div class="darkmode-mask" id="darkmode-mask"></div><div class="sidebar__button"></div></body></html>