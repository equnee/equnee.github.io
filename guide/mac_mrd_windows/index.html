<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=0"><meta name="description" content="Mac远程连接Windows（Microsoft Remote Desktop） [ 🍧 Peach ] "><meta name="theme-color"><title>Mac远程连接Windows（Microsoft Remote Desktop） [ 🍧 Peach ] </title><link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/css/index.css"><script src="https://cdn.bootcss.com/highlight.js/9.6.0/highlight.min.js" defer></script><script src="/js/paper.js" defer></script><script src="https://www.googletagmanager.com/gtag/js?id=G-5GZQ6P3RMX" async></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-5GZQ6P3RMX');</script><script src="https://www.unpkg.com/valine/dist/Valine.min.js" defer></script><script>window.addEventListener('DOMContentLoaded', () => {
  new Valine({
    el: '#comments',
    appId: 'MJAdR7lH7cWVJLyn1Tgnw5Sj-gzGzoHsz',
    appKey: 'de2VP0VpE5bWgR2aA8wkwxn2',
    notify: false,
    verify: false,
    avatar: 'mp',
    placeholder: 'say something',
  })
})</script><script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js" defer></script><script>window.addEventListener('DOMContentLoaded', () => {
  tocbot.init({
    // Where to render the table of contents.
    tocSelector: '.toc__content',
    // Where to grab the headings to build the table of contents.
    contentSelector: '.article__content',
    // Which headings to grab inside of the contentSelector element.
    headingSelector: 'h1, h2, h3, h4, h5, h6',
    // For headings inside relative or absolute positioned containers within content.
    hasInnerContainers: true,
    orderedList: false,
    collapseDepth: 2,
  });
})</script><link rel="preload" href="https://cdn.bootcss.com/highlight.js/9.6.0/styles/github.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><link rel="stylesheet" href="https://cdn.bootcss.com/highlight.js/9.6.0/styles/github.min.css"><link rel="preload" href="https://fonts.googleapis.com/css?family=Abril+Fatface&amp;display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface&amp;display=swap"><link rel="preload" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@200;300;400;500;600;700;900&amp;display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@200;300;400;500;600;700;900&amp;display=swap"><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css"><meta name="generator" content="Hexo 5.4.2"></head><body><div class="mask-border"></div><div class="head"><div class="head__inner"><h1><a href="/">🍧 Peach</a></h1><p>蜜桃想写可爱的代码</p></div></div><div class="paper-container"><div class="main"><div class="location-bar"><div class="line-1"><div class="horizontal-line" style="height: 3px"></div></div><div class="line-2"><div class="horizontal-line" style="height: 1px"></div></div><p class="text">Mac远程连接Windows（Microsoft Remote Desktop）</p><div class="switch-button"><input class="container_toggle" type="checkbox" id="switch" name="mode"><label for="switch">Toggle</label></div><div class="line-3"><div class="horizontal-line" style="height: 1px"></div></div></div><div class="main__2-col"><article class="post-view__article"><div class="article__infomation"><div class="posts-item"><h2 class="posts-item__title"><a href="">Mac远程连接Windows（Microsoft Remote Desktop）</a></h2><span class="post__date">2021-03-25</span><a href="/tags/windows/"><span class="post__tags">#windows</span></a><a href="/tags/Mac/"><span class="post__tags">#Mac</span></a></div></div><div class="article__content"><blockquote>
<ul>
<li><strong>摘要</strong>: 同时带两台电脑出门很麻烦，于是选择在Mac上使用 Microsoft Remote Desktop 远程连接使用不带出门的 Windows，从此只需要把Windows放在家里连接电源和wifi一直放着就行！顺便整理了一些别人遇到的错误和解决方法。</li>
<li><strong>日期</strong>: 2021/3/25 </li>
<li><strong>环境</strong> : MacOS 11.2.2 + Windows10</li>
</ul>
</blockquote>
<p><img src="https://equne.oss-cn-hangzhou.aliyuncs.com/typora/1-20230307143836102.jpeg" alt="1"></p>
<h1 id="一-软件下载"><a href="#一-软件下载" class="headerlink" title="一. 软件下载"></a>一. 软件下载</h1><p>下载 Microsoft Remote Desktop，根据情况下载对应版本的app：</p>
<ol>
<li>使用 <strong>Windows</strong> 控制 windows：&gt;<a href="https://www.microsoft.com/en-us/download/confirmation.aspx?id=50042">&gt; 官网下载</a></li>
<li>使用 <strong>Mac</strong> 控制 windows：<ul>
<li>App Store 下载，仅国外的应用商店提供下载，因此只能使用国外的 AppleID，可参考&gt; <a href="https://zhuanlan.zhihu.com/p/49754407?utm_source=com.vivo.favorite">&gt; 国外AppleID申请方法</a>。</li>
<li>其他渠道下载（俺也没试过</li>
</ul>
</li>
</ol>
<br>

<hr>
<h1 id="二-创建连接"><a href="#二-创建连接" class="headerlink" title="二. 创建连接"></a>二. 创建连接</h1><h2 id="2-1-Windows-配置"><a href="#2-1-Windows-配置" class="headerlink" title="2.1 Windows 配置"></a>2.1 Windows 配置</h2><blockquote>
<p>首先确保将被控制的 Windows 开启了远程桌面连接配置：</p>
</blockquote>
<h3 id="（1）系统属性"><a href="#（1）系统属性" class="headerlink" title="（1）系统属性"></a>（1）系统属性</h3><ul>
<li><p>设置了系统属性为允许远程桌面连接</p>
  <img src="https://equne.oss-cn-hangzhou.aliyuncs.com/typora/2.jpeg" alt="2" style="zoom:40%;" />

<p>  <img src="https://equne.oss-cn-hangzhou.aliyuncs.com/typora/3.jpeg" alt="3"></p>
</li>
<li><p>若选项都是灰色无法允许远程连接，&gt; <a href="https://answers.microsoft.com/zh-hans/windows/forum/all/win10专业版远程/55314ea4-0198-4df2-9378-7130b62d80b9">参考这里</a>。</p>
<blockquote>
<p>运行 gpedit.msc 回车打开本地组策略编辑器,在左侧的列表中依次展开：<strong>计算机配置&gt;管理模板&gt;Windows组件&gt;远程桌面会话主机&gt;连接</strong></p>
<p>双击打开右侧的”<strong>允许用户通过使用远程桌面服务进行远程连接</strong>“,看一下之前是否有配置,如果有的话改成”未配置”,如果之前就是未配置,那可以改成已启用,然后您再看一下系统属性&gt;远程桌面中的相关设置区域是否恢复正常.</p>
</blockquote>
</li>
</ul>
<h3 id="（2）防火墙"><a href="#（2）防火墙" class="headerlink" title="（2）防火墙"></a>（2）防火墙</h3><ul>
<li>设置了防火墙允许远程桌面通过防火墙通信<img src="https://equne.oss-cn-hangzhou.aliyuncs.com/typora/4.jpeg" alt="4"></li>
</ul>
<h3 id="（3）端口"><a href="#（3）端口" class="headerlink" title="（3）端口"></a>（3）端口</h3><ul>
<li><p>开启了用于远程桌面连接的服务端口：</p>
<p>  在cmd中输入<code>netstat -aon|findstr 3389</code>，查看默认端口号3389是否开启。</p>
<p>  <img src="https://equne.oss-cn-hangzhou.aliyuncs.com/typora/5.jpeg" alt="5"></p>
</li>
<li><p>若端口号未开启：打开任务管理器，开启下面两项服务。（UmRdpServise可播放声音)<img src="https://equne.oss-cn-hangzhou.aliyuncs.com/typora/6.jpeg" alt="6"></p>
</li>
<li><p>若修改过或无法查询到3389端口，&gt; <a href="https://my.oschina.net/xxxasec/blog/4837755">参考这里</a>。</p>
</li>
</ul>
<h3 id="（4）本地策略"><a href="#（4）本地策略" class="headerlink" title="（4）本地策略"></a>（4）本地策略</h3><ul>
<li>设置本地策略非来宾。在运行中输入：<code>gpedit.msc</code><br>  <img src="https://equne.oss-cn-hangzhou.aliyuncs.com/typora/7.jpeg" alt="7"></li>
</ul>
<h3 id="（5）关闭-Windows-hello"><a href="#（5）关闭-Windows-hello" class="headerlink" title="（5）关闭 Windows hello"></a>（5）关闭 Windows hello</h3><ul>
<li><p>确保关闭了设置内 仅允许 Windows hello 登录</p>
</li>
<li><p>(未设置可忽略。) Windows Hello：使您可以使用脸部，虹膜，指纹或PIN登录设备，应用程序，在线服务和网络。</p>
<p><img src="https://equne.oss-cn-hangzhou.aliyuncs.com/typora/8.jpeg" alt="8"></p>
</li>
</ul>
<h3 id="（6）AAD"><a href="#（6）AAD" class="headerlink" title="（6）AAD"></a>（6）AAD</h3><ul>
<li><p>确保不是通过 <strong>Microsoft Authenticator ，而是通过手动输入密码进行验证登录的</strong>：</p>
<p>因为 Microsoft Authenticator 登录使用的认证方式与其他域不互通，就不能直接开启连接啦。</p>
<img src="https://equne.oss-cn-hangzhou.aliyuncs.com/typora/9.jpeg" alt="9" style="zoom:50%;" />

</li>
</ul>
<h2 id="2-2-添加计算机"><a href="#2-2-添加计算机" class="headerlink" title="2.2 添加计算机"></a>2.2 添加计算机</h2><blockquote>
<p>配置Windows允许远程桌面连接后，使用Mac准备开始连接，在Microsoft Remote Desktop中添加PC，输入主机名 + 用户账号信息。</p>
</blockquote>
<ul>
<li><p><strong>PC name</strong>：IP地址。</p>
<p>查看方法：在 Windows 的命令提示符(win+R 键打开的运行窗口输入cmd) 输入命令 <code>ipconfig</code>，可查看ipv4地址。</p>
</li>
<li><p><strong>User account</strong>：登录该PC的账号密码。建议选择 Ask when required，先不输入账号密码，在连接时输入，确保能连接成功后再添加记录，防止这里保存的账号密码有误，后面怎么都连不上。</p>
<img src="https://equne.oss-cn-hangzhou.aliyuncs.com/typora/10.jpeg" alt="10" style="zoom:50%;" />

</li>
</ul>
<h2 id="2-3-填写账户信息"><a href="#2-3-填写账户信息" class="headerlink" title="2.3 填写账户信息"></a>2.3 填写账户信息</h2><h3 id="（1）-本地用户"><a href="#（1）-本地用户" class="headerlink" title="（1） 本地用户"></a>（1） 本地用户</h3><ul>
<li><p>使用本地用户名登录：</p>
<p><strong>本地用户名</strong>(cmd输入 <code>whoami</code> 查看) + <strong>本地解锁密码</strong>。</p>
</li>
</ul>
<h3 id="（2）-微软账户"><a href="#（2）-微软账户" class="headerlink" title="（2） 微软账户"></a>（2） 微软账户</h3><ul>
<li><p>使用微软账户登录：</p>
<p>本地创建的英文账户若关联了微软账号，可使用该微软账号邮箱进行远程登录，用户名为邮箱格式的<strong>微软账号</strong>(<em><a href="mailto:username@outlook.com">username@outlook.com</a></em>) + 对应的<strong>微软账号密码。</strong>    </p>
  <img src="https://equne.oss-cn-hangzhou.aliyuncs.com/typora/11.jpeg" alt="11" style="zoom:50%;" />



</li>
</ul>
<h3 id="（3）-空密码"><a href="#（3）-空密码" class="headerlink" title="（3） 空密码"></a>（3） 空密码</h3><ul>
<li><p>或使用空密码进行远程桌面连接：在 windows 中设置 </p>
<p>打开运行，输入<code>gpedit.msc</code>，打开本地组策略编辑器</p>
<p><img src="https://equne.oss-cn-hangzhou.aliyuncs.com/typora/12.jpeg" alt="12"></p>
</li>
</ul>
<h2 id="2-4-报错解决"><a href="#2-4-报错解决" class="headerlink" title="2.4 报错解决"></a>2.4 报错解决</h2><h3 id="（1）-The-User-Account-Did-Not-work"><a href="#（1）-The-User-Account-Did-Not-work" class="headerlink" title="（1） The User Account Did Not work"></a>（1） The User Account Did Not work</h3><blockquote>
<p>🔒 <strong>提示</strong>：The User Account Did Not Work.The user account used to connect to xx.xx.xx.xx (remote PC) did not work. Try again.（–&gt; 你输的这个账户信息连不上。）</p>
</blockquote>
<ul>
<li>🔑 <strong>解决方法</strong>：需要输入正确的账号密码。<ol>
<li><strong>微软账号登录</strong>：邮箱格式的微软账号(<a href="mailto:username@outlook.com">username@outlook.com</a>) + 对应的微软账号密码</li>
<li><strong>本地用户登录</strong>：本地主机名或本地账户名 + 本地账户解锁密码</li>
<li><strong>以前可以，现在突然连不上了</strong>：检查上面两个密码是不是改过了，如果改过记得同步修改。</li>
</ol>
</li>
</ul>
<h3 id="（2）-0x204"><a href="#（2）-0x204" class="headerlink" title="（2）  0x204"></a>（2）  0x204</h3><blockquote>
<p>🔒 连接时提示：We couldn’t connect to the remote PC.Make sure the PC is turned on and connected to the network, and thar remote access is enabled. Error code:0x204（–&gt; 我们无法连接到远程电脑，确保电脑已打开并连接到网络，并且已启用远程访问。）</p>
</blockquote>
<ul>
<li><strong>🔑 解决方法：</strong><ol>
<li><strong>开电脑。</strong>检查是否打开windows电源，确保非关机或睡眠状态，开启电源解锁屏幕就可以啦。</li>
<li><strong>连Wi-Fi。</strong></li>
<li><strong>开服务</strong>。确保已开启 Windows 的远程桌面连接配置。</li>
</ol>
</li>
</ul>
<h3 id="（3）-0x207"><a href="#（3）-0x207" class="headerlink" title="（3）  0x207"></a>（3）  0x207</h3><blockquote>
<p><strong>🔒 提示：</strong></p>
</blockquote>
<ul>
<li>🔑：确保windows的本地组策略不是 <strong>仅来宾</strong> 状态。</li>
</ul>
<hr>
<h1 id="三-Mac配置"><a href="#三-Mac配置" class="headerlink" title="三. Mac配置"></a>三. Mac配置</h1><h2 id="3-1-创建目录"><a href="#3-1-创建目录" class="headerlink" title="3.1 创建目录"></a>3.1 创建目录</h2><ul>
<li>在mac电脑上，根据需要创建用于文件传输的目录。</li>
</ul>
<h2 id="3-2-编辑配置"><a href="#3-2-编辑配置" class="headerlink" title="3.2 编辑配置"></a>3.2 编辑配置</h2><ul>
<li><p>开启Microsoft Remote Desktop 软件，点击编辑。</p>
<img src="https://equne.oss-cn-hangzhou.aliyuncs.com/typora/13.jpeg" alt="13" style="zoom: 50%;" />
</li>
<li><p>如图所示，添加重定向刚创建的文件夹对应的路径</p>
<img src="https://equne.oss-cn-hangzhou.aliyuncs.com/typora/14.jpeg" alt="14" style="zoom:50%;" />

</li>
</ul>
<h2 id="3-3-完成"><a href="#3-3-完成" class="headerlink" title="3.3 完成"></a>3.3 完成</h2><ul>
<li><p>可查看windows上的文件夹映射，没出现的话重新连接试试。</p>
<p><img src="https://equne.oss-cn-hangzhou.aliyuncs.com/typora/15.jpeg" alt="15"></p>
</li>
</ul>
<hr>
<h1 id="四-结尾"><a href="#四-结尾" class="headerlink" title="四. 结尾"></a>四. 结尾</h1><p>第一次完成mac和windows之间远程桌面的配置，回头看感觉写得有些复杂，因为多记录了一些自己也没遇到过的问题和情况。如果各位还遇到了文中没提到的情况，欢迎评论留言，我会继续补充～</p>
</div></article><div class="post-view__sidebar"><div class="sidebar"><div class="tocbot"><h2>Toc</h2><div class="toc__content"></div></div><h2>Links</h2><div class="sidebar__link"><ul><li><a href="https://github.com/equnee">Github</a></li><li><a href="https://codepen.io/equne">Codepen</a></li><li><a href="mailto:equne@qq.com">Mail</a></li></ul></div><h2>Friends</h2><div class="sidebar__friend"></div><h2>Archives</h2><div class="sidebar__archives"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/">2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/">2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/">2020</a></li></ul></div><h2>Categories</h2><div class="sidebar__categories"><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%B7%A5%E5%85%B7/">工具</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">数据结构</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">设计模式</a></li></ul></div><h2>Tags</h2><div class="sidebar__tags"><ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Chain/" rel="tag">Chain</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HashMap/" rel="tag">HashMap</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mac/" rel="tag">Mac</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Markdown/" rel="tag">Markdown</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mermaid/" rel="tag">Mermaid</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TreeNode/" rel="tag">TreeNode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/singleton/" rel="tag">singleton</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/windows/" rel="tag">windows</a></li></ul></div></div></div></div><div class="horizontal-line" style="height: 1px"></div><div class="main__bottom"><div class="pre-next"><a class="pre-button" href="/note/Design-pattern/design-pattern_Singleton/">🌷 设计模式 - 单例</a><a class="next-button" href="/tool/markdown+mermaid/">超棒的文档神器搭档！Markdown+ Mermaid</a></div><div id="comments"></div></div></div></div><div class="footer"><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span>©️2019-2023 Author By  <b><a class="link" href="https://github.com/equnee">equne</a></b></span><span>&nbsp;Powered By <b><a class="link" href="https://hexo.io/zh-cn/">hexo  </a></b></span><script type="text/javascript" id="maid-script" src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script><script>if (window.mermaid) {
  var options = JSON.parse(document.getElementById('maid-script').getAttribute('mermaidoptioins'));
  mermaid.initialize({
    securityLevel: 'loose',
    theme: 'neutral',
  });
}</script></div><div class="darkmode-mask" id="darkmode-mask"></div><div class="sidebar__button"></div></body></html>