<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=0"><meta name="description" content="IO - åºåˆ—åŒ–/ååºåˆ—åŒ– [ ğŸ§ Peach ] "><meta name="theme-color"><title>IO - åºåˆ—åŒ–/ååºåˆ—åŒ– [ ğŸ§ Peach ] </title><link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="/css/mermaid.css"><script src="https://cdn.bootcss.com/highlight.js/9.6.0/highlight.min.js" defer></script><script src="/js/paper.js" defer></script><script src="https://www.googletagmanager.com/gtag/js?id=G-5GZQ6P3RMX" async></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-5GZQ6P3RMX');</script><script src="https://www.unpkg.com/valine/dist/Valine.min.js" defer></script><script>window.addEventListener('DOMContentLoaded', () => {
  new Valine({
    el: '#comments',
    appId: 'MJAdR7lH7cWVJLyn1Tgnw5Sj-gzGzoHsz',
    appKey: 'de2VP0VpE5bWgR2aA8wkwxn2',
    notify: false,
    verify: false,
    avatar: 'mp',
    placeholder: 'say something',
  })
})</script><script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js" defer></script><script>window.addEventListener('DOMContentLoaded', () => {
  tocbot.init({
    // Where to render the table of contents.
    tocSelector: '.toc__content',
    // Where to grab the headings to build the table of contents.
    contentSelector: '.article__content',
    // Which headings to grab inside of the contentSelector element.
    headingSelector: 'h1, h2, h3, h4, h5, h6',
    // For headings inside relative or absolute positioned containers within content.
    hasInnerContainers: true,
    orderedList: false,
    collapseDepth: 2,
  });
})</script><link rel="preload" href="https://cdn.bootcss.com/highlight.js/9.6.0/styles/github.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><link rel="stylesheet" href="https://cdn.bootcss.com/highlight.js/9.6.0/styles/github.min.css"><link rel="preload" href="https://fonts.googleapis.com/css?family=Abril+Fatface&amp;display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface&amp;display=swap"><link rel="preload" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@300;400;500;600;700&amp;display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@300;400;500;600;700&amp;display=swap"><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css"><meta name="generator" content="Hexo 5.4.2"></head><body><div class="mask-border"></div><div class="head"><div class="head__inner"><h1><a href="/">ğŸ§ Peach</a></h1><p>èœœæ¡ƒå­¦ä»£ç </p></div></div><div class="paper-container"><div class="main"><div class="location-bar"><div class="line-1"><div class="horizontal-line" style="height: 3px"></div></div><div class="line-2"><div class="horizontal-line" style="height: 1px"></div></div><p class="text">IO - åºåˆ—åŒ–/ååºåˆ—åŒ–</p><div class="switch-button"><input class="container_toggle" type="checkbox" id="switch" name="mode"><label for="switch">Toggle</label></div><div class="line-3"><div class="horizontal-line" style="height: 1px"></div></div></div><div class="main__2-col"><article class="post-view__article"><div class="article__infomation"><div class="posts-item"><h2 class="posts-item__title"><a href="">IO - åºåˆ—åŒ–/ååºåˆ—åŒ–</a></h2><span class="post__date">2023-05-05</span><a href="/tags/Java/"><span class="post__tags">#Java</span></a><a href="/tags/I-O/"><span class="post__tags">#I/O</span></a></div></div><div class="article__content"><div>
  <!--  bgcolor="#fdeff2" -->
    <table style="font-size:11px;width:100%;">
        <tr>
            <th colspan="2">java.io - ç›®å½•</th>
        </tr>
        <tr>
            <td rowspan="2" style="text-align:center">æ ‡å‡†è®¾å¤‡è¾“å…¥/è¾“å‡º</td>
            <td>
                <a href="https://equnee.github.io/note/Basics/IO/IO_StandardIO/">æ ‡å‡†è®¾å¤‡è¾“å…¥/è¾“å‡ºï¼šSystem</a>
            </td>
        </tr>
        <tr>
            <td>
                <a href="https://equnee.github.io/note/Basics/IO/IO_StandardIO/">æ§åˆ¶å°è¯»å†™ç±»ï¼šConsole</a>
            </td>
        </tr>
        <tr>
            <td rowspan="3" style="text-align:center">æ–‡ä»¶åŸºæœ¬å¤„ç†</td>
            <td>
                <a href="https://equnee.github.io//note/Basics/IO/IO_File/">æ–‡ä»¶æ“ä½œç±»ï¼šFile</a>
            </td>
        </tr>
        <tr>
            <td>
                <a href="https://equnee.github.io//note/Basics/IO/IO_File/">æ–‡ä»¶æœç´¢ç±»ï¼šFileFilterã€FilenameFilter</a>
            </td>
        </tr>
        <tr>
            <td>
                <a href="https://equnee.github.io/note/Basics/IO/IO_RandomAccessFile/">æ–‡ä»¶ä»»æ„è¯»å†™ç±»ï¼šRandomAccessFile</a>
            </td>
        </tr>
        <tr>
      <td rowspan="3" style="text-align:center" bgcolor="#fdeff2"><b>è¾“å…¥/è¾“å‡ºæµ</b></td>
            <td colspan="2">
                <a href="https://equnee.github.io/note/Basics/IO/IO_IO_1/">è¾“å…¥/è¾“å‡ºæµ - åˆ†ç±»</a>
            </td>
        </tr>
        <tr>
            <td colspan="2">        
        <a href="https://equnee.github.io/note/Basics/IO/IO_IO_2/"><b>è¾“å…¥/è¾“å‡ºæµ - å®ç°ç±»</b></a>
            </td>
        </tr>
        <tr>
            <td colspan="2" bgcolor="#fdeff2">
                <a href="https://equnee.github.io/note/Basics/IO/IO_Object_serialization/">åºåˆ—åŒ–/ååºåˆ—åŒ–</a>
            </td>
        </tr>
    </table>
</div>
<hr style="height:2px;border:none;border-top:1px dashed #dedede;"/>



<p><strong>åºåˆ—åŒ–</strong>ï¼šå°†ç¨‹åºä¸­çš„ç»“æ„ä½“ã€å¯¹è±¡ç­‰ç»“æ„åŒ–å†…å­˜å¯¹è±¡è½¬æ¢ä¸ºæ‰å¹³çš„äºŒè¿›åˆ¶æµï¼›<br><strong>ååºåˆ—åŒ–</strong>ï¼šå°†äºŒè¿›åˆ¶æµè¿˜åŸä¸ºç»“æ„åŒ–å†…å­˜å¯¹è±¡ã€‚</p>
<pre class="mermaid">%%{
  init: {
    'themeVariables': {
       'fontSize': '14px'
     }
  }
}%%
graph LR
subgraph "åº”ç”¨å±‚1"
A("<b>ç»“æ„ä½“ã€å¯¹è±¡</b><br><i>ï¼ˆå­—èŠ‚æ•°ç»„ï¼‰</i>"):::lb
end
subgraph "åº”ç”¨å±‚2"
B("<b>ç»“æ„ä½“ã€å¯¹è±¡</b><br><i>ï¼ˆå­—èŠ‚æ•°ç»„ï¼‰</i>"):::lb
end

subgraph ç½‘ç»œåè®®
C("<b><i>äºŒè¿›åˆ¶æµ</i></b>"):::p
A -.-> |"<i>[è½¬æ¢]</i>"|C -.-> |"<i>[è¿˜åŸ]</i>"|B
end

style ç½‘ç»œåè®® fill:#f4e4e9, stroke-dasharray: 3 3, stroke-width: 2px
classDef p fill:#ddaebd
classDef b fill:#aab7d2
classDef g fill:#9ac5bb
classDef lp fill:#f4e4e9
classDef lb fill:#d9dfeb
classDef lg fill:#ddebe6
classDef info fill:#f6f6f7,color:#737379,stroke-dasharray: 3 3, stroke-width: 2px</pre>



<h2 id="ä¸€ã€å®ç°æ–¹å¼"><a href="#ä¸€ã€å®ç°æ–¹å¼" class="headerlink" title="ä¸€ã€å®ç°æ–¹å¼"></a>ä¸€ã€å®ç°æ–¹å¼</h2><h3 id="ï¼ˆ1ï¼‰Serializable-é»˜è®¤"><a href="#ï¼ˆ1ï¼‰Serializable-é»˜è®¤" class="headerlink" title="ï¼ˆ1ï¼‰Serializable + é»˜è®¤"></a><span style="color:#c92f5f">ï¼ˆ1ï¼‰Serializable + é»˜è®¤</span></h3><p>è‡ªå®šä¹‰ç±»å®ç°<code>Serializable</code>ï¼Œ<strong>ä¸åŒ…å«</strong> <em>readObject()</em> å’Œ <em>writeObject()</em>ã€‚ä½¿ç”¨<strong>é»˜è®¤çš„</strong>åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„æ–¹å¼è¿›è¡Œæ•°æ®å†™å…¥å’Œè¯»å–æ“ä½œã€‚</p>
<p><strong>* Demoï¼š</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Serializable</span> </span>&#123;<br><br>	<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">long</span> serialVersionUID = <span class="hljs-number">1L</span>;<br>	<span class="hljs-keyword">private</span> String name;<br>	<span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> age;<br><br>	<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Person</span><span class="hljs-params">(String name, <span class="hljs-keyword">int</span> age)</span> </span>&#123;<br>		<span class="hljs-keyword">this</span>.name = name;<br>		<span class="hljs-keyword">this</span>.age = age;<br>	&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>



<h3 id="ï¼ˆ2ï¼‰Serializable-è‡ªå®šä¹‰"><a href="#ï¼ˆ2ï¼‰Serializable-è‡ªå®šä¹‰" class="headerlink" title="ï¼ˆ2ï¼‰Serializable + è‡ªå®šä¹‰"></a><span style="color:#c92f5f">ï¼ˆ2ï¼‰Serializable + è‡ªå®šä¹‰</span></h3><p>è‡ªå®šä¹‰ç±»å®ç°<code>Serializable</code>ï¼Œ<strong>åŒ…å«</strong> <strong><em>readObject()</em></strong> å’Œ <strong><em>writeObject()</em></strong>ï¼Œä½¿ç”¨<strong>è‡ªå®šä¹‰çš„</strong>åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„æ–¹å¼è¿›è¡Œæ•°æ®å†™å…¥å’Œè¯»å–æ“ä½œã€‚</p>
<p><strong>* Demo</strong>ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Serializable</span> </span>&#123;<br><br>	<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">long</span> serialVersionUID = <span class="hljs-number">1L</span>;<br>	<span class="hljs-keyword">private</span> String name;<br>	<span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> age;<br><br>	<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Person</span><span class="hljs-params">(String name, <span class="hljs-keyword">int</span> age)</span> </span>&#123;<br>		<span class="hljs-keyword">this</span>.name = name;<br>		<span class="hljs-keyword">this</span>.age = age;<br>	&#125;<br><br>  <span class="hljs-comment">// ğŸ”» readObject() å’Œ writeObject() çš„å¯è§æ€§æ²¡æœ‰é™åˆ¶ï¼šprivateã€protectedã€defaultã€public</span><br>	<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">writeObject</span><span class="hljs-params">(ObjectOutputStream outputStream)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>		<span class="hljs-comment">// çœç•¥å®ç°</span><br>	&#125;<br><br>	<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">readObject</span><span class="hljs-params">(ObjectIntputStream inputStream)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>		<span class="hljs-comment">// çœç•¥å®ç°	</span><br>	&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>



<h3 id="ï¼ˆ3ï¼‰Externalizable"><a href="#ï¼ˆ3ï¼‰Externalizable" class="headerlink" title="ï¼ˆ3ï¼‰Externalizable"></a><span style="color:#c92f5f">ï¼ˆ3ï¼‰Externalizable</span></h3><p>è‡ªå®šä¹‰ç±»å®ç° <code>Externalizable</code>ï¼Œ<strong>é‡å†™ <em>readExternal()</em></strong> å’Œ <strong><em>writeExternal()</em></strong> å®ç°åºåˆ—åŒ–/ååºåˆ—åŒ–åŠŸèƒ½ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Externalizable</span> </span>&#123;<br><br>	<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">long</span> serialVersionUID = <span class="hljs-number">1L</span>;<br>	<span class="hljs-keyword">private</span> String name;<br>	<span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> age;<br><br>	<span class="hljs-comment">// ğŸ”» æ— å‚æ„é€ å‡½æ•°ï¼šå¿…ä¸å¯å°‘çš„ï¼Œå¦åˆ™ä¼šæŠ›å¼‚å¸¸</span><br>	<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Person</span><span class="hljs-params">()</span> </span>&#123;&#125;<br><br>  <span class="hljs-comment">// ğŸ”» å¯è§æ€§æ²¡æœ‰é™åˆ¶ï¼šprivateã€protectedã€defaultã€public</span><br>	<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">readExternal</span><span class="hljs-params">(ObjectInput in)</span> <span class="hljs-keyword">throws</span> IOException, ClassNotFoundException </span>&#123;<br>		<span class="hljs-comment">// çœç•¥å®ç°</span><br>	&#125;<br><br>	<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">writeExternal</span><span class="hljs-params">(ObjectOutput out)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>		<span class="hljs-comment">// çœç•¥å®ç°</span><br>	&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>



<p><br><hr style="height:2px;border:none;border-top:1px dashed #dedede;"/></p>
<h2 id="äºŒã€æ ¸å¿ƒç±»"><a href="#äºŒã€æ ¸å¿ƒç±»" class="headerlink" title="äºŒã€æ ¸å¿ƒç±»"></a>äºŒã€æ ¸å¿ƒç±»</h2><pre class="mermaid">graph LR
t([<b>åºåˆ—åŒ–æ ¸å¿ƒç±»</b>]):::g
t --> A("â‘´ <b><i>Serializable</i></b>"):::lg
t --> B("â‘µ <b><i>Externalizable</i></b>"):::lg
t --> |"[ åºåˆ—åŒ–<br>å…³é”®ç±» ]"|C("â‘¶ <b><i>ObjectOutputStream</i></b><br>å°†å¯¹è±¡è½¬æ¢ä¸ºäºŒè¿›åˆ¶æµ"):::p
t --> |"[ ååºåˆ—åŒ–<br>å…³é”®ç±» ]"|D("â‘· <b><i>ObjectInputStream</i></b><br>å°†äºŒè¿›åˆ¶æµè¿˜åŸä¸ºå¯¹è±¡"):::p
C -.- c([å†…éƒ¨<br>å…³é”®ç±»]):::info
c -.-> c1(["â‘  <b><i>BolckDataOutputStream</i></b> - ç¼“å†²"]):::lp
c -.-> c2(["â‘¡ <b><i>HandleTable</i></b> - é˜²æ­¢é‡å¤"]):::lp
c -.-> c3(["â‘¢ <b><i>ReplaceTable</i></b> - è‡ªå®šä¹‰åºåˆ—åŒ–"]):::lp
c -.-> c4(["â‘£ <b><i>ObjecyStreamClass</i></b> - è®°å½•å…ƒæ•°æ®ã€åå°„"]):::lp

classDef p fill:#ddaebd
classDef b fill:#aab7d2
classDef g fill:#9ac5bb
classDef lp fill:#f4e4e9
classDef lb fill:#d9dfeb
classDef lg fill:#ddebe6
classDef info fill:#f6f6f7,color:#56565b,stroke-dasharray: 3 3, stroke-width: 2px</pre>

<h3 id="ï¼ˆ1ï¼‰Serializable"><a href="#ï¼ˆ1ï¼‰Serializable" class="headerlink" title="ï¼ˆ1ï¼‰Serializable"></a><span style="color:#c92f5f">ï¼ˆ1ï¼‰Serializable</span></h3><p><strong><em>Serializable</em></strong> æ˜¯ä¸€ä¸ª<strong>ç©ºæ¥å£</strong>ï¼Œè¡¨æ˜äº†å®ç°è‡ªè¯¥æ¥å£çš„å­ç±»å…·æœ‰åºåˆ—åŒ–è¡Œä¸ºç‰¹å¾ï¼Œæ‰€æœ‰è¦æ”¯æŒåºåˆ—åŒ–çš„ç±»éƒ½åº”è¯¥å®ç°è¿™ä¸ªæ¥å£ã€‚</p>
<p><strong>* æºç ï¼š</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Serializable</span> </span>&#123;<br><br>&#125;<br></code></pre></td></tr></table></figure>





<h3 id="ï¼ˆ2ï¼‰Externalizable"><a href="#ï¼ˆ2ï¼‰Externalizable" class="headerlink" title="ï¼ˆ2ï¼‰Externalizable"></a><span style="color:#c92f5f">ï¼ˆ2ï¼‰Externalizable</span></h3><p><code>writeExternal</code>çš„å‚æ•°ï¼š<strong><em>ObjectOutput</em></strong>ï¼Œè¡¨ç¤ºè¾“å‡ºå¯¹è±¡çš„æŠ½è±¡ï¼ˆå®ƒç»§æ‰¿è‡ª<em>DataOutput</em>ï¼Œèƒ½æ”¯æŒåŸºæœ¬ç±»å‹ã€Stringã€æ•°ç»„ã€å¯¹è±¡çš„è¾“å‡ºã€‚å®é™…åº”ç”¨ä¼šä½¿ç”¨å…¶å®ç°ç±» ObjectOutputStreamã€‚</p>
<p><code>readExternal</code>çš„å‚æ•°ï¼š<strong><em>ObjectInput</em></strong>ï¼Œè¡¨ç¤ºè¾“å…¥å¯¹è±¡çš„æŠ½è±¡ï¼ˆå®ƒç»§æ‰¿è‡ª<em>DataInput</em>ï¼Œèƒ½æ”¯æŒåŸºæœ¬ç±»å‹ã€Stringã€æ•°ç»„ã€å¯¹è±¡çš„è¾“å…¥ã€‚å®é™…åº”ç”¨ä¼šä½¿ç”¨å…¶å®ç°ç±» ObjectInputStreamã€‚</p>
<p><strong>* æºç </strong>ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Externalizable</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Serializable</span> </span>&#123;<br><br>  <span class="hljs-comment">// ğŸ”» è‡ªå®šä¹‰çš„ç±»å¿…é¡»è¦†ç›– writeExternal å’Œ readExternal æ–¹æ³•ã€‚</span><br>	<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">writeExternal</span><span class="hljs-params">(ObjectOutput out)</span> <span class="hljs-keyword">throws</span> IOException</span>;<br>	<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">readExternal</span><span class="hljs-params">(ObjectInput in)</span> <span class="hljs-keyword">throws</span> IOException, ClassNotFoundException</span>;<br><br>   <span class="hljs-comment">// ğŸ”» è‡ªå®šä¹‰çš„ç±»å¿…é¡»åŒ…å«æ— å‚æ„é€ å‡½æ•°ã€‚</span><br>&#125;<br></code></pre></td></tr></table></figure>



<h3 id="ï¼ˆ3ï¼‰ObjectOutputStream"><a href="#ï¼ˆ3ï¼‰ObjectOutputStream" class="headerlink" title="ï¼ˆ3ï¼‰ObjectOutputStream"></a><span style="color:#c92f5f">ï¼ˆ3ï¼‰ObjectOutputStream</span></h3><h4 id="â‘ -BlockDataOutputStream"><a href="#â‘ -BlockDataOutputStream" class="headerlink" title="â‘  BlockDataOutputStream"></a>â‘  <em>BlockDataOutputStream</em></h4><p><em>ObjectOutputStream</em> å†…ç½®çš„å…·æœ‰<strong>ç¼“å†²ä½œç”¨</strong>çš„è¾“å‡ºåŠŸèƒ½ç±»ï¼ŒåŒ…å«<strong>é˜»å¡å’Œéé˜»å¡</strong>ä¸¤ç§å·¥ä½œæ¨¡å¼ã€‚</p>
<pre class="mermaid">%%{
  init: {
    'themeVariables': {
       'fontSize': '14px'
     }
  }
}%%
graph LR
T("<b><i>BlockDataOutputStream</i></b> - ç¼“å†²"):::p
T --> A("<b>é˜»å¡æ¨¡å¼</b>"):::lp
T --> B("<b>éé˜»å¡æ¨¡å¼</b>"):::lp
A -.- t("æ¯æ¬¡å°†ç¼“å†²åŒºæ•°æ®å†™å…¥å‰ä¼šå†™å…¥ä¸€ä¸ª<br>é˜»å¡æ ‡è®°å¤´éƒ¨ï¼ˆBlock Data Headerï¼‰"):::info

classDef p fill:#ddaebd
classDef b fill:#aab7d2
classDef g fill:#9ac5bb
classDef lp fill:#f4e4e9
classDef lb fill:#d9dfeb
classDef lg fill:#ddebe6
classDef info fill:#f6f6f7,color:#56565b,stroke-dasharray: 3 3, stroke-width: 2px</pre>

<p style="text-align:right;font-size:12px;font-color:#56565b">* ä¸¤ç§æ¨¡å¼çš„å·¥ä½œæµç¨‹ç›¸åŒï¼Œéƒ½æ˜¯å…ˆæŠŠå¾…å†™çš„æ•°æ®å†™åˆ°ç¼“å†²åŒºï¼Œç›´åˆ°ç¼“å†²åŒºæ»¡åå†æ‰§è¡ŒçœŸæ­£çš„å†™å…¥æ“ä½œã€‚</p>
<br>

<h4 id="â‘¡-HandleTable"><a href="#â‘¡-HandleTable" class="headerlink" title="â‘¡ HandleTable"></a>â‘¡ <em>HandleTable</em></h4><p>å½“å‰å¾…åºåˆ—åŒ–çš„å¯¹è±¡(A)ï¼Œå¯èƒ½åŒ…å«å¤šä¸ªå…¶ä»–å¯¹è±¡ç±»å‹çš„æˆå‘˜å˜é‡ï¼Œè€Œè¿™äº›æˆå‘˜å˜é‡å¯èƒ½å¼•ç”¨åŒä¸€ä¸ªå¯¹è±¡Tï¼š</p>
<pre class="mermaid">%%{
  init: {
    'themeVariables': {
       'fontSize': '14px'
     }
  }
}%%
classDiagram
    class A
    class B
    class C
    class Tå¯¹è±¡

    A: b B
    A: c C
    B: t T
    C: t T

    A *-- B
    A *-- C
    C *-- Tå¯¹è±¡
    B *-- Tå¯¹è±¡</pre>

<p><strong>ä¸ºäº†ä½¿å¾—åœ¨åºåˆ—åŒ–Aå¯¹è±¡æ—¶ï¼Œä¸é‡å¤åºåˆ—åŒ–Tå¯¹è±¡ï¼Œå¼•å…¥äº†å¯¹è±¡å’Œå¥æŸ„çš„æ˜ å°„å…³ç³»ã€‚</strong></p>
<blockquote>
<p>å¥æŸ„ä»0å¼€å§‹æŒ‰é€’å¢é¡ºåºè‡ªå¢ã€‚æ¯å½“è¦å†™å…¥ä¸€ä¸ªObjectç±»å‹å¯¹è±¡æ—¶ï¼Œå» <strong><em>HandleTable</em></strong> æŸ¥è¯¢å…¶æ˜¯å¦å·²ç»å­˜åœ¨ï¼š</p>
<p>â¶ å¦‚æœå­˜åœ¨ï¼Œåˆ™è¯´æ˜å·²ç»å†™å…¥è¿‡ï¼Œæœ¬æ¬¡åªå†™å…¥å¥æŸ„å³å¯ï¼›<br>â· å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¯´æ˜æ²¡æœ‰è¢«å†™å…¥è¿‡ï¼Œéœ€è¦å†™å…¥è¯¥å¯¹è±¡ã€‚</p>
</blockquote>
<br>

<h4 id="â‘¢-ReplaceTable"><a href="#â‘¢-ReplaceTable" class="headerlink" title="â‘¢ ReplaceTable"></a>â‘¢ <em>ReplaceTable</em></h4><p>ä¸ºäº†æ”¯æŒ<strong>ç”¨æˆ·è‡ªå®šä¹‰</strong>çš„åºåˆ—åŒ–è¡Œä¸ºï¼ˆJavaåºåˆ—åŒ–æ”¯æŒå¯¹åºåˆ—åŒ–å’Œååºåˆ—åŒ–è¿›è¡Œæ‹¦æˆªå¹¶æ‰§è¡Œè‡ªå®šä¹‰çš„åºåˆ—åŒ–è¡Œä¸ºã€‚ï¼‰</p>
<blockquote>
<p><code>ReplaceTable</code> ç”¨æ¥<strong>ç®¡ç†æºå¯¹è±¡å’Œç›®æ ‡æ›¿æ¢å¯¹è±¡</strong>ï¼Œåœ¨åºåˆ—åŒ–/ååºåˆ—åŒ–è¿‡ç¨‹ä¸­ï¼Œ<u>é€šè¿‡æºå¯¹è±¡æŸ¥æ‰¾ç›®æ ‡æ›¿æ¢å¯¹è±¡</u>ï¼š</p>
<p>â¶ å¦‚æœå­˜åœ¨ç›®æ ‡æ›¿æ¢å¯¹è±¡ï¼Œåˆ™ä½¿ç”¨ç›®æ ‡æ›¿æ¢å¯¹è±¡ï¼›<br>â· å¦åˆ™ä½¿ç”¨æºå¯¹è±¡ã€‚</p>
</blockquote>
<br>

<h4 id="â‘£-ObjectStreamClass"><a href="#â‘£-ObjectStreamClass" class="headerlink" title="â‘£ ObjectStreamClass"></a>â‘£ <em>ObjectStreamClass</em></h4><p>è®°å½•äº†å’Œåºåˆ—åŒ–å¯¹è±¡ç›¸å…³çš„<strong>å…ƒæ•°æ®ä¿¡æ¯</strong>ï¼Œå¹¶è´Ÿè´£<strong>ç›¸å…³æ–¹æ³•çš„åå°„åˆå§‹åŒ–å’Œæ‰§è¡Œ</strong>ã€‚</p>
<table>
<thead>
<tr>
<th><strong>å­—æ®µ</strong></th>
<th><strong>å­—æ®µæ„ä¹‰</strong></th>
</tr>
</thead>
<tbody><tr>
<td><em>name</em></td>
<td>åºåˆ—åŒ–ç±»çš„å®Œæ•´ç±»å</td>
</tr>
<tr>
<td><em>cl</em></td>
<td>åºåˆ—åŒ–ç±»çš„Classç±»å‹</td>
</tr>
<tr>
<td><em>suid</em></td>
<td>åºåˆ—åŒ–ç±»çš„serialVersionUID</td>
</tr>
<tr>
<td><em>isProxy</em></td>
<td>æ˜¯å¦ä¸ºä»£ç†ç±»</td>
</tr>
<tr>
<td><em>isEnum</em></td>
<td>æ˜¯å¦ä¸ºæšä¸¾ç±»</td>
</tr>
<tr>
<td><strong><em>serializable</em></strong></td>
<td>æ˜¯å¦å®ç°äº†Serializable</td>
</tr>
<tr>
<td><strong><em>externalizable</em></strong></td>
<td>æ˜¯å¦å®ç°äº†Externalizable</td>
</tr>
<tr>
<td><em>primDataSize</em></td>
<td>åŸºæœ¬ç±»å‹çš„æˆå‘˜å­—æ®µä¸ªæ•°ï¼Œä¸åŒ…å«staticå’Œtransientç±»å‹å­—æ®µ</td>
</tr>
<tr>
<td><em>numObjFileds</em></td>
<td>éåŸºæœ¬ç±»å‹çš„æˆå‘˜å­—æ®µä¸ªæ•°</td>
</tr>
<tr>
<td><strong><em>dataLayout</em></strong></td>
<td>ç±»å±‚æ¬¡ç»“æ„ï¼šå½“å‰ç±»ã€çˆ¶ç±»åŠæ‰€æœ‰ç»§æ‰¿ç±»çš„ç±»æè¿°</td>
</tr>
<tr>
<td><strong><em>writeObjectMethod</em></strong></td>
<td>writeObjectæ–¹æ³•ï¼Œé€šè¿‡åå°„è·å–</td>
</tr>
<tr>
<td><em>readObjectMethod</em></td>
<td>readObjectæ–¹æ³•ï¼Œé€šè¿‡åå°„è·å–</td>
</tr>
<tr>
<td><em>writeReplaceMethod</em></td>
<td>writeReplaceæ–¹æ³•ï¼Œé€šè¿‡åå°„è·å–</td>
</tr>
<tr>
<td><em>readReplaceMethod</em></td>
<td>readReplaceæ–¹æ³•ï¼Œé€šè¿‡åå°„è·å–</td>
</tr>
</tbody></table>
<h3 id="ï¼ˆ4ï¼‰ObjectInputStream"><a href="#ï¼ˆ4ï¼‰ObjectInputStream" class="headerlink" title="ï¼ˆ4ï¼‰ObjectInputStream"></a><span style="color:#c92f5f">ï¼ˆ4ï¼‰ObjectInputStream</span></h3><p><em><a href="https://docs.oracle.com/en/java/javase/19/docs/api/java.base/java/io/ObjectInputStream.html">java.io.ObjectInputStream</a></em> æ˜¯å®ç°Javaååºåˆ—åŒ–çš„å…³é”®ç±»ï¼Œå’Œ <em>ObjectOutputStream</em> æ˜¯å¯¹åº”çš„ï¼Œå†…éƒ¨åŒ…å«äº† <strong><em>BlockDataInputStream</em></strong>ã€<strong><em>HandleTable</em></strong>ã€<strong><em>ReplaceTable</em></strong>ã€<strong><em>ObjectStreamClass</em></strong>ç­‰</p>
<p><br><hr style="height:2px;border:none;border-top:1px dashed #dedede;"/></p>
<h2 id="ä¸‰ã€å†…éƒ¨åŸç†"><a href="#ä¸‰ã€å†…éƒ¨åŸç†" class="headerlink" title="ä¸‰ã€å†…éƒ¨åŸç†"></a>ä¸‰ã€å†…éƒ¨åŸç†</h2><p>Javaåºåˆ—åŒ–çš„æµç¨‹ã€åŸç†ï¼Œä»¥åŠå„ç§ç±»å‹æ•°æ®è¿›è¡ŒJavaåºåˆ—åŒ–åçš„æ ¼å¼å’Œå ç”¨ç©ºé—´å¤§å°ç­‰ç»†èŠ‚ã€‚</p>
<p>Javaåºåˆ—åŒ–å¯¹æ•´å‹æ•°æ®é‡‡ç”¨å›ºå®š4å­—èŠ‚å­˜å‚¨ï¼Œè€ŒProtocol Bufferå¯¹æ•´å‹æ•°æ®é‡‡ç”¨å˜é•¿å­˜å‚¨ï¼Œä½¿å¾—å­˜å‚¨ç©ºé—´è¿›ä¸€æ­¥å‡å°ã€‚</p>
<h3 id="ï¼ˆ1ï¼‰åŸºæœ¬ç±»å‹çš„åºåˆ—åŒ–æµç¨‹"><a href="#ï¼ˆ1ï¼‰åŸºæœ¬ç±»å‹çš„åºåˆ—åŒ–æµç¨‹" class="headerlink" title="ï¼ˆ1ï¼‰åŸºæœ¬ç±»å‹çš„åºåˆ—åŒ–æµç¨‹"></a><span style="color:#c92f5f">ï¼ˆ1ï¼‰åŸºæœ¬ç±»å‹çš„åºåˆ—åŒ–æµç¨‹</span></h3><p><strong>Javaåºåˆ—åŒ–å¯¹åŸºæœ¬ç±»å‹æ•°æ®çš„å¤„ç†ï¼Œä¸¥æ ¼æŒ‰ç…§å…¶å†…å­˜å ç”¨å¤§å°æ¥è¿›è¡Œã€‚</strong>æ¯”å¦‚intç±»å‹å ç”¨4å­—èŠ‚ï¼ŒJavaåºåˆ—åŒ–æŒ‰ç…§é«˜ä½åˆ°ä½ä½ä¾æ¬¡æ”¾åˆ°å­—èŠ‚æ•°ç»„ï¼Œå†å†™å…¥åˆ°åºåˆ—åŒ–è¾“å‡ºå¯¹è±¡ï¼š</p>
<p><strong>å†™å…¥intç±»å‹æ•°æ®ï¼š</strong></p>
<pre class="mermaid">graph TD

subgraph "<b><i>ObjectOutputStream.java</b></i>"
A(["<i><b>writeInt()</b></i>"]):::p
end

subgraph "<b><i>BlockDataOutputStreamï¼ˆå†…éƒ¨ç±»ï¼‰</b></i>"
A ==> |"è°ƒç”¨"|B(["<i><b>writeInt()</b></i>"]):::p
B --- b["1024å­—èŠ‚å¤§å°<br>çš„ç¼“å†²åŒº"]:::lb
b -.-> |"<i>â‘  ç¼“å†²åŒºè¿˜å¯å®¹çº³<br>å¾…å†™å…¥çš„intç±»å‹æ•°æ®</i>"|b1("æŠŠå½“å‰æ•°æ®æ”¾å…¥ç¼“å†²åŒº"):::lg
B2(["<b><i>write()</i></b>"]):::p
B2 --- 2b["ç¼“å†²åŒº"]:::lb
2b -.-> |"<i>â‘  ç¼“å†²åŒºèƒ½å®¹çº³<br>å½“å‰å¾…å†™å…¥å­—èŠ‚</i>"|2b1("æŠŠå½“å‰å­—èŠ‚å†™å…¥ç¼“å†²åŒº"):::lg
2b -.-> |"<i>â‘¡ ç¼“å†²åŒºå·²æ»¡<br></i>"|2b2("æŠŠç¼“å†²åŒºçš„æ•°æ®è¾“å‡ºï¼Œ<br>å†æŠŠå½“å‰å¾…å†™å…¥å­—èŠ‚æ”¾åˆ°ç¼“å†²åŒº"):::lg

end

b -.-> |"<i>â‘¡ ç¼“å†²åŒºä¸èƒ½å®¹çº³<br>å¾…å†™å…¥çš„intç±»å‹æ•°æ®</i>"|C

subgraph "<b><i>DataOutputStream.java</b></i>"
C(["<i><b>writeInt()</b></i>"]):::p
C --> d("æŒ‰ç…§ä»é«˜åˆ°ä½çš„å­—èŠ‚é¡ºåº<br>ä¾æ¬¡å†™å…¥4ä¸ªå­—èŠ‚"):::lg
d ==> |"è°ƒç”¨"|B2
end

classDef p fill:#ddaebd
classDef b fill:#aab7d2
classDef g fill:#9ac5bb
classDef lp fill:#f4e4e9
classDef lb fill:#d9dfeb
classDef lg fill:#ddebe6
classDef info fill:#f6f6f7,color:#737379,stroke-dasharray: 3 3, stroke-width: 2px</pre>



<ul>
<li><p>ObjectOutputStream çš„ writeInt()ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">writeInt</span><span class="hljs-params">(<span class="hljs-keyword">int</span> val)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>  <span class="hljs-comment">// ğŸ”» çœŸæ­£çš„å†™å…¥æ˜¯é€šè¿‡è°ƒç”¨ BlockDataOutputStreamï¼ˆboutï¼‰ </span><br>  <span class="hljs-comment">//    çš„ writeInt æ–¹æ³•å®ç°çš„</span><br>  bout.writeInt(val); <br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>BlockDataOutputStream çš„ writeInt()ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">writeInt</span><span class="hljs-params">(<span class="hljs-keyword">int</span> v)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>  <br>  <span class="hljs-comment">// ğŸ”» BlockDataOutputStreamå†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ª1024å­—èŠ‚å¤§å°çš„ç¼“å†²åŒº</span><br>  <span class="hljs-keyword">if</span> (pos + <span class="hljs-number">4</span> &lt;= MAX_BLOCK_SIZE) &#123; <span class="hljs-comment">// MAX_BLOCK_SIZE = 1024</span><br>    <span class="hljs-comment">// ğŸ”¹ è‹¥ç¼“å†²åŒºè¿˜å¯ä»¥å®¹çº³å†™å…¥çš„intç±»å‹æ•°æ®ï¼šå°†æ•°æ®æ”¾å…¥ç¼“å†²åŒº</span><br>    Bits.putInt(buf, pos, v);<br>    pos += <span class="hljs-number">4</span>;<br>    <br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-comment">// ğŸ”¹ è‹¥ç¼“å†²åŒºæ— æ³•å®¹çº³ï¼šè°ƒç”¨ DataOutputStream çš„ writeInt()</span><br>    dout.writeInt(v) <br>  &#125;<br>  <br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>DataOutputStream çš„ writeInt()ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ğŸ”» intç±»å‹æ˜¯æŒ‰ç…§ä»é«˜åˆ°ä½çš„å­—èŠ‚é¡ºåºä¾æ¬¡å†™å…¥4ä¸ªå­—èŠ‚çš„</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title">writeInt</span><span class="hljs-params">(<span class="hljs-keyword">int</span> v)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>  <span class="hljs-comment">// outï¼šBlockDataOutputStream</span><br>  out.write((v &gt;&gt;&gt; <span class="hljs-number">24</span>) &amp; <span class="hljs-number">0xFF</span>);  <br>  out.write((v &gt;&gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xFF</span>);<br>  out.write((v &gt;&gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xFF</span>);<br>  out.write((v &gt;&gt;&gt; <span class="hljs-number">0</span>) &amp; oxFF);<br>  incCount(<span class="hljs-number">4</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>BlockDataOutputStream çš„ write() ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">write</span><span class="hljs-params">(<span class="hljs-keyword">int</span> b)</span> <span class="hljs-keyword">throws</span> IOEception </span>&#123;<br>  <span class="hljs-comment">// ğŸ”¹ è‹¥ç¼“å†²åŒºå·²æ»¡ï¼šå°†ç¼“å†²åŒºæ•°æ®æ¨å‡º</span><br>  <span class="hljs-keyword">if</span>(pos &gt;= MAX_BLOCK_SIZE) &#123; <br>    drain();<br>  &#125;<br>  <span class="hljs-comment">// ğŸ”¹ å°†å¾…å†™å…¥å­—èŠ‚å†™å…¥ç¼“å†²åŒº</span><br>  buf[pos++] = (<span class="hljs-keyword">byte</span>) b;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">drain</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>  <span class="hljs-comment">// ..</span><br>  <span class="hljs-comment">// ğŸ”¸ å°†bufç¼“å†²åŒºå·²æœ‰æ•°æ®è¾“å‡º</span><br>  out.write(buf, <span class="hljs-number">0</span>, pos); <br>  pos = <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><em>ï¼ˆå…¶ä»–åŸºæœ¬ç±»å‹æ•°æ®çš„å†™å…¥æµç¨‹ä¸æ­¤ç±»ä¼¼ï¼‰</em></p>
</li>
</ul>
<h3 id="ï¼ˆ2ï¼‰åŸºæœ¬ç±»å‹çš„åºåˆ—åŒ–å¤§å°"><a href="#ï¼ˆ2ï¼‰åŸºæœ¬ç±»å‹çš„åºåˆ—åŒ–å¤§å°" class="headerlink" title="ï¼ˆ2ï¼‰åŸºæœ¬ç±»å‹çš„åºåˆ—åŒ–å¤§å°"></a><span style="color:#c92f5f">ï¼ˆ2ï¼‰åŸºæœ¬ç±»å‹çš„åºåˆ—åŒ–å¤§å°</span></h3><table>
<thead>
<tr>
<th><strong>æ•°æ®ç±»å‹</strong></th>
<th><strong>Javaå†…å­˜ä¸­çš„å¤§å°</strong></th>
<th><strong>åºåˆ—åŒ–åçš„å¤§å°</strong></th>
<th><strong>åºåˆ—åŒ–æ“ä½œ<br/>ï¼ˆå‡è®¾å˜é‡ä¸ºVï¼‰</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong><em>boolean</em></strong></td>
<td>1</td>
<td>æ•´æ•°1æˆ–0çš„<br/>æœ€ä½ä¸€ä¸ªå­—èŠ‚</td>
<td>write(v ? 1 : 0)</td>
</tr>
<tr>
<td><strong><em>byte</em></strong></td>
<td>1</td>
<td>1</td>
<td>write(v)</td>
</tr>
<tr>
<td><strong><em>char</em></strong></td>
<td>2</td>
<td>2</td>
<td>é«˜ä½å­—èŠ‚å…ˆå†™å…¥<br>write((v&gt;&gt;&gt;8) &amp; 0xFF) <br/>write((v&gt;&gt;&gt;0) &amp; 0xFF)</td>
</tr>
<tr>
<td><strong><em>short</em></strong></td>
<td>2</td>
<td>2</td>
<td>é«˜ä½å­—èŠ‚å…ˆå†™å…¥<br/> write((v&gt;&gt;&gt;8) &amp; 0xFF) <br/>write((v&gt;&gt;&gt;0) &amp; 0xFF)</td>
</tr>
<tr>
<td><strong><em>int</em></strong></td>
<td>4</td>
<td>4</td>
<td>é«˜ä½å­—èŠ‚å…ˆå†™å…¥<br/> write((v&gt;&gt;&gt;24) &amp; 0xFF) <br/>write((v&gt;&gt;&gt;16) &amp; 0xFF) <br/>write((v&gt;&gt;&gt;8) &amp; 0xFF) <br/>write((v&gt;&gt;&gt;0) &amp; 0xFF)</td>
</tr>
<tr>
<td><strong><em>long</em></strong></td>
<td>8</td>
<td>8</td>
<td>é«˜ä½å­—èŠ‚å…ˆå†™å…¥ <br/>write((v&gt;&gt;&gt;56) &amp; 0xFF) <br/>write((v&gt;&gt;&gt;48) &amp; 0xFF) <br/>write((v&gt;&gt;&gt;40) &amp; 0xFF) <br/>write((v&gt;&gt;&gt;32) &amp; 0xFF) <br/>write((v&gt;&gt;&gt;24) &amp; 0xFF)<br/> write((v&gt;&gt;&gt;16) &amp; 0xFF) <br/>write((v&gt;&gt;&gt;8) &amp; 0xFF) <br/>write((v&gt;&gt;&gt;0) &amp; 0xFF)</td>
</tr>
<tr>
<td><strong><em>float</em></strong></td>
<td>4</td>
<td>4</td>
<td>ç¬¦åˆIEEE754æ ‡å‡†çš„4å­—èŠ‚</td>
</tr>
<tr>
<td><strong><em>double</em></strong></td>
<td>8</td>
<td>8</td>
<td>ç¬¦åˆIEEE754æ ‡å‡†çš„8å­—èŠ‚</td>
</tr>
</tbody></table>
<h3 id="ï¼ˆ3ï¼‰å¯¹è±¡ç±»å‹çš„åºåˆ—åŒ–æµç¨‹"><a href="#ï¼ˆ3ï¼‰å¯¹è±¡ç±»å‹çš„åºåˆ—åŒ–æµç¨‹" class="headerlink" title="ï¼ˆ3ï¼‰å¯¹è±¡ç±»å‹çš„åºåˆ—åŒ–æµç¨‹"></a><span style="color:#c92f5f">ï¼ˆ3ï¼‰å¯¹è±¡ç±»å‹çš„åºåˆ—åŒ–æµç¨‹</span></h3><p>Javaåºåˆ—åŒ–å¯¹éåŸºæœ¬ç±»å‹çš„æ•°æ®å¤„ç†æ¯”åŸºæœ¬ç±»å‹çš„æ•°æ®å¤„ç†æ›´å¤æ‚ï¼Œè¿™é‡Œè¯´çš„éåŸºæœ¬ç±»å‹åŒ…æ‹¬Objectã€Enumã€Arrayç­‰ â€”â€” é€šè¿‡ <strong><em>ObjectOutputStream</em></strong> çš„ <strong><em>writeObject</em></strong> æ–¹æ³•å®ç°çš„ï¼š</p>
<h4 id="âŠ-writeObject"><a href="#âŠ-writeObject" class="headerlink" title="âŠ writeObject()"></a>âŠ <em>writeObject()</em></h4><pre class="mermaid">graph TD
%%subgraph "<b><i>ObjectOutputStream</b></i>"
A(["<i><b>writeObject()</b></i>"]):::p
subgraph "<b><i>ObjectOutputStream.java</b></i>"
A --> |"[ è°ƒç”¨ ]"|B(["<i><b>writeObject0()</b></i>"]):::p
B --> |"æ ¸å¿ƒå®ç°"|b("ifåˆ†æ”¯ï¼šåˆ¤æ–­objç±»å‹"):::lb
end

subgraph "<i><b>String / Enum</i></b>"
b -...- 1t(["<i><b>writeString()</i></b>"]):::lp
b -...- 3t(["<i><b>writeEnum()</i></b>"]):::lp
1t -.-> 1a("å®ç°è‡ªSerializableï¼Œ<br>å…·å¤‡æ”¯æŒåºåˆ—åŒ–/ååºåˆ—åŒ–çš„èƒ½åŠ›"):::info
3t -.-> 1a
end

subgraph "<i><b>Array</b></i>"
b -.- 2t(["<i><b>writeArray()</i></b>"]):::lp
2t -.-> |"åŸºæœ¬ç±»å‹"|2a("è°ƒç”¨åŸºæœ¬ç±»å‹<br>çš„åºåˆ—åŒ–æ–¹å¼"):::lg
2t -.-> |"Objectç±»å‹"|2b("é€’å½’è°ƒç”¨<br>æ‰§è¡Œifåˆ†æ”¯"):::lb
%% 2a -.-> b
end

subgraph "<b><i>è‡ªå®šä¹‰çš„åºåˆ—åŒ–ç±»</i></b>"
b -.....- 4a(["<i><b>writeOrdinaryObject()</i></b>"]):::lp
4a -.-> |"<i>Externalizableç±»å‹<br>ä¸”ä¸æ˜¯åŠ¨æ€ä»£ç†ç±»</i>"|4a1(["<i><b>writeExternalData()</i></b>"]):::p
4a -.-> |"<i>Serializableç±»å‹</i>"|4a2(["<i><b>writeSerialData()</i></b>"]):::p
end
%%end

classDef p fill:#ddaebd
classDef b fill:#aab7d2
classDef g fill:#9ac5bb
classDef lp fill:#f4e4e9
classDef lb fill:#d9dfeb
classDef lg fill:#ddebe6
classDef info fill:#f6f6f7,color:#737379,stroke-dasharray: 3 3, stroke-width: 2px</pre>

<ul>
<li><p><strong><em>ObjectOutputStream</em></strong> çš„ <strong><em>writeObject</em></strong>() å†…éƒ¨å®ç°æ ¸å¿ƒéƒ¨åˆ†ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title">writeObject</span><span class="hljs-params">(Object obj)</span> <span class="hljs-keyword">throws</span> IOEXception </span>&#123;<br>  <span class="hljs-comment">// ğŸ”¹ å½“å‰ç±»æ˜¯å¦æ˜¯ ObjectOutputStream çš„å­ç±»</span><br>  <span class="hljs-keyword">if</span>(enableOverride) &#123; <br>    writeObjectOverride(obj);<br>    <span class="hljs-keyword">return</span>;<br>  &#125;<br>  <br>  <span class="hljs-comment">// ğŸ”¹ æ‰§è¡Œå¯¹è±¡å†™å…¥ï¼Œfalseè¡¨ç¤ºå…±äº«å†™å…¥</span><br>  <span class="hljs-keyword">try</span> &#123;<br>    writeObject0(obj, <span class="hljs-keyword">false</span>);  <span class="hljs-comment">// ğŸ”»</span><br>  &#125; <span class="hljs-keyword">catch</span> (IOEception ex) &#123;&#125;<br>  <br>&#125; <br></code></pre></td></tr></table></figure>
</li>
<li><p><strong><em>writeObject0()</em></strong> çš„å‚æ•°ï¼š</p>
<ol>
<li>objï¼šè¡¨ç¤ºè‡ªå®šä¹‰çš„åºåˆ—åŒ–å¯¹è±¡æˆ–è€…Arrayã€Enumç±»å‹å¯¹è±¡ã€‚</li>
<li>ç¬¬2ä¸ªå‚æ•°ï¼šè¡¨ç¤ºä¸€ä¸ªå¯¹è±¡è¢«å¤šä¸ªå¯¹è±¡å…±åŒå¼•ç”¨æ—¶ï¼Œåœ¨åºåˆ—åŒ–çš„æ—¶å€™æ˜¯å¦è¦å…±äº«å†™å…¥</li>
</ol>
<pre class="mermaid">  %%{
  init: {
    'themeVariables': {
       'fontSize': '13px'
     }
  }
}%%
graph LR
B(["<i><b>writeObject0() å‚æ•°:</b></i>"]):::p
B -.- b("â‘  è¢«å¼•ç”¨çš„å¯¹è±¡å®ä¾‹obj, <br>â‘¡ æ˜¯å¦å…±äº«å†™å…¥"):::lp
subgraph "[ <b>false</b> ]: å…±äº«å†™å…¥"
b1
end
subgraph "[ <b>true</b> ]: ä¸å…±äº«å†™å…¥"
b2
end
b --- |"é»˜è®¤"|b1("objåªä¼šè¢«åºåˆ—åŒ–ä¸€æ¬¡ï¼Œ<br>å…¶ä»–å¼•ç”¨åªä¼šå†™å…¥å¼•ç”¨<b>å¯¹è±¡å¥æŸ„</b>"):::lg
b -.- b2("objä¼šè¢«åºåˆ—åŒ–å¤šæ¬¡ï¼Œåºåˆ—<br>åŒ–åçš„æ•°æ®å¤§å°ä¼šå¢åŠ "):::lg

classDef p fill:#ddaebd
classDef b fill:#aab7d2
classDef g fill:#9ac5bb
classDef lp fill:#f4e4e9
classDef lb fill:#d9dfeb
classDef lg fill:#ddebe6
classDef info fill:#f6f6f7,color:#737379,stroke-dasharray: 3 3, stroke-width: 2px</pre>
</li>
<li><p><strong><em>writeObject0</em></strong>() æ ¸å¿ƒå®ç°ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">if</span> (obj <span class="hljs-keyword">instanceof</span> String) &#123;<br>  <span class="hljs-comment">// ğŸ”¹ Stringç±»ï¼šå®ç°è‡ªSerializableï¼Œå…·å¤‡æ”¯æŒåºåˆ—åŒ–/ååºåˆ—åŒ–èƒ½åŠ›</span><br>  writeString((String) obj, unshared);<br>  <br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (cl.isArray()) &#123;<br>  <span class="hljs-comment">// ğŸ”¹ Arrayç±»ï¼šâ‘ åŸºæœ¬ç±»å‹ï¼šè°ƒç”¨åŸºæœ¬ç±»å‹åºåˆ—åŒ–æ–¹å¼ â‘¡Objectç±»å‹ï¼šé€’å½’if</span><br>  writeArray(obj, desc, unshared);<br>  <br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (obj <span class="hljs-keyword">instanceof</span> Enum) &#123;<br>  <span class="hljs-comment">// ğŸ”¹ Enumç±»ï¼šå®ç°è‡ªSerializableï¼Œå…·å¤‡æ”¯æŒåºåˆ—åŒ–/ååºåˆ—åŒ–èƒ½åŠ›</span><br>  writeEnum((Exum&lt;?&gt;) obj, desc, unshared);<br>  <br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (obj <span class="hljs-keyword">instanceof</span> Serializable) &#123; <br>  <span class="hljs-comment">// ğŸ”» è‡ªå®šä¹‰çš„ç±»å®ç°äº† Serializableï¼šæ‰§è¡ŒwriteOrdinaryObjectæ–¹æ³•</span><br>  writeOrdinaryObject(obj, desc, unshared); <br>  <br>&#125; <span class="hljs-keyword">else</span> &#123;<br>  <span class="hljs-keyword">if</span>(extendedDebugInfo) &#123;<br>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NotSerializableException(cl.getName() + <span class="hljs-string">&quot;\n&quot;</span> + <br>      debugInfoStack.toString());<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>  <span class="hljs-comment">// â­•ï¸ è¦èƒ½å¤Ÿè¢«ObjectOutputStreamçš„writeObjectæ–¹æ³•åºåˆ—åŒ–ï¼Œå¯¹è±¡å¿…é¡»</span><br>  <span class="hljs-comment">// å®ç°è‡ªSerializableï¼Œå¦åˆ™ä¼šæŠ›NotSerializableExceptionå¼‚å¸¸</span><br>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NotSerializableException(cl.getName());<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p><strong><em>writeOrdinaryObject</em></strong>() æ ¸å¿ƒå®ç°ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// è‡ªå®šä¹‰çš„åºåˆ—åŒ–ç±»ï¼š</span><br>writeClassDesc(desc, <span class="hljs-keyword">false</span>); <span class="hljs-comment">// å†™å…¥ç±»æè¿°ä¿¡æ¯</span><br>handles.assign(unshared ? <span class="hljs-keyword">null</span> : obj);<br><br><span class="hljs-comment">// ğŸ”» è‹¥è‡ªå®šä¹‰çš„ç±»æ˜¯Externalizableç±»å‹ï¼šè°ƒç”¨writeExternalDataæ–¹æ³•</span><br><span class="hljs-keyword">if</span> (desc.isExternalizable() &amp;&amp; !desc.isProxy()) &#123;<br>  writeExternalData((Externalizable) obj); <br>  <br><span class="hljs-comment">// ğŸ”» è‹¥è‡ªå®šä¹‰çš„ç±»æ˜¯Serializableç±»å‹ï¼šè°ƒç”¨writeSerialDataæ–¹æ³•</span><br>&#125; <span class="hljs-keyword">else</span> &#123;<br>  writeSerialData(obj, desc);<br>&#125;<br></code></pre></td></tr></table></figure>



</li>
</ul>
<h4 id="â‹-writeSerialData"><a href="#â‹-writeSerialData" class="headerlink" title="â‹ writeSerialData()"></a>â‹ writeSerialData()</h4><p>writeOrdinaryObjectæ–¹æ³•å®ç°ä¸­ï¼Œå¦‚æœè‡ªå®šä¹‰ç±»å®ç°Serializableï¼Œåˆ™ä¼šè°ƒç”¨ writSerialData() å®ç°åºåˆ—åŒ–ï¼š</p>
<pre class="mermaid">%%{
  init: {
    'themeVariables': {
       'fontSize': '13px'
     }
  }
}%%
graph
subgraph "<b><i>writeSerialData()</i></b>"
A(["<b><i>desc.getClassDataLayout()</i></b>"]):::lp
A --> |"è¿”å›å€¼"|b(["<b><i>ClassDataSlotç±»å‹æ•°ç»„</b></i>"]):::b
%% æ•°ç»„å…ƒç´ é¡ºåºï¼šä»æœ€æ ¹éƒ¨çš„ç¥–å…ˆåˆ°å½“å‰ç±»ã€‚
b -.- 1("ï¼ˆObjectStreamClassï¼‰<b>desc</b>"):::lb
b -.- 2("ï¼ˆbooleanï¼‰<b>hasData</b><br>"):::lb
b -.- 3("... ..."):::lb
1 --> |"åˆ¤æ–­æ•°ç»„å…ƒç´ å¯¹åº”çš„ç±»<br>æ˜¯å¦åŒ…å« <b><i>writeObject</i></b> æ–¹æ³•"|t(["<i><b>desc.hasWriteObjectMethod()</b></i>"]):::lp
end

subgraph "<b><i>ObjectStreamClass.java</i></b>"
t -.-> |"[ <b>åŒ…å«</b> ]<br>åå°„è°ƒç”¨"|1a(["<b><i>invokeWriteObject()</i></b>"]):::p
1a --> 2a(["<b><i>writeObjectMethod.invoke()</b></i> âœ”ï¸"]):::lp
end

t -.-> |"[ <b>æœªåŒ…å«</b> ]"|1b(["<b><i>defaultWriteFields()</i></b><br>"]):::p
subgraph "<b><i>defaultWriteFiled()</b></i>"
1b --> |"â‘  å…ˆå†™å…¥<b>åŸºæœ¬ç±»å‹</b>çš„å­—æ®µ"|2b(["<i>bout.write()</i>"]):::lp
2b --> |"â‘¡ å†™å…¥<b>å¯¹è±¡ç±»å‹</b>çš„å­—æ®µ"|3b(["<b><i>writeObject0()</i></b> âœ”ï¸"]):::lp
end


classDef p fill:#ddaebd
classDef b fill:#aab7d2
classDef g fill:#9ac5bb
classDef lp fill:#f4e4e9
classDef lb fill:#d9dfeb
classDef lg fill:#ddebe6
classDef info fill:#f6f6f7,color:#737379,stroke-dasharray: 3 3, stroke-width: 2px</pre>

<h5 id="â‘´-å­—æ®µ"><a href="#â‘´-å­—æ®µ" class="headerlink" title="â‘´ å­—æ®µ"></a>â‘´ å­—æ®µ</h5><ul>
<li><p><strong>å­—æ®µè¯´æ˜ï¼š</strong></p>
<table>
<thead>
<tr>
<th>å­—æ®µ</th>
<th>ç±»å‹</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>getClassDataLayout()</td>
<td><em>ClassDataSlot[]</em></td>
<td>è·å–å½“å‰ç±»åŠç»§æ‰¿é“¾è·¯ä¸Šæ‰€æœ‰ç›´æ¥æˆ–é—´æ¥å®ç°äº† Serializable çš„ç¥–å…ˆç±»å¯¹åº”çš„<strong>åºåˆ—åŒ–å…ƒæ•°æ®ä¿¡æ¯</strong>ã€‚<br><br>* <em>æ•°ç»„å…ƒç´ é¡ºåºï¼šä»æœ€æ ¹éƒ¨çš„ç¥–å…ˆåˆ°å½“å‰ç±»ã€‚</em></td>
</tr>
<tr>
<td>desc</td>
<td><em>ObjectStreamClass</em></td>
<td>è®°å½•äº†åºåˆ—åŒ–å’Œååºåˆ—åŒ–å¯¹è±¡ç›¸å…³çš„<strong>å…ƒæ•°æ®ä¿¡æ¯</strong>ï¼Œå¹¶è´Ÿè´£ç›¸å…³æ–¹æ³•çš„åå°„åˆå§‹åŒ–å’Œæ‰§è¡Œã€‚</td>
</tr>
<tr>
<td>hasData</td>
<td><em>boolean</em></td>
<td>è¡¨ç¤ºdescå¯¹åº”çš„Javaå¯¹è±¡<strong>æ˜¯å¦æœ‰æ•°æ®è¢«åºåˆ—åŒ–</strong>ã€‚</td>
</tr>
</tbody></table>
</li>
<li><p><strong>Demoï¼š<em>getClassDataLayout()</em></strong></p>
<ol>
<li><p><strong>å½“åºåˆ—åŒ– MyPeople å¯¹è±¡æ—¶ï¼ŒgetClassDataLayout() è¿”å›çš„æ•°ç»„å¤§å°ï¼š1</strong></p>
<ul>
<li><em>ClassDataSlot[0] = MyPeople ç±»å¯¹åº”çš„ ObjecStreamClass</em></li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">People</span> </span>&#123; <span class="hljs-comment">// ... &#125;</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyPeople</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">People</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Serializable</span> </span>&#123; <span class="hljs-comment">// ... &#125;</span><br></code></pre></td></tr></table></figure>

</li>
</ol>
<hr style="height:2px;border:none;border-top:1px dashed #dedede;"/>

<ol start="2">
<li><p><strong>å½“åºåˆ—åŒ– MyPeople å¯¹è±¡æ—¶ï¼ŒgetClassDataLayout() è¿”å›çš„æ•°ç»„å¤§å°ï¼š2</strong></p>
<ul>
<li><em>ClassDataSlot[0] = People ç±»å¯¹åº”çš„ ObjectStreamClas</em></li>
<li><em>ClassDataSlot[1] = MyPeople ç±»å¯¹åº”çš„ ObjecStreamClass</em></li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">People</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Serializable</span> </span>&#123; <span class="hljs-comment">// ... &#125;</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Mypeople</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Prople</span> </span>&#123; <span class="hljs-comment">// ... &#125;</span><br></code></pre></td></tr></table></figure>

</li>
</ol>
<hr style="height:2px;border:none;border-top:1px dashed #dedede;"/>

</li>
</ul>
<h5 id="â‘µ-æºç "><a href="#â‘µ-æºç " class="headerlink" title="â‘µ æºç "></a>â‘µ æºç </h5><ul>
<li><p><strong><em>writeSerialData()</em>ï¼š</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">writeSerialData</span><span class="hljs-params">(Object obj, ObjectStreamCLass desc)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>  <br>  <span class="hljs-comment">// ğŸ”´ å¯¹äºClassDataSlotæ•°ç»„çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œ</span><br>  <span class="hljs-comment">//    å¦‚æœè¯¥å…ƒç´ å¯¹åº”çš„ç±»åŒ…å«writeObjectæ–¹æ³•ï¼Œåˆ™è°ƒç”¨writeObjetæ–¹æ³•ã€‚</span><br>  ObjectStreamClass.ClassDataSlot[] slots = desc.getClassDataLayout();<br>  <span class="hljs-comment">// è·å–å½“å‰å¾…å†™å…¥Objectç±»æè¿°ä¿¡æ¯</span><br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; slots.length; i++) &#123;<br>    ObjectStreamClass slotDesc = slots[i].desc;<br>    <span class="hljs-comment">// ğŸ”¹ â‘  è‹¥æœ‰ writeObject æ–¹æ³•ï¼šåå°„è°ƒç”¨</span><br>    <span class="hljs-keyword">if</span> (slotDesc.hasWriteObjectMethod()) &#123;   <br>      <span class="hljs-comment">// ...</span><br>      <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-comment">// ...</span><br>        <span class="hljs-comment">// ğŸ”» åå°„è°ƒç”¨objé‡Œçš„ writeObject æ–¹æ³•</span><br>        slotDesc.invokeWriteObject(obj, <span class="hljs-keyword">this</span>);  <br>      &#125; <span class="hljs-keyword">finally</span> &#123;<br>        <span class="hljs-comment">// ...</span><br>      &#125;<br>      <span class="hljs-comment">// ğŸ”¹ â‘¡ è‹¥æ—  writeObject æ–¹æ³•ï¼šğŸ”» è°ƒç”¨é»˜è®¤æ–¹æ³• </span><br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      defaultWriteFileds(obj, slotDesc); <br>    &#125;<br>  &#125;<br>&#125; <br></code></pre></td></tr></table></figure>
</li>
<li><p><strong><em>ObjectStreamClass çš„ invokeWriteObject() å†…éƒ¨å®ç°</em></strong>ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ğŸ”´ wirteObject æ–¹æ³•ä»¥åå°„æ–¹å¼è¢«è°ƒç”¨ï¼š</span><br>writeObjectMethod.invoke(obj, <span class="hljs-keyword">new</span> Object[]&#123; out &#125;);<br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// writeObjectMethod çš„åˆå§‹åŒ–é€šè¿‡åå°„æ–¹å¼å®ç°ï¼šï¼ˆObjectStreamClassçš„æ„é€ æ–¹æ³•ï¼‰</span><br>writeObjectMethod = getPrivateMethod(cl, <span class="hljs-string">&quot;writeObject&quot;</span>,<br>    <span class="hljs-keyword">new</span> Class&lt;?&gt;[] &#123; ObjectOutputStream.class &#125;,<br>    Void.TYPE);<br></code></pre></td></tr></table></figure>



</li>
</ul>
<ul>
<li><p><strong><em>defaultWriteFileds()</em>ï¼š</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ğŸ”´ è‹¥å½“å‰å¾…åºåˆ—åŒ–çš„ç±»æ²¡æœ‰writeObjectæ–¹æ³•ï¼Œåˆ™è°ƒç”¨defaultWriteFieldsæ–¹æ³•å®ç°åºåˆ—åŒ–ï¼š</span><br><br><span class="hljs-comment">// ğŸ”¸ å…ˆå†™å…¥åŸºæœ¬ç±»å‹å­—æ®µ</span><br><span class="hljs-keyword">int</span> primDataSize = desc.getPrimDataSize();<br><span class="hljs-keyword">if</span> (primVals == <span class="hljs-keyword">null</span> || primVals.lengnth &lt; primDataSize) &#123;<br>  primVals = <span class="hljs-keyword">new</span> <span class="hljs-keyword">byte</span>[primDataSize];<br>&#125;<br>desc.getPrimFiledValues(obj, primVals);<br>bout.write(primVals, <span class="hljs-number">0</span>, primDataSize, <span class="hljs-keyword">false</span>); <span class="hljs-comment">// BlockDataOutputStream</span><br><br><span class="hljs-comment">// ğŸ”¸ å†™å…¥å¯¹è±¡ç±»å‹çš„å­—æ®µ</span><br>ObjectStreamFiled[] fileds = desc.getFileds(<span class="hljs-keyword">false</span>);<br>Object[] objVals = <span class="hljs-keyword">new</span> Object[desc.getNumObjFields()];<br><span class="hljs-keyword">int</span> numPrimFileds = fields.length - objVals.length;<br>desc.getObjectFiledValues(obj, objVals);<br><span class="hljs-keyword">for</span> (intn i = <span class="hljs-number">0</span>; i &lt; objVals.length; i++) &#123;<br>  <span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-comment">// â­•ï¸ å¯¹è±¡ç±»å‹å­—æ®µç»§ç»­è°ƒç”¨writeObject0æ–¹æ³•</span><br>    writeObject0(objVals[i], fileds[numPrimFileds + i].isUnshared());<br>  &#125; <span class="hljs-keyword">finally</span> &#123; &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>ğŸ¦‹ ä»ObjectOutputStream çš„ writeObject æ‰§è¡Œæµç¨‹æ¥çœ‹ï¼ŒJavaåºåˆ—åŒ–ä»¥<strong>æ·±åº¦ä¼˜å…ˆéå†</strong>æ–¹å¼ä½¿æ•´ä¸ªå¯¹è±¡å®ç°åºåˆ—åŒ–ã€‚ï¼‰</p>
</li>
</ul>
<h4 id="âŒ-writeExternal"><a href="#âŒ-writeExternal" class="headerlink" title="âŒ writeExternal()"></a>âŒ writeExternal()</h4><p>å›åˆ° writeOrdinaryObject æ–¹æ³•å®ç°ï¼Œå¦‚æœè‡ªå®šä¹‰ç±»<strong>å®ç°äº† Externalizable ä¸”ä¸æ˜¯åŠ¨æ€ä»£ç†ç±»</strong>ï¼Œåˆ™ä¼šè°ƒç”¨ writeExternalData æ–¹æ³•å®ç°åºåˆ—åŒ–ï¼š</p>
<ul>
<li><p>writeExternalData </p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ğŸ”» æœ€ç»ˆè°ƒç”¨è‡ªå®šä¹‰ç±»å¯¹è±¡çš„ writeExternal æ–¹æ³•å®ç°å†™å…¥</span><br><span class="hljs-keyword">if</span> (protocol == PROTOCOL_VERSION_1) &#123;<br>    obj.writeExternal(<span class="hljs-keyword">this</span>);<br>  <br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    bout.setBlockDataMode(<span class="hljs-keyword">true</span>);<br>    obj.writeExternal(<span class="hljs-keyword">this</span>);<br>    bout.setBlockDataMode(<span class="hljs-keyword">false</span>);<br>    bout.writeByte(TC_ENDBLOCKDATA);<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>writeExternalData æ–¹æ³•çš„å®ç°çœ‹èµ·æ¥æ¯” writeSerializable ç±»æ›´ç®€æ´ï¼ŒåŸå› ï¼š</p>
<pre class="mermaid">  %%{
  init: {
    'themeVariables': {
       'fontSize': '13px'
     }
  }
}%%
graph 
T(["<i><b>Externalizable æ¥å£</b></i>"]):::p
T -.- A("æ¥å£åŒ…å«ï¼šreadExternal() å’Œ writeExternal()"):::info
A --> |"ï¼ˆæœ‰è§„èŒƒï¼‰"|A2("Externalizable çš„å­ç±»å¿…é¡»è¦†ç›– <br>readExternal() å’Œ writeExternal()"):::lp

T2(["<i><b>Serializable æ¥å£</b></i>"]):::g
T2 -.- B("ç©ºæ¥å£"):::info
B --> |"ï¼ˆæ— è§„èŒƒï¼‰"|B2("æœ¬èº«æ˜¯ç©ºæ¥å£ï¼Œåœ¨å…·ä½“è¡Œä¸ºä¸Šæ²¡æœ‰åš<br>å¼ºåˆ¶æ€§çš„çº¦æŸå’Œè§„èŒƒã€‚(ä»…æ˜¯ä¸€ç§ç‰¹æ€§ï¼‰"):::lg

classDef p fill:#ddaebd
classDef b fill:#aab7d2
classDef g fill:#9ac5bb
classDef lp fill:#f4e4e9
classDef lb fill:#d9dfeb
classDef lg fill:#ddebe6
classDef info fill:#f6f6f7,color:#737379,stroke-dasharray: 3 3, stroke-width: 2px</pre>



</li>
</ul>
<h3 id="ï¼ˆ4ï¼‰å¯¹è±¡ç±»å‹çš„åºåˆ—åŒ–æ•°æ®æˆåˆ†"><a href="#ï¼ˆ4ï¼‰å¯¹è±¡ç±»å‹çš„åºåˆ—åŒ–æ•°æ®æˆåˆ†" class="headerlink" title="ï¼ˆ4ï¼‰å¯¹è±¡ç±»å‹çš„åºåˆ—åŒ–æ•°æ®æˆåˆ†"></a><span style="color:#c92f5f">ï¼ˆ4ï¼‰å¯¹è±¡ç±»å‹çš„åºåˆ—åŒ–æ•°æ®æˆåˆ†</span></h3><div style="background:#faf1f3;padding:20px;font-size:14px;line-height:25px"><b>åºåˆ—åŒ–è¿‡ç¨‹ä¼šå†™å…¥çš„æ•°æ®æˆåˆ†ï¼š</b><i>ï¼ˆObjectOutputStream çš„ writeObject æ–¹æ³•æ‰§è¡Œæµç¨‹ï¼‰</i><br>
&#12288;1. å†™å…¥ TC_OBJECT<br>
&#12288;2. å†™å…¥ç±»æè¿°ï¼ˆwriteClassDescï¼‰<br>
&#12288;3. å†™å…¥åŸºæœ¬ç±»å‹å­—æ®µ<br>
&#12288;4. è·å–ã€éå†æ‰€æœ‰å¯¹è±¡ç±»å‹çš„å­—æ®µé€’å½’è°ƒç”¨ writeObject0() å®ç°å†™å…¥
</div>

<p><strong><span style="font-size:16px">(1ï¼‰å†™å…¥ TC_OBJECTï¼Œå€¼ä¸º0x73ï¼Œbyteç±»å‹ã€‚</span></strong></p>
<hr style="height:2px;border:none;border-top:1px dashed #dedede;"/>

<p><strong><span style="font-size:16px">(2ï¼‰å†™å…¥ç±»æè¿°ï¼ˆwriteClassDescï¼‰ï¼Œç±»æè¿°ä¾èµ–å¾…åºåˆ—åŒ–çš„å¯¹è±¡ï¼Œå ç”¨å­—èŠ‚ï¼š</span></strong></p>
<ul>
<li><p>ç±»æè¿°æ•°æ®æˆåˆ†ï¼š</p>
<div>
<table style="font-size:12px">
<thead>
<tr>
<th align="left">ç±»æè¿°å–å€¼</th>
<th>Tag</th>
<th>Tag Valueï¼ˆbyteï¼‰</th>
<th>Tagä¹‹åçš„æ•°æ®</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Null</td>
<td>TC_NULL</td>
<td>0x70</td>
<td>æ— </td>
</tr>
<tr>
  <td align="left">Handle<br><span style="font-size:12px;color:#666666">ï¼ˆå·²ç»å†™å…¥è¿‡çš„Objectç±»å‹å¯¹è±¡ï¼‰</span></td>
<td>TC_REFERENCE</td>
<td>0X71</td>
<td>4å­—èŠ‚çš„å¯¹è±¡</td>
</tr>
<tr>
<td align="left">åŠ¨æ€ä»£ç†ç±»</td>
<td>TC_<br>PROXYCLASSDESC</td>
<td>0x7D</td>
  <td>1ï¼‰4å­—èŠ‚çš„æ‰€æœ‰çˆ¶æ¥å£ç±»ä¸ªæ•°<br>2ï¼‰å¾ªç¯å†™å…¥çˆ¶æ¥å£çš„åå­—(UTF-8æ ¼å¼)ã€çˆ¶æ¥å£çš„ç±»æè¿°</td>
</tr>
<tr>
<td align="left">è‡ªå®šä¹‰çš„ Serializable æˆ– Externalizable <br>å®ç°ç±»</td>
<td>TC_CLASSDESC</td>
<td>0x72</td>
<td>1ï¼‰ç±»åå­—<br>2ï¼‰serialVersionUID<br>3ï¼‰ç±»æ ‡ç­¾<br>4ï¼‰å­—æ®µä¸ªæ•°<br>5ï¼‰ä¸€æ¬¡å¾ªç¯å†™å…¥æ¯ä¸ªå­—æ®µçš„ç±»å‹ç ã€å­—æ®µåã€å­—æ®µç­¾åï¼ˆéåŸºæœ¬ç±»å‹ï¼‰</td>
</tr>
</tbody></table>
</div>
</li>
<li><p>ç±»æ ‡ç­¾åŠæ„ä¹‰</p>
<div style="font-size:12px">
<table>
<thead>
<tr>
<th>æšä¸¾å€¼</th>
<th>æ•´å‹å€¼</th>
<th>æ„ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td>SC_WRITE_METHOD</td>
<td>0x01</td>
<td>Serializable å®ç°ç±»åŒ…å« writeObject æ–¹æ³•</td>
</tr>
<tr>
<td>SC_SERIALIZABLE</td>
<td>0x02</td>
<td>Serializable å®ç°ç±»</td>
</tr>
<tr>
<td>SC_EXTERNALIZABLE</td>
<td>0x04</td>
<td>Externalizable å®ç°ç±»</td>
</tr>
<tr>
<td>SC_BLOCK_DATA</td>
<td>0x08</td>
<td>Externalizable å®ç°ç±»å†™å…¥æ•°æ®ä½¿ç”¨ Block æ¨¡å¼</td>
</tr>
<tr>
<td>SC_ENUM</td>
<td>0x10</td>
<td>æšä¸¾ç±»</td>
</tr>
</tbody></table>
</div>
<span style="font-size:13px;color:#444444">ç±»æ ‡ç­¾å¯ä»¥æ˜¯ä¸Šè¿°å–å€¼çš„ç»„åˆã€‚ä¾‹å¦‚ï¼Œè‡ªå®šä¹‰ç±»å®ç°è‡ª Serializable ä¸”åŒ…å«äº† writeObject æ–¹æ³•ï¼Œåˆ™ç±»æ ‡ç­¾çš„å–å€¼ä¸ºï¼šSC_WRITE_METHOD | SC_SERIALIZABLEã€‚</span>

</li>
</ul>
<br>

<hr style="height:2px;border:none;border-top:1px dashed #dedede;"/>

<p><strong><span style="font-size:16px">ï¼ˆ3ï¼‰å†™å…¥åŸºæœ¬ç±»å‹å­—æ®µ</span></strong></p>
<ul>
<li><p><strong>å°†åŸºæœ¬ç±»å‹å­—æ®µæŒ‰å­—æ®µåçš„å­—å…¸é¡ºåºå†™å…¥ä¸€ä¸ªå­—èŠ‚æ•°ç»„ï¼Œå†æŠŠå­—èŠ‚æ•°ç»„æœ€ç»ˆå†™å…¥åˆ°è¾“å‡ºæµã€‚</strong>é€šè¿‡ ObjectStreamClass çš„æ„é€ å‡½æ•°åˆå§‹åŒ–è°ƒç”¨äº† getSerialFields æ–¹æ³•å¾—åˆ°éªŒè¯ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> ObjectStreamField[] getSerialFields(Class&lt;?&gt; cl)<br>    <span class="hljs-keyword">throws</span> InvalidClassException<br>&#123;<br>    ObjectStreamField[] fields;<br>    <span class="hljs-keyword">if</span> (Serializable.class.isAssignableFrom(cl) &amp;&amp;<br>        !Externalizable.class.isAssignableFrom(cl) &amp;&amp;<br>        !Proxy.isProxyClass(cl) &amp;&amp;<br>        !cl.isInterface())<br>    &#123;<br>        <span class="hljs-keyword">if</span> ((fields = getDeclaredSerialFields(cl)) == <span class="hljs-keyword">null</span>) &#123;<br>            fields = getDefaultSerialFields(cl);<br>        &#125;<br>        <span class="hljs-comment">// ğŸ”» ObjectStreamField æ’åº</span><br>        Arrays.sort(fields);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        fields = NO_FIELDS;<br>    &#125;<br>    <span class="hljs-keyword">return</span> fields;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>ObjectStreamFiled çš„ comparTo() æ ¸å¿ƒå®ç°ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ğŸ”¸ è·å–å­—æ®µåä¼šå¯¹å­—æ®µæ’åºï¼Œæ’åºé€»è¾‘ï¼š</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">compareTo</span><span class="hljs-params">(Object obj)</span></span>&#123;<br>  ObjectStreamField other = (ObjectStreamField) obj;<br>  <span class="hljs-keyword">boolean</span> isPrim = isPrimitive();<br>  <span class="hljs-keyword">if</span>(isPrim != other.isPrimitive()) &#123;<br>    <span class="hljs-keyword">return</span> isPrim ? -<span class="hljs-number">1</span> : <span class="hljs-number">1</span>;<br>  &#125;<br>  <span class="hljs-keyword">return</span> name.compareTo(other.name);<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>ğŸ“Œ æ’åºè§„åˆ™æ€»ç»“ï¼š</strong></p>
<ul>
<li>ä¸¤ä¸ªå­—æ®µç±»å‹ç›¸åŒï¼ŒæŒ‰ç…§å­—æ®µåçš„å­—å…¸é¡ºåºè¿›è¡Œæ’åºï¼›</li>
<li>ä¸¤ä¸ªå­—æ®µç±»å‹ä¸åŒï¼ŒåŸºæœ¬ç±»å‹æ’åœ¨éåŸºæœ¬ç±»å‹ä¹‹å‰ã€‚</li>
</ul>
</li>
<li><p>å›åˆ° ObjectOutputStream çš„ defaultWriteFields()ï¼Œå¯¹åŸºæœ¬ç±»å‹å­—æ®µçš„å¤„ç†è¿‡ç¨‹ä¸º â€”â€” <strong>å…ˆè·å–æ‰€æœ‰åŸºæœ¬ç±»å‹å­—æ®µå ç”¨çš„å­—èŠ‚æ•°ï¼Œå†å°†åŸºæœ¬ç±»å‹å­—æ®µçš„å€¼ä¾æ¬¡æ”¾å…¥ä¸€ä¸ªå­—èŠ‚æ•°ç»„</strong>ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ğŸ”¹ è·å–æ‰€æœ‰åŸºæœ¬ç±»å‹å­—æ®µçš„å­—èŠ‚æ•°</span><br><span class="hljs-keyword">int</span> primDataSize = desc.getPrimDataSize();<br><span class="hljs-keyword">if</span> (primVals == <span class="hljs-keyword">null</span> || primVals.length &lt; primDataSize) &#123;<br>    primVals = <span class="hljs-keyword">new</span> <span class="hljs-keyword">byte</span>[primDataSize];<br>&#125;<br><span class="hljs-comment">// ğŸ”¹ å°†åŸºæœ¬ç±»å‹å­—æ®µä¾æ¬¡å†™å…¥å­—èŠ‚æ•°ç»„</span><br>desc.getPrimFieldValues(obj, primVals);<br><span class="hljs-comment">// ğŸ”¸ å°†å­—èŠ‚æ•°ç»„è¾“å‡º</span><br>bout.write(primVals, <span class="hljs-number">0</span>, primDataSize, <span class="hljs-keyword">false</span>);<br></code></pre></td></tr></table></figure>



</li>
</ul>
<hr style="height:2px;border:none;border-top:1px dashed #dedede;"/>

<p><strong><span style="font-size:16px">ï¼ˆ4ï¼‰è·å–æ‰€æœ‰å¯¹è±¡ç±»å‹çš„å­—æ®µï¼Œå¾ªç¯éå†æ¯ä¸€ä¸ªå­—æ®µï¼Œé€’å½’è°ƒç”¨ writeObject0() å®ç°å†™å…¥ã€‚</span></strong></p>
<p>ï¼ˆç•¥ï¼Œä¸Šè¿° writeObject æµç¨‹é‡Œå·²æ¶‰åŠï¼‰</p>
<p><br><hr style="height:2px;border:none;border-top:1px dashed #dedede;"/></p>
<h2 id="å››ã€é«˜çº§ç‰¹æ€§"><a href="#å››ã€é«˜çº§ç‰¹æ€§" class="headerlink" title="å››ã€é«˜çº§ç‰¹æ€§"></a>å››ã€é«˜çº§ç‰¹æ€§</h2><h3 id="ï¼ˆ1ï¼‰transient-å…³é”®å­—"><a href="#ï¼ˆ1ï¼‰transient-å…³é”®å­—" class="headerlink" title="ï¼ˆ1ï¼‰transient å…³é”®å­—"></a>ï¼ˆ1ï¼‰transient å…³é”®å­—</h3><div style="background:#faf1f3;padding:20px;font-size:14px">transient å…³é”®å­—åœ¨Javaåºåˆ—åŒ–ä¸­ç”¨æ¥<b>æ§åˆ¶å­—æ®µä¸è¢«åºåˆ—åŒ–ã€‚</b></div>

<p><em>ObjectStreamClass</em> çš„ <em>getDefaultFields</em>() å†…éƒ¨å®ç°ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> ObjectStreamField[] getDefaultFields(Class&lt;?&gt; cl) &#123;<br>  Field[] clFields = cl.getDeclaredFields();<br>  ArrayList&lt;ObjectStreamField&gt; list = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>  <span class="hljs-comment">// ğŸ”» åºåˆ—åŒ–å­—æ®µä¸èƒ½ä¸º static ä¸”ä¸èƒ½ä¸º transient</span><br>  <span class="hljs-keyword">int</span> mask = Modifier.STATIC | Modifier.TRANSIENT;<br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; clFields.length; i++) &#123;<br>    <span class="hljs-keyword">if</span> ((clFields[i].getModifiers() &amp; mask) == <span class="hljs-number">0</span>) &#123;<br>      list.add(<span class="hljs-keyword">new</span> ObjectStreamField(clFields[i], <span class="hljs-keyword">false</span>, <span class="hljs-keyword">true</span>));<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">int</span> size = list.size();<br>  <span class="hljs-keyword">return</span> (size == <span class="hljs-number">0</span>) ? NO_FIELDS : list.toArray(<span class="hljs-keyword">new</span> ObjectStreamField[size]);<br>&#125;<br></code></pre></td></tr></table></figure>



<h3 id="ï¼ˆ2ï¼‰static-å…³é”®å­—"><a href="#ï¼ˆ2ï¼‰static-å…³é”®å­—" class="headerlink" title="ï¼ˆ2ï¼‰static å…³é”®å­—"></a>ï¼ˆ2ï¼‰static å…³é”®å­—</h3><div style="background:#faf1f3;padding:20px;font-size:14px">static å­—æ®µå±äºç±»<b>å…¨å±€å…±æœ‰ï¼Œä¸ä¼šè¢«åºåˆ—åŒ–ã€‚</b></div>

<blockquote>
<p>åœ¨ååºåˆ—åŒ–å¾—åˆ°çš„ç»“æœé‡Œï¼Œé™æ€å˜é‡çš„å€¼ä¾èµ–ç±»å¯¹è¯¥é™æ€å­—æ®µçš„ <u>â‘ åˆå§‹åŒ–æ“ä½œ</u>ä»¥åŠ <u>â‘¡æ˜¯å¦åœ¨åŒä¸€ä¸ªJVMè¿›ç¨‹å†…</u>ã€‚</p>
</blockquote>
<pre class="mermaid">%%{
  init: {
    'themeVariables': {
       'fontSize': '13px'
     }
  }
}%%
graph LR
subgraph é™æ€å˜é‡
t("<b>a = 0</b>"):::p
end
t --> |"èµ‹å€¼"|1("<b>a = 10</b>"):::lp
1 -.-> |"<i>ååºåˆ—åŒ–<br>æ“ä½œ 1</i>"|A("<b>a = 10</b>"):::lp
1 -.-> |"<i>ååºåˆ—åŒ–<br>æ“ä½œ 2</i>"|B("<b>a = 0</b>"):::g
subgraph "JVMè¿›ç¨‹ 2"
B
end
subgraph "JVMè¿›ç¨‹ 1(åŒä¸ª)"
A
end
B -.-> info("å› ä¸ºç±»åœ¨JVMè¿›ç¨‹å†…<br><b>åªä¼šè¢«åŠ è½½ä¸€æ¬¡</b>ï¼Œ<br>â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦<br>ç›¸åŒçš„ç±»åœ¨ä¸åŒJVM<br>éƒ½ä¼š<b>è¢«åˆå§‹åŒ–ä¸€é</b>ã€‚"):::lg

classDef p fill:#ddaebd
classDef b fill:#aab7d2
classDef g fill:#9ac5bb
classDef lp fill:#f4e4e9
classDef lb fill:#d9dfeb
classDef lg fill:#ddebe6
classDef info fill:#f6f6f7,color:#737379,stroke-dasharray: 3 3, stroke-width: 2px</pre>



<h3 id="ï¼ˆ3ï¼‰serialVersionUID"><a href="#ï¼ˆ3ï¼‰serialVersionUID" class="headerlink" title="ï¼ˆ3ï¼‰serialVersionUID"></a>ï¼ˆ3ï¼‰serialVersionUID</h3><div style="background:#faf1f3;padding:20px;font-size:14px">serialVersionUID ç”¨æ¥å®ç°<b>ç±»ç‰ˆæœ¬å…¼å®¹</b>ï¼Œåœ¨å®é™…å¼€å‘ä¸­èƒ½<b>æ»¡è¶³ç±»å­—æ®µå˜åŒ–çš„éœ€æ±‚</b>ã€‚</div>

<ul>
<li><p><strong>å¿…é¡»å®šä¹‰ serialVersionUID å­—æ®µï¼š</strong></p>
<blockquote>
<ul>
<li>å¦‚æœä¸å®šä¹‰serialVersionUIDå­—æ®µï¼ŒJavaåºåˆ—åŒ–ä¼šæ ¹æ®ç±»å­—æ®µå’Œå…¶ä»–ä¸Šä¸‹æ–‡è®¡ç®—ä¸€ä¸ª<strong>é»˜è®¤å€¼</strong>ã€‚</li>
<li>å½“ç±»å­—æ®µå‘ç”Ÿå˜åŒ–æ—¶ï¼ŒserialVersionUID å€¼ä¹Ÿä¼šè·Ÿç€å˜åŒ–ï¼Œå°±ä¼šå‡ºç°å› ç±»å­—æ®µå˜åŒ–å¯¼è‡´ååºåˆ—åŒ–å¤±è´¥çš„é—®é¢˜ã€‚æ¯”å¦‚å¢åŠ æ–°å­—æ®µåï¼Œæ— æ³•å†è¯»å–å¢åŠ å­—æ®µä¹‹å‰çš„åºåˆ—åŒ–æ•°æ®ã€‚ååºåˆ—åŒ–ä¼šæŠ¥<code>InvalidCastException</code> å¼‚å¸¸ã€‚</li>
</ul>
</blockquote>
</li>
<li><p><strong>serialVersionUID å­—æ®µå¿…é¡»æ˜¯ static + final ç±»å‹ï¼Œæ‰èƒ½è¢«åºåˆ—åŒ–ã€‚</strong></p>
<p>ObjectStreamClass çš„ getDeclaredSUID()ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Long <span class="hljs-title">getDeclaredSUID</span><span class="hljs-params">(Class&lt;?&gt; cl)</span> </span>&#123;<br>  <span class="hljs-keyword">try</span> &#123;<br>    Field f = cl.getDeclaredField(<span class="hljs-string">&quot;serialVersionUID&quot;</span>);<br>    <span class="hljs-comment">// ğŸ”» serialVersionUID å­—æ®µå¿…é¡»æ˜¯ static + final ç±»å‹</span><br>    <span class="hljs-keyword">int</span> mask = Modifier.STATIC | Modifier.FINAL;<br>    <span class="hljs-keyword">if</span> ((f.getModifiers() &amp; mask) == mask) &#123;<br>      f.setAccessible(<span class="hljs-keyword">true</span>);<br>      <span class="hljs-keyword">return</span> Long.valueOf(f.getLong(<span class="hljs-keyword">null</span>));<br>    &#125;<br>  &#125; <span class="hljs-keyword">catch</span> (Exception ex) &#123; &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>&#125;<br></code></pre></td></tr></table></figure>



</li>
</ul>
<h3 id="ï¼ˆ4ï¼‰åºåˆ—åŒ–-ååºåˆ—åŒ–hook"><a href="#ï¼ˆ4ï¼‰åºåˆ—åŒ–-ååºåˆ—åŒ–hook" class="headerlink" title="ï¼ˆ4ï¼‰åºåˆ—åŒ–/ååºåˆ—åŒ–hook"></a>ï¼ˆ4ï¼‰åºåˆ—åŒ–/ååºåˆ—åŒ–hook</h3><div style="background:#faf1f3;padding:20px;font-size:14px">writeReplace() å’Œ readResolve() ç”¨äºåºåˆ—åŒ–å†™å…¥ / ååºåˆ—åŒ–æ—¶<b>æ‹¦æˆªå¹¶æ›¿æ¢æˆä¸€ä¸ªè‡ªå®šä¹‰çš„å¯¹è±¡</b>ã€‚</div>

<h4 id="âŠ-writeReplaceæ–¹æ³•"><a href="#âŠ-writeReplaceæ–¹æ³•" class="headerlink" title="âŠ writeReplaceæ–¹æ³•"></a>âŠ writeReplaceæ–¹æ³•</h4><ul>
<li><p><strong>æ–¹æ³•çš„å®Œæ•´å®šä¹‰ï¼š</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span>/<span class="hljs-keyword">default</span>/<span class="hljs-keyword">protected</span>/<span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">writeReplace</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> ObjectStreamException</span>;<br><span class="hljs-comment">// ç”±äºåŸºäºåå°„æ‰§è¡Œï¼Œå› æ­¤ä½œç”¨åŸŸé™å®šç¬¦ä¸å—é™åˆ¶ã€‚</span><br></code></pre></td></tr></table></figure>

<blockquote>
<p>è‹¥å®šä¹‰äº† wirteReplace()ï¼Œå°±æ²¡å¿…è¦å†å®šä¹‰ âŒ writeObject() äº†ã€‚å†…éƒ¨ä¼šå…ˆè°ƒç”¨writeReplaceæ–¹æ³•å°†å½“å‰åºåˆ—åŒ–å¯¹è±¡æ›¿æ¢æˆè‡ªå®šä¹‰ç›®æ ‡å¯¹è±¡ã€‚ï¼ˆreadObject åŒç†ï¼‰</p>
</blockquote>
</li>
</ul>
<ul>
<li><p><strong>å·¥ä½œåŸç†ï¼š</strong></p>
<p><em>ObjectOutputStream çš„ writeObject0()ï¼š</em></p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// check for replacement object</span><br>Object orig = obj;<br>Class&lt;?&gt; cl = obj.getClass();<br>ObjectStreamClass desc;<br><span class="hljs-keyword">for</span>(;;) &#123;<br>  <span class="hljs-comment">// REMIND: skip this check for strings/arrays?</span><br>  Class&lt;?&gt; repCL;<br>  <span class="hljs-comment">// ğŸ”» è°ƒç”¨ obj åºåˆ—åŒ–å†™å…¥</span><br>  <span class="hljs-keyword">if</span> (!desc.hasWriteReplaceMethod() ||<br>      (obj = desc.invokeWriteReplace(obj)) == <span class="hljs-keyword">null</span> ||<br>      (repCl = obj.getCLass()) == cl) &#123;<br>    <span class="hljs-keyword">break</span>;<br>  &#125;<br>  cl = repCl;<br>&#125;<br></code></pre></td></tr></table></figure>



</li>
</ul>
<h4 id="â‹-readResolveæ–¹æ³•"><a href="#â‹-readResolveæ–¹æ³•" class="headerlink" title="â‹ readResolveæ–¹æ³•"></a>â‹ readResolveæ–¹æ³•</h4><ul>
<li><p><strong>æ–¹æ³•çš„å®Œæ•´å®šä¹‰ï¼š</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span>/<span class="hljs-keyword">default</span>/<span class="hljs-keyword">protected</span>/<span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">readResolve</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> ObjectStreamException</span>;<br><span class="hljs-comment">// ç”±äºåŸºäºåå°„æ‰§è¡Œï¼Œå› æ­¤ä½œç”¨åŸŸé™å®šç¬¦ä¸å—é™åˆ¶ã€‚</span><br></code></pre></td></tr></table></figure>

<blockquote>
<p>è‹¥å®šä¹‰äº† readResolve æ–¹æ³•ï¼Œâœ… readObject æ–¹æ³•æ˜¯å…è®¸å‡ºç°çš„ã€‚</p>
</blockquote>
</li>
</ul>
<ul>
<li><p><strong>å·¥ä½œåŸç†ï¼š</strong></p>
<pre class="mermaid">  %%{
  init: {
    'themeVariables': {
       'fontSize': '13px'
     }
  }
}%%
graph LR
subgraph "<b><i>ObjectInputStream.java</i></b>"
A(["<b><i>readObject0()</i></b>"]):::p
A --> |"ğŸ”¸ è¿”å›ååºåˆ—åŒ–ç»“æœ"|x("åˆ¤æ–­æ˜¯å¦å­˜åœ¨ readResolve()"):::lg
x -.-> |"[ å­˜åœ¨ ]"|B
B(["<b><i>è°ƒç”¨ readResolve()</i></b>"]):::g
B -.-> |"<b>ğŸ”¹ è¿”å›è‡ªå®šä¹‰çš„å¯¹è±¡</b>"|C(["<b><i>readObject</b></i>"]):::p

C
end
x --> |"[ ä¸å­˜åœ¨ ]<br><br>ğŸ”¸ ç›´æ¥è¿”å›å¯¹è±¡ç»“æœ"|C

classDef p fill:#ddaebd
classDef b fill:#aab7d2
classDef g fill:#9ac5bb
classDef lp fill:#f4e4e9
classDef lb fill:#d9dfeb
classDef lg fill:#ddebe6
classDef info fill:#f6f6f7,color:#737379,stroke-dasharray: 3 3, stroke-width: 2px</pre>

<ol>
<li>é¦–å…ˆè°ƒç”¨ readObject0 æ–¹æ³•å¾—åˆ°ååºåˆ—åŒ–ç»“æœ</li>
<li>è‹¥ readResolve æ–¹æ³•å­˜åœ¨ï¼Œåˆ™ä¼šè°ƒç”¨è¯¥æ–¹æ³•è¿”å›è‡ªå®šä¹‰çš„å¯¹è±¡ã€‚</li>
<li>å°†è‡ªå®šä¹‰çš„å¯¹è±¡ä½œä¸º ObjectInputStream çš„ readObject çš„è¿”å›å€¼ã€‚</li>
</ol>
</li>
</ul>
<ul>
<li><p><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong></p>
<p>ä½¿ç”¨ readResolve() åœ¨ååºåˆ—åŒ–çš„è¿‡ç¨‹ä¸­å¯¹æšä¸¾å¯¹è±¡è¿›è¡Œ<strong>æ¢å¤æ€§ä¿æŠ¤</strong>ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * å¯¹äºç±»å®ç°çš„æšä¸¾ç±»å‹ï¼Œååºåˆ—åŒ–å‡ºæ¥çš„æšä¸¾å¯¹è±¡æœŸæœ›æ˜¯å®šä¹‰çš„æšä¸¾å¯¹è±¡ï¼Œ</span><br><span class="hljs-comment"> * è¿™ä¹Ÿä½“ç°äº†æšä¸¾çš„æ„ä¹‰ã€‚</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * ä½†ä»ä»£ç æ‰§è¡Œæƒ…å†µçœ‹ï¼Œååºåˆ—åŒ–å‡ºæ¥çš„çš„æšä¸¾å¯¹è±¡æ˜¯ä¸€ä¸ªæ–°å»ºå‡ºæ¥çš„æšä¸¾å¯¹è±¡ï¼Œ</span><br><span class="hljs-comment"> * è™½ç„¶å€¼å’Œæšä¸¾å€¼å®šä¹‰çš„ä¸€æ ·ï¼Œä½†ä¸æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Brand</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Serializable</span> </span>&#123;<br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> val;<br>  <br>  <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">Brand</span><span class="hljs-params">(<span class="hljs-keyword">int</span> val)</span> </span>&#123;<br>    <span class="hljs-keyword">this</span>.val = val;<br>  &#125;<br>  <br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Brand NIKE = <span class="hljs-keyword">new</span> Brand(<span class="hljs-number">0</span>);<br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Brand ADDIDAS = <span class="hljs-keyword">new</span>  Brand(<span class="hljs-number">1</span>);<br>  <br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>    ObjectOutputStream outputStream = <span class="hljs-keyword">new</span> ObjectOutputStream( <span class="hljs-keyword">new</span><br>      FileOutputStream(<span class="hljs-keyword">new</span> File(<span class="hljs-string">&quot;out1&quot;</span>)));<br>    outputStream.writeObject(Brand.ADDIDAS);<br>    outputStream.close();<br>    <br>    ObjectInputStream inputStream = <span class="hljs-keyword">new</span> ObjectInputStream( <span class="hljs-keyword">new</span><br>      FileInputSrteam(<span class="hljs-keyword">new</span> File(<span class="hljs-string">&quot;out1&quot;</span>)));<br>    Brand brand = (Brand) inputStream.readObject();<br>    System.out.println(brand == Brand.ADDIDAS); <span class="hljs-comment">// âŒ false</span><br>  &#125; <br>&#125;<br></code></pre></td></tr></table></figure>




</li>
</ul>
<ul>
<li><p><strong>åŠ ä¸Š readResolve() åï¼š</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/** </span><br><span class="hljs-comment"> * ä½¿ç”¨ readResolve() åœ¨ååºåˆ—åŒ–çš„è¿‡ç¨‹ä¸­å¯¹æšä¸¾å¯¹è±¡è¿›è¡Œæ¢å¤æ€§ä¿æŠ¤ã€‚</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Brand</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Serializable</span> </span>&#123;<br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> val;<br>  <br>  <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">Brand</span><span class="hljs-params">(<span class="hljs-keyword">int</span> val)</span> </span>&#123;<br>    <span class="hljs-keyword">this</span>.val = val;<br>  &#125;<br>  <br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Brand NIKE = <span class="hljs-keyword">new</span> Brand(<span class="hljs-number">0</span>);<br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Brand ADDIDAS = <span class="hljs-keyword">new</span>  Brand(<span class="hljs-number">1</span>);<br>  <br>  <span class="hljs-comment">// ğŸ”»</span><br>  <span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">readResolve</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> ObjectStreamException </span>&#123;<br>    <span class="hljs-keyword">if</span> (val == <span class="hljs-number">0</span>) &#123;<br>      <span class="hljs-keyword">return</span> NIKE;<br>    &#125; <br>    <span class="hljs-keyword">if</span> (val == <span class="hljs-number">1</span>) &#123;<br>      <span class="hljs-keyword">return</span> ADDIDAS;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span><br>  &#125;<br>  <br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>    <br>    ObjectOutputStream outputStream = <span class="hljs-keyword">new</span> ObjectOutputStream( <span class="hljs-keyword">new</span><br>      FileOutputStream(<span class="hljs-keyword">new</span> File(<span class="hljs-string">&quot;out1&quot;</span>)));<br>    outputStream.writeObject(Brand.ADDIDAS);<br>    outputStream.close();<br>    <br>    ObjectInputStream inputStream = <span class="hljs-keyword">new</span> ObjectInputStream( <span class="hljs-keyword">new</span><br>      FileInputSrteam(<span class="hljs-keyword">new</span> File(<span class="hljs-string">&quot;out1&quot;</span>)));<br>    Brand brand = (Brand) inputStream.readObject();<br>    System.out.println(brand == Brand.ADDIDAS); <span class="hljs-comment">// â­•ï¸ true</span><br>  <br>  &#125; <br>&#125;<br></code></pre></td></tr></table></figure>







</li>
</ul>
<h3 id="ï¼ˆ5ï¼‰æ•°æ®æ ¡éªŒ"><a href="#ï¼ˆ5ï¼‰æ•°æ®æ ¡éªŒ" class="headerlink" title="ï¼ˆ5ï¼‰æ•°æ®æ ¡éªŒ"></a>ï¼ˆ5ï¼‰æ•°æ®æ ¡éªŒ</h3><div style="background:#faf1f3;padding:20px;font-size:14px">Javaåºåˆ—åŒ–æœºåˆ¶åœ¨<b>ååºåˆ—åŒ–</b>æ—¶æ”¯æŒå¯¹è¯»å–åˆ°çš„æ•°æ®è¿›è¡Œ<b>æ ¡éªŒ</b>ï¼ˆé»˜è®¤ä¸æ ¡éªŒï¼‰ã€‚è¿™æ˜¯å› ä¸ºJavaåºåˆ—åŒ–åçš„æ•°æ®æ˜¯æ˜æ–‡å½¢å¼ï¼Œæœ‰å¯èƒ½è¢«ä¿®æ”¹ã€‚</div>

<p>ä½¿ç”¨æ•°æ®æ ¡éªŒç‰¹æ€§éœ€è¦è®©è‡ªå®šä¹‰çš„åºåˆ—åŒ–ç±»å®ç°<code>java.io.ObjectInputValidation</code>æ¥å£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Serializable</span>, <span class="hljs-title">ObjectInputValidation</span></span><br></code></pre></td></tr></table></figure>
<p>é€šè¿‡è°ƒç”¨å›è°ƒå‡½æ•° validateObject æ¥å®ç°æ•°æ®éªŒè¯ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">validateObject</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InvalidObjectException </span>&#123;<br>  <span class="hljs-keyword">if</span> (age &lt;= <span class="hljs-number">0</span>) &#123;<br>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> InvalidObjectException(<span class="hljs-string">&quot;age invalid&quot;</span>)<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<br>

<hr style="height:2px;border:none;border-top:1px dashed #dedede;"/>

<h2 id="äº”ã€åºåˆ—åŒ–æ–¹å¼å¯¹æ¯”"><a href="#äº”ã€åºåˆ—åŒ–æ–¹å¼å¯¹æ¯”" class="headerlink" title="äº”ã€åºåˆ—åŒ–æ–¹å¼å¯¹æ¯”"></a>äº”ã€åºåˆ—åŒ–æ–¹å¼å¯¹æ¯”</h2><div style="background:#faf1f3;padding:20px;font-size:14px">é€‰æ‹© Serializable è¿˜æ˜¯ Externalizable ï¼Ÿ</div>

<p><strong>* å¯¹æ¯”ï¼š</strong></p>
<table>
<thead>
<tr>
<th></th>
<th>Serializable (ğŸŸ¢ä¼˜å…ˆé€‰æ‹©)</th>
<th>Externalizable</th>
</tr>
</thead>
<tbody><tr>
<td>åŠŸèƒ½</td>
<td>javaåºåˆ—åŒ–å·²æ”¯æŒ</td>
<td>javaåºåˆ—åŒ–å·²æ”¯æŒ</td>
</tr>
<tr>
<td>æ˜“ç”¨æ€§</td>
<td><strong>æ˜“ç”¨æ€§æ›´å¥½</strong>ï¼šSerializable æä¾›äº†<u>é»˜è®¤çš„</u>åºåˆ—åŒ–ä¸ååºåˆ—åŒ–è¡Œä¸ºï¼Œç”¨æˆ·æ— éœ€å…³æ³¨åºåˆ—åŒ–çš„å®ç°ç»†èŠ‚å³å¯æ‹¿æ¥ä½¿ç”¨ã€‚</td>
<td>Externalizable å¿…é¡»å®ç°å®ç° <em>readExternal</em> å’Œ <em>writeExternal</em> æ¥å£ï¼Œä¸”è¦æä¾›é»˜è®¤æ„é€ å‡½æ•°ã€‚</td>
</tr>
<tr>
<td>è‡ªå®šä¹‰åºåˆ—åŒ–</td>
<td>ä¹Ÿå¯é€šè¿‡ readObject å’Œ  writeObject æ¥æ”¯æŒ</td>
<td></td>
</tr>
</tbody></table>
<p><strong>* ç»ˆæ­¢åºåˆ—åŒ–ç‰¹æ€§ï¼š</strong></p>
<p>åœ¨ç»§æ‰¿é“¾è·¯ä¸Šï¼Œå¦‚æœè¦ç»ˆæ­¢ä¸€ä¸ªå­ç±»çš„ Serializable æˆ–è€… Externaizable ç‰¹æ€§ï¼š</p>
<blockquote>
<p>åœ¨ <strong><em>readObject / writeObject</em></strong> æ–¹æ³•æˆ– <strong><em>readExternal / writeExternal</em></strong> æ–¹æ³•æ¥å£é‡ŒæŠ›å‡º <code>UnsupportedOperation-Exception</code> å¼‚å¸¸ï¼Œè¡¨ç¤ºä¸æ”¯æŒåºåˆ—åŒ–å’Œååºåˆ—åŒ–åŠŸèƒ½ã€‚</p>
</blockquote>
<br>

<hr style="height:2px;border:none;border-top:1px dashed #dedede;"/>

<h2 id="å…­ã€å°ç»“"><a href="#å…­ã€å°ç»“" class="headerlink" title="å…­ã€å°ç»“"></a>å…­ã€å°ç»“</h2><p>Javaåºåˆ—åŒ–æ–¹æ¡ˆæˆç†Ÿåº¦é«˜ï¼Œä½†<strong>æ€§èƒ½å’Œå‹ç¼©æ•ˆæœå‡ä¸€èˆ¬</strong>ï¼Œåªé€‚åˆJVMç³»åˆ—è¯­è¨€å…±äº«æ•°æ®ï¼Œä¸å…·å¤‡å®Œå…¨çš„è·¨è¯­è¨€èƒ½åŠ›ã€‚å¦å¤–ï¼Œå®ƒä¼šå¸¦æ¥ä¸€äº›æ•°æ®å®‰å…¨æ€§å’Œå®Œæ•´æ€§é—®é¢˜ã€‚</p>
<p>åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œå¾€å¾€ä¼šé€‰æ‹©å…·æœ‰è·¨è¯­è¨€èƒ½åŠ›ã€æ€§èƒ½é«˜æ•ˆã€å‹ç¼©æ•ˆæœæ˜¾è‘—çš„æ–¹æ¡ˆï¼Œä¾‹å¦‚ Thriftã€Protocol Bufferç­‰ã€‚</p>
<br>
<br>
<br>

<p style="text-align:center;font-size:13px;color:#666666"> - <i>end</i> - </p>

<hr style="height:2px;border:none;border-top:1px dashed #dedede;"/>

<p style="font-size:13px;color:#666666">ğŸ”– ç¬”è®°æ¥è‡ªï¼š<a href="https://book.douban.com/subject/35303133/" target="_blank">ã€Šæ·±å…¥ç†è§£åºåˆ—åŒ–ä¸ååºåˆ—åŒ–ã€‹</a></p>

<p style="font-size:13px;color:#666666">ğŸ“š æ‰©å±•é˜…è¯»ï¼š<a href="https://gitee.com/openeuler/bishengjdk-11/wikis/FastSerializer?sort_id=2879166#3-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%8E%9F%E7%90%86"  target="_blank">ã€ŠFastSerializeråºåˆ—åŒ–ç‰¹æ€§ä»‹ç» - ååºåˆ—åŒ–åŸç†ã€‹</a></p>

</div></article><div class="post-view__sidebar"><div class="sidebar"><div class="tocbot"><h2>Toc</h2><div class="toc__content"></div></div><h2>Links</h2><div class="sidebar__link"><ul><li><a href="https://github.com/equnee">Github</a></li><li><a href="https://codepen.io/equne">Codepen</a></li><li><a href="mailto:equne@qq.com">Mail</a></li></ul></div><h2>Friends</h2><div class="sidebar__friend"></div><h2>Archives</h2><div class="sidebar__archives"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/">2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/">2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/">2020</a></li></ul></div><h2>Categories</h2><div class="sidebar__categories"><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Java%E5%9F%BA%E7%A1%80/">JavaåŸºç¡€</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%B7%A5%E5%85%B7/">å·¥å…·</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">æ•°æ®ç»“æ„</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">è®¾è®¡æ¨¡å¼</a></li></ul></div><h2>Tags</h2><div class="sidebar__tags"><ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Chain/" rel="tag">Chain</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HashMap/" rel="tag">HashMap</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/I-O/" rel="tag">I/O</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mac/" rel="tag">Mac</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Markdown/" rel="tag">Markdown</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mermaid/" rel="tag">Mermaid</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/singleton/" rel="tag">singleton</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/windows/" rel="tag">windows</a></li></ul></div></div></div></div><div class="horizontal-line" style="height: 1px"></div><div class="main__bottom"><div class="pre-next"><a class="pre-button" href="/note/Basics/IO/IO_StandardIO/">IO - æ ‡å‡†è®¾å¤‡è¾“å…¥/è¾“å‡º</a><a class="next-button" href="/note/Basics/IO/IO_RandomAccessFile/">IO - RandomAccessFile ä»»æ„è®¿é—®æ–‡ä»¶</a></div><div id="comments"></div></div></div></div><div class="footer"><span>Â©ï¸2019-2023 Author By  <b><a class="link" href="https://github.com/equnee">equne</a></b></span><span>&nbsp;Powered By <b><a class="link" href="https://hexo.io/zh-cn/">hexo  </a></b></span><script type="text/javascript" id="maid-script" src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script><script>if (window.mermaid) {
  var options = JSON.parse(document.getElementById('maid-script').getAttribute('mermaidoptioins'));
  mermaid.initialize({
    theme: 'neutral',
    fontFamily: 'Noto Serif SC',
    startOnLoad: 'true'
  });
}</script></div><l></l><div class="darkmode-mask" id="darkmode-mask"></div><div class="sidebar__button"></div></body></html>