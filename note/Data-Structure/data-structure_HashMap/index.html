<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=0"><meta name="description" content="ğŸ¦‹ HashMap åŸç†åŠæºç åˆ†æ [ ğŸ§ Peach ] "><meta name="theme-color"><title>ğŸ¦‹ HashMap åŸç†åŠæºç åˆ†æ [ ğŸ§ Peach ] </title><link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="/css/mermaid.css"><script src="https://cdn.bootcss.com/highlight.js/9.6.0/highlight.min.js" defer></script><script src="/js/paper.js" defer></script><script src="https://www.googletagmanager.com/gtag/js?id=G-5GZQ6P3RMX" async></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-5GZQ6P3RMX');</script><script src="https://www.unpkg.com/valine/dist/Valine.min.js" defer></script><script>window.addEventListener('DOMContentLoaded', () => {
  new Valine({
    el: '#comments',
    appId: 'MJAdR7lH7cWVJLyn1Tgnw5Sj-gzGzoHsz',
    appKey: 'de2VP0VpE5bWgR2aA8wkwxn2',
    notify: false,
    verify: false,
    avatar: 'mp',
    placeholder: 'say something',
  })
})</script><script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js" defer></script><script>window.addEventListener('DOMContentLoaded', () => {
  tocbot.init({
    // Where to render the table of contents.
    tocSelector: '.toc__content',
    // Where to grab the headings to build the table of contents.
    contentSelector: '.article__content',
    // Which headings to grab inside of the contentSelector element.
    headingSelector: 'h1, h2, h3, h4, h5, h6',
    // For headings inside relative or absolute positioned containers within content.
    hasInnerContainers: true,
    orderedList: false,
    collapseDepth: 2,
  });
})</script><link rel="preload" href="https://cdn.bootcss.com/highlight.js/9.6.0/styles/github.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><link rel="stylesheet" href="https://cdn.bootcss.com/highlight.js/9.6.0/styles/github.min.css"><link rel="preload" href="https://fonts.googleapis.com/css?family=Abril+Fatface&amp;display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface&amp;display=swap"><link rel="preload" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@300;400;500;600;700&amp;display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@300;400;500;600;700&amp;display=swap"><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css"><meta name="generator" content="Hexo 5.4.2"></head><body><div class="mask-border"></div><div class="head"><div class="head__inner"><h1><a href="/">ğŸ§ Peach</a></h1><p>èœœæ¡ƒå­¦ä»£ç </p></div></div><div class="paper-container"><div class="main"><div class="location-bar"><div class="line-1"><div class="horizontal-line" style="height: 3px"></div></div><div class="line-2"><div class="horizontal-line" style="height: 1px"></div></div><p class="text">ğŸ¦‹ HashMap åŸç†åŠæºç åˆ†æ</p><div class="switch-button"><input class="container_toggle" type="checkbox" id="switch" name="mode"><label for="switch">Toggle</label></div><div class="line-3"><div class="horizontal-line" style="height: 1px"></div></div></div><div class="main__2-col"><article class="post-view__article"><div class="article__infomation"><div class="posts-item"><h2 class="posts-item__title"><a href="">ğŸ¦‹ HashMap åŸç†åŠæºç åˆ†æ</a></h2><span class="post__date">2023-03-09</span><a href="/tags/Java/"><span class="post__tags">#Java</span></a><a href="/tags/HashMap/"><span class="post__tags">#HashMap</span></a></div></div><div class="article__content"><p>ï¼ˆæœ¬æ–‡ç¼–è¾‘ä¸­ï¼‰</p>
<blockquote>
<p>æ³¨ï¼šæœ¬æ–‡åˆ¶ä½œçš„æµç¨‹å›¾ä»…ä¸ºä¸ªäººç†è§£ï¼Œä»…ä¾›å‚è€ƒã€‚</p>
</blockquote>
<hr>
<h1 id="ä¸€ã€HashMapä»‹ç»"><a href="#ä¸€ã€HashMapä»‹ç»" class="headerlink" title="ä¸€ã€HashMapä»‹ç»"></a>ä¸€ã€HashMapä»‹ç»</h1><h2 id="1-åŸç†"><a href="#1-åŸç†" class="headerlink" title="1. åŸç†"></a>1. åŸç†</h2><h3 id="ï¼ˆ1ï¼‰HashMapæ€ä¹ˆå­˜å–"><a href="#ï¼ˆ1ï¼‰HashMapæ€ä¹ˆå­˜å–" class="headerlink" title="ï¼ˆ1ï¼‰HashMapæ€ä¹ˆå­˜å–"></a>ï¼ˆ1ï¼‰HashMapæ€ä¹ˆå­˜å–</h3><pre class="mermaid">%%{
    init: {
        'themeVariables': {
            'fontSize': '13px'
        }
    }
}%%
graph TD

T(("<b>HashMap<br>æ€ä¹ˆå­˜å–å€¼</b>")):::p
T --> |"<i><b>æ•°æ®ä»¥é”®å€¼å¯¹å½¢å¼å­˜å‚¨</b></i>"| A["<i>key â€” value</i>"]
A --> |"<i><b>åŒ…è£…ä¸ºNodeæ•°ç»„å¯¹è±¡</b></i>"| B["<i>Node { key, value }</i>"]
B --> |"<i><b>é€šè¿‡nodeæ•°ç»„ä¸‹æ ‡ä¿å­˜å¯¹åº”æ•°æ®</b></i>"| C["<i>node[0] = new Node { key, value }<br>node[1] = new Node { key, value }<br>node[2] = new Node { key, value }<br> ...</i>"]
C -.-> |"[ <b>ä¿å­˜</b> ] <br>éå†æ•°ç»„ï¼Œå¯¹åº”keyå’Œvalue"| D["<i>for (Node node : nodes)</i>"]
C --> |"<b>[ è·å– ] <br>é€šè¿‡<u> æ•°ç»„ç´¢å¼• </u>è·å–<i>ï¼ˆkeyçš„hashå€¼ï¼‰</i></b>"|E["<i><b>node[ <u>hash(key)</u> ] = value</b></i>"]:::lb

classDef p fill:#ddaebd
style E fill:#d9dfeb, stroke:#657eae,stroke-width:2px,stroke-dasharray: 3 3</pre>
<ul>
<li>ä½¿ç”¨Nodeæ•°ç»„ä¿å­˜ã€é€šè¿‡Nodeæ•°ç»„ç´¢å¼•è·å–ã€‚</li>
</ul>
<h3 id="ï¼ˆ2ï¼‰Hashç®—æ³•æ€ä¹ˆå†™"><a href="#ï¼ˆ2ï¼‰Hashç®—æ³•æ€ä¹ˆå†™" class="headerlink" title="ï¼ˆ2ï¼‰Hashç®—æ³•æ€ä¹ˆå†™"></a>ï¼ˆ2ï¼‰Hashç®—æ³•æ€ä¹ˆå†™</h3><pre class="mermaid">%%{
    init: {
        'themeVariables': {
        'fontSize': '13px',
        'clusterBorder': 'none',
        'clusterBkg': '#f0f2f7'
    }
}
}%%
graph TD
T(("<b>Hashç®—æ³•<br>æ€ä¹ˆå†™ï¼Ÿ</b>")):::p
T --> |"<i><b>å¦‚ä½•è®¡ç®—å‡ºæ•°ç»„ç´¢å¼•ï¼Ÿhash(key)</b></i>"| A["* å› ä¸ºNodeæ•°ç»„æœ‰å›ºå®šçš„åˆå§‹åŒ–é»˜è®¤é•¿åº¦ï¼ˆlengthï¼‰<br>* ç´¢å¼•å€¼éœ€é™å®šåœ¨æ•°ç»„é•¿åº¦èŒƒå›´å†…ï¼ˆ0ï½length-1ï¼‰<br>* ç´¢å¼•å€¼è¿˜è¦å°½å¯èƒ½å¹³è¡¡ã€åˆ†å¸ƒå‡åŒ€"]
A --> B(["å–æ¨¡è¿ç®—ï¼š<i>hash % length</i>"])
B ==> |"<b>ï¼ˆæ›´å¥½çš„æ–¹æ¡ˆ</b>ï¼š<br>ä½¿ç”¨ä½è¿ç®—æ•ˆç‡æ›´é«˜ï¼‰"| C(["<b>ä½è¿ç®—ï¼š<i>hash & (length - 1)</i></b>"])
C -.- c("<b><i>lengthå¿…é¡»æ˜¯2çš„næ¬¡å¹‚</i></b>"):::b
subgraph "å‰ç½®æ¡ä»¶"
c -.- c2["<i>å‡å¦‚ key = 20, length = 16, hash & (length-1):</i><br>0001 0100  // 20  <br>0000 1111 // 15<br >0000 0100 // =4"]:::c2
end
classDef p fill:#ddaebd
classDef b fill:#d2d9e7, stroke-width: 0px

style c2 color: #86868b, fill:#ebedf3, stroke-dasharray: 3 3
%% å–æ¨¡è¿ç®—
style B fill: #f4e4e9
%% "ä½è¿ç®—"
style C fill:#b8c3d9, stroke:#657eae,stroke-width:2px</pre>

<ul>
<li><p><strong>ä¸ºäº†è§£å†³å–æ¨¡çš„æ•ˆç‡é—®é¢˜ï¼Œé‡‡ç”¨äº†ä½è¿ç®—çš„æ–¹æ³•ï¼š<code>index = hashå€¼ &amp; (length -1)</code></strong><br>æ­¤æ—¶éœ€è¦ä¸€ä¸ªå‰ç½®æ¡ä»¶ï¼š<strong><em>lengthçš„é•¿åº¦å¿…é¡»æ˜¯2çš„næ¬¡å¹‚</em></strong>ã€‚<br>å½“lengthçš„é•¿åº¦æ˜¯<math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mi mathvariant="normal">n</mi></msup></math>æ—¶ï¼Œæœ‰ä»¥ä¸‹å…¬å¼æˆç«‹ï¼š <b><i>num%<math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mi mathvariant="normal">n</mi></msup></math> = num&amp;(<math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mi mathvariant="normal">n</mi></msup></math>-1) </i>ã€‚</b></p>
<blockquote>
<p>ğŸ¦‹ å› ä¸ºå°±åƒåè¿›åˆ¶å–ä½™æ•°ä¸€æ ·ï¼Œè‹¥é™¤ä»¥10æˆ–10çš„æ•´æ¬¡å¹‚æ•°ï¼Œä½™æ•°åˆšå¥½æ˜¯å–ä½ä½ä¸Šçš„æ•°å­—ã€‚åŒç†ï¼ŒäºŒè¿›åˆ¶å–ä½™æ•°åªè¦é™¤ä»¥2çš„næ¬¡å¹‚æ•°ï¼Œä½ä½ä¸Šçš„æ•°å­—å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„ä½™æ•°ã€‚è€Œ(<math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mi mathvariant="normal">n</mi></msup></math> - 1)çš„äºŒè¿›åˆ¶æœ‰æ•ˆä½éƒ½æ˜¯1ï¼Œå’Œnä½çš„1ä½œä¸è¿ç®—ç›¸å½“äºå–ä½nä½çš„å€¼ã€‚</p>
</blockquote>
</li>
<li><p><strong>lengthçš„é•¿åº¦åˆšå¥½æ˜¯2çš„næ¬¡å¹‚ï¼Œæ‰©å®¹ä¹Ÿæ˜¯æŒ‰åŸæ¥çš„2å€å®¹é‡è¿›è¡Œæ‰©å®¹ï¼Œå¯ä»¥åŠ å¿«hashè®¡ç®—ã€å‡å°‘hashå†²çªã€‚</strong></p>
<blockquote>
<p>ğŸ¦‹ <strong>åŠ å¿«hashè®¡ç®—</strong>ï¼š</p>
<ol>
<li>ä¸¤å€æ‰©å®¹æœºåˆ¶ä½¿å®¹é‡ä¸€ç›´ä¿æŒåœ¨2çš„næ¬¡å¹‚æ•°ï¼Œå°±å¯ä»¥ä½¿ç”¨<u>ä½è¿ç®—ä»£æ›¿å–æ¨¡è¿ç®—</u>ï¼Œæå‡hashè®¡ç®—æ•ˆç‡ã€‚</li>
<li>å½“å®¹é‡ä¿æŒä¸º2çš„næ¬¡å¹‚æ—¶ï¼Œæ¯æ¬¡æ‰©å®¹æ—¶ä½è¿ç®—è®¡ç®—å¾—å‡ºçš„ä½™æ•°ä¸å˜ï¼Œæ•°æ®å­˜æ”¾çš„<u>ç´¢å¼•ä½ç½®ä¹Ÿä¿æŒä¸å˜</u>ã€‚è€Œä½¿ç”¨%è®¡ç®—æ—¶ï¼Œç»“æœä¼šå› ä¸ºå®¹é‡çš„å˜åŒ–è€Œæ”¹å˜ï¼ˆæ¨¡è¿ç®—ä¼šäº§ç”Ÿå°æ•°ç‚¹ï¼‰ï¼Œæ¯æ¬¡æ‰©å®¹æ—¶æ•°æ®åœ¨æ•°ç»„ä¸­å­˜æ”¾çš„ä½ç½®ä¼šå‘ç”Ÿæ”¹å˜ï¼ˆæ•°æ®æ¼‚ç§»ï¼‰ï¼Œå½±å“æ€§èƒ½ã€‚</li>
</ol>
</blockquote>
<blockquote>
<p>ğŸ¦‹ <strong>å‡å°‘hashå†²çª</strong>ï¼š</p>
<ul>
<li>å°†å®¹é‡ä¿æŒä¸ºå¶æ•°è¿›è¡Œhashè®¡ç®—æ—¶ï¼Œç»è¿‡(length-1)åï¼Œè®¡ç®—å‡ºçš„ç´¢å¼•å€¼ä¸ºå¥‡æ•°å’Œå¶æ•°çš„æ¦‚ç‡ç›¸åŒï¼ˆå–å†³äºéšæœºç”Ÿæˆçš„hashå€¼ï¼‰ï¼›</li>
<li>è€Œä½¿ç”¨<u>å¥‡æ•°å®¹é‡</u>è¿›è¡Œhashè®¡ç®—æ—¶ï¼Œç»è¿‡(length-1)åï¼Œæœ€ç»ˆç»“æœå‡ä¸ºå¶æ•°ï¼Œè¿™æ ·ä»»ä½• hash å€¼éƒ½åªä¼šè¢«æ•£åˆ—åˆ°æ•°ç»„çš„<u>å¶æ•°ä¸‹æ ‡ä½ç½®</u>ä¸Šï¼Œè¿™æµªè´¹äº†è¿‘ä¸€åŠçš„ç©ºé—´ã€‚</li>
<li>å› æ­¤2çš„næ¬¡å¹‚å®¹é‡ã€åŒå€æ‰©å®¹æœºåˆ¶å¯ä»¥ä½¿å®¹é‡ä¿æŒåœ¨å¶æ•°å€¼ï¼Œå¯ä»¥ä½¿æ·»åŠ çš„å…ƒç´ åœ¨HashMapçš„æ•°ç»„ä¸­å‡åŒ€åˆ†å¸ƒï¼Œå‡å°‘hashç¢°æ’ã€‚</li>
</ul>
</blockquote>
</li>
</ul>
<h3 id="ï¼ˆ3ï¼‰Hashå†²çªæ€ä¹ˆåŠ"><a href="#ï¼ˆ3ï¼‰Hashå†²çªæ€ä¹ˆåŠ" class="headerlink" title="ï¼ˆ3ï¼‰Hashå†²çªæ€ä¹ˆåŠ"></a>ï¼ˆ3ï¼‰Hashå†²çªæ€ä¹ˆåŠ</h3><pre class="mermaid">%%{
    init: {
    'themeVariables': {
        'fontSize': '13px',
        'edgeLabelBackground': '#ddebe6'
    }
}
}%%
graph TD

T(("1. <b>Hashå†²çª<br>æ€ä¹ˆä¼˜åŒ–</b>")):::p
--> T1("hashè¡¨é‡Œå¯ä»¥å­˜å‚¨å…ƒç´ çš„ä½ç½®<br>è¢«ç§°ä¸ºâ€œ<b>æ¡¶ï¼ˆbucketï¼‰</b>â€")
T1 --> |"<b>é€šå¸¸æƒ…å†µ</b>"| A("å•ä¸ªâ€œæ¡¶â€é‡Œå­˜å‚¨ä¸€ä¸ªå…ƒç´ ï¼Œ<br>æ­¤æ—¶æ€§èƒ½æœ€ä½³"):::g
A -.-> |"<i><b>O(1)</b></i>"| a["hashç®—æ³•å¯ä»¥æ ¹æ®hashCodeå€¼<br>è®¡ç®—å‡ºâ€œæ¡¶â€çš„å­˜å‚¨ä½ç½®ï¼Œ<br>æ¥ç€ä»â€œæ¡¶â€ä¸­å–å‡ºå…ƒç´ ã€‚"]
T1 --> |"<b>å“ˆå¸Œå†²çªçš„æƒ…å†µ</b>"| B("å•ä¸ªæ¡¶ä¼šå­˜å‚¨å¤šä¸ªå…ƒç´ <i>ï¼ˆhashå€¼ç›¸åŒï¼‰</i>"):::g
B -.-> |"<b><i>O(n)</b></i>"|b(["å¤šä¸ªå…ƒç´ ä»¥ <b><i>é“¾è¡¨</i></b> å½¢å¼å­˜å‚¨<br>"]):::B
b --> 2T(("2.<b> Hashå†²çª<br>å¾ˆå¤§æ€ä¹ˆä¼˜åŒ–</b>")):::p
subgraph "<i>ï¼ˆé“¾è¡¨å¿…é¡»æŒ‰é¡ºåºæœç´¢ï¼Œå­˜å–æ€§èƒ½å·®ï¼‰</i>"
2T --> C(["å°†é“¾è¡¨ç»“æ„è½¬ä¸º<b><i>çº¢é»‘æ ‘</i></b>"]):::B
C -.- |"<i><b>O(logn)</b></i>"|c["ä»¥æ ‘çš„é«˜åº¦ä¸ºæœ€å·®æŸ¥è¯¢æ€§èƒ½ï¼Œæ°¸è¿œä¸ä¼šå‡ºç°O(n)çš„æƒ…å†µã€‚"]:::info
end

classDef p fill:#ddaebd
classDef g fill:#f4e4e9
classDef B fill:#d9dfeb, stroke:#657eae,stroke-width:2px
classDef info fill:#f6f6f7,color:#737379, stroke-width: 2px, stroke-dasharray: 3 3</pre>
<ul>
<li><p><strong>Hashå†²çªç¤ºæ„å›¾</strong></p>
  <pre class="mermaid">    %%{
      init: {
          'themeVariables': {
              'clusterBorder': 'none',
              'clusterBkg': '#ececee'
          }
      }
  }%%
  %% é“¾è¡¨è¶…è¿‡8æ—¶æ ‘åŒ–æˆçº¢é»‘æ ‘
  graph TD

  subgraph "Node[]"
  Entry0["Node0<br><i><b>Nodeï¼œK,V></b></i>"] -.- Node1 -.- Node2 -.- Node3 -.- Node4 -.- Node5 -.- Node6
  end

  subgraph é“¾è¡¨
  Node1 --> A[Node] --> B[Node] --> C[Node] --> D[Node] --> E[Node] --> F[Node]  
  end

  subgraph çº¢é»‘æ ‘
  Node4 --> a[Node]
  a[Node] --> b[Node]
  b --> b1[Node]
  b --> b2[Node]
  a --> c[Node]
  c --> c1[Node]
  c --> c2[Node]
  b1 --> d[Node]
  b1 --> d2[Node]
  end

  style é“¾è¡¨ fill:#ddebe6
  style çº¢é»‘æ ‘ fill:#f4e4e9</pre>

</li>
</ul>
<h3 id="ï¼ˆ4ï¼‰å†…å­˜ç»“æ„ç¤ºæ„å›¾"><a href="#ï¼ˆ4ï¼‰å†…å­˜ç»“æ„ç¤ºæ„å›¾" class="headerlink" title="ï¼ˆ4ï¼‰å†…å­˜ç»“æ„ç¤ºæ„å›¾"></a>ï¼ˆ4ï¼‰å†…å­˜ç»“æ„ç¤ºæ„å›¾</h3><ul>
<li><p><strong>åˆ›å»ºå¯¹è±¡</strong>ï¼Œå†…å­˜ç»“æ„ç¤ºæ„å›¾ï¼š</p>
  <figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java">Map&lt;String, Integer&gt; countMap = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();<br>countMap.put(<span class="hljs-string">&quot;hello&quot;</span>, <span class="hljs-number">1</span>);<br>countMap.put(<span class="hljs-string">&quot;world&quot;</span>, <span class="hljs-number">3</span>);<br>countMap.put(<span class="hljs-string">&quot;position&quot;</span>, <span class="hljs-number">4</span>);<br></code></pre></td></tr></table></figure>

  <img src="https://equne.oss-cn-hangzhou.aliyuncs.com/typora/%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E5%9B%BE1.jpg" alt="å†…å­˜ç»“æ„å›¾1" style="zoom: 25%;" />
</li>
<li><p><strong>ä¿å­˜é”®å€¼å¯¹</strong></p>
<p>  â€œhelloâ€çš„hashå€¼ä¸º96207088ï¼Œæ¨¡16çš„ç»“æœä¸º0ï¼Œæ‰€ä»¥æ’å…¥table[0]æŒ‡å‘çš„é“¾è¡¨å¤´éƒ¨ï¼Œå†…å­˜ç»“æ„å˜ä¸ºï¼š</p>
  <img src="https://equne.oss-cn-hangzhou.aliyuncs.com/typora/%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E5%9B%BE2.jpg" alt="å†…å­˜ç»“æ„å›¾2" style="zoom: 25%;" />

<p>  â€œworldâ€çš„hashå€¼ä¸º111207038ï¼Œæ¨¡16ç»“æœä¸º14ï¼Œæ‰€ä»¥ä¿å­˜å®Œâ€œworldâ€åï¼Œå†…å­˜ç»“æ„ï¼š</p>
  <img src="https://equne.oss-cn-hangzhou.aliyuncs.com/typora/%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E5%9B%BE3.jpg" alt="å†…å­˜ç»“æ„å›¾3" style="zoom:25%;" />

<p>  â€œpositionâ€çš„hashå€¼ä¸º771782464ï¼Œæ¨¡16ç»“æœä¹Ÿä¸º0, table[0]å·²ç»æœ‰èŠ‚ç‚¹äº†ï¼Œæ–°èŠ‚ç‚¹ä¼šæ’åˆ°é“¾è¡¨å¤´éƒ¨ï¼Œå†…å­˜ç»“æ„å˜ä¸ºå¦‚å›¾ï¼š</p>
  <img src="https://equne.oss-cn-hangzhou.aliyuncs.com/typora/%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E5%9B%BE4.jpg" alt="å†…å­˜ç»“æ„å›¾4" style="zoom:25%;" /> 


</li>
</ul>
<h2 id="2-ä½¿ç”¨"><a href="#2-ä½¿ç”¨" class="headerlink" title="2. ä½¿ç”¨"></a>2. ä½¿ç”¨</h2><h3 id="ï¼ˆ1ï¼‰åŸºæœ¬ä½¿ç”¨"><a href="#ï¼ˆ1ï¼‰åŸºæœ¬ä½¿ç”¨" class="headerlink" title="ï¼ˆ1ï¼‰åŸºæœ¬ä½¿ç”¨"></a>ï¼ˆ1ï¼‰åŸºæœ¬ä½¿ç”¨</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><code class="hljs plaintext"><br>Printer.printHashMapStructures(map); // æ‰“å°æ ‘ç»“æ„<br>getMapFromStringParam();<br></code></pre></td></tr></table></figure>

<h3 id="ï¼ˆ2ï¼‰å¦‚ä½•éå†"><a href="#ï¼ˆ2ï¼‰å¦‚ä½•éå†" class="headerlink" title="ï¼ˆ2ï¼‰å¦‚ä½•éå†"></a>ï¼ˆ2ï¼‰å¦‚ä½•éå†</h3><pre class="mermaid">graph LR
T(("<b>éå†HashMap<br>çš„5ç§æ–¹æ³•</b>")):::p
T --> A(["<b>entrySet</b>"]):::lp
T --> B(["<b>keySet</b>"]):::lp
T --> C(["<b>forEach</b>"]):::lp
T --> |"æµæ“ä½œ"|D(["<b>StreamApi.forEach</b>"]):::lp
T -.-> E(["<b>values</b>"])

A -.-> a("<i>ï¼ˆ1ï¼‰entrySet</i>")
A -.-> a2("<i>ï¼ˆ2ï¼‰entrySet + è¿­ä»£å™¨</i>")
B -.-> |"ï¼ˆæ•ˆç‡ä½ï¼‰"| b("<i>ï¼ˆ3ï¼‰keySet + get()</i>")
C -.-> c("<i>ï¼ˆ4ï¼‰forEach + Lambda</i>")
D -.-> d("<i>ï¼ˆ5ï¼‰Stream().forEachï¼ˆå•çº¿ç¨‹ï¼‰</i>")
D -.-> d2("<i>ï¼ˆ6ï¼‰Stream().forEachï¼ˆå¤šçº¿ç¨‹ï¼‰</i>")
E -.-> e("<i>ï¼ˆ7ï¼‰ä»…éå†value</i>")

classDef p fill:#ddaebd
classDef lp fill:#f4e4e9
classDef B fill:#d9dfeb, stroke:#657eae,stroke-width:2px</pre>
<ul>
<li><p><strong>éå†HashMapä»£ç </strong>ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.equne;<br><br><span class="hljs-keyword">import</span> java.util.HashMap;<br><span class="hljs-keyword">import</span> java.util.Iterator;<br><span class="hljs-keyword">import</span> java.util.Map;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Main</span> </span>&#123;<br><br>    <span class="hljs-comment">/** ï¼ˆ1ï¼‰entrySet */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">traverse1</span><span class="hljs-params">(Map&lt;String, String&gt; map)</span> </span>&#123;<br>        <span class="hljs-keyword">for</span> (Map.Entry&lt;String, String&gt; entry : map.entrySet())&#123;<br>            System.out.println(entry.getKey() + <span class="hljs-string">&quot;, &quot;</span> + entry.getValue());<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/** ï¼ˆ2ï¼‰è¿­ä»£å™¨ï¼ˆentrySetï¼‰ */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">traverse2</span><span class="hljs-params">(Map&lt;String, String&gt; map)</span> </span>&#123;<br>        Iterator&lt;Map.Entry&lt;String, String&gt;&gt; iterator = map.entrySet().iterator();<br>        <span class="hljs-keyword">while</span> (iterator.hasNext())&#123;<br>            Map.Entry&lt;String, String&gt; entry = iterator.next();<br>            System.out.println(entry.getKey() + <span class="hljs-string">&quot;, &quot;</span> + entry.getValue());<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/** ï¼ˆ3ï¼‰keySet + get() */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">traverse3</span><span class="hljs-params">(Map&lt;String, String&gt; map)</span> </span>&#123;<br>        <span class="hljs-keyword">for</span> (String key : map.keySet())&#123;<br>            System.out.println(key + <span class="hljs-string">&quot;, &quot;</span> + map.get(key));<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/** ï¼ˆ4ï¼‰forEach + Lambda */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">traverse4</span><span class="hljs-params">(Map&lt;String, String&gt; map)</span> </span>&#123;<br>        map.forEach((key, value) -&gt; &#123;<br>            System.out.println(key + <span class="hljs-string">&quot;, &quot;</span> + value);<br>        &#125;);<br>    &#125;<br><br>    <span class="hljs-comment">/** ï¼ˆ5ï¼‰StreamApiï¼ˆå•çº¿ç¨‹ï¼‰ */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">traverse5</span><span class="hljs-params">(Map&lt;String, String&gt; map)</span> </span>&#123;<br>        map.entrySet().stream().forEach((entry) -&gt; &#123;<br>            System.out.println(entry.getKey() + <span class="hljs-string">&quot;, &quot;</span> +entry.getValue());<br>        &#125;);<br>    &#125;<br><br>    <span class="hljs-comment">/** ï¼ˆ6ï¼‰StreamApiï¼ˆå¤šçº¿ç¨‹ï¼‰ */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">traverse6</span><span class="hljs-params">(Map&lt;String, String&gt; map)</span> </span>&#123;<br>        map.entrySet().stream().parallel().forEach((entry) -&gt; &#123;<br>            System.out.println(entry.getKey() + <span class="hljs-string">&quot;, &quot;</span> +entry.getValue());<br>        &#125;);<br>    &#125;<br><br>    <span class="hljs-comment">/** ï¼ˆ7ï¼‰ä»…éå†value */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">traverse7</span><span class="hljs-params">(Map&lt;String, String&gt; map)</span> </span>&#123;<br>        <span class="hljs-keyword">for</span> (String v : map.values())&#123;<br>            System.out.println(v);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br><br>        Map&lt;String, String&gt; map = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();<br>        map.put(<span class="hljs-string">&quot;key1&quot;</span>, <span class="hljs-string">&quot;value1&quot;</span>);<br>        map.put(<span class="hljs-string">&quot;key2&quot;</span>, <span class="hljs-string">&quot;value2&quot;</span>);<br>        traverse1(map);<br>        traverse2(map);<br>        traverse3(map);<br>        traverse4(map);<br>        traverse5(map);<br>        traverse6(map);<br>        traverse7(map);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p><strong>entrySet å’Œ keySet</strong></p>
<blockquote>
<ul>
<li>Map.entrySet è¿­ä»£å™¨ä¼šç”Ÿæˆ EntryIteratorï¼Œå…¶è¿”å›çš„å®ä¾‹æ˜¯ä¸€ä¸ªåŒ…å« <strong>key/value é”®å€¼å¯¹</strong>çš„å¯¹è±¡ã€‚</li>
<li>è€Œ keySet ä¸­è¿­ä»£å™¨è¿”å›çš„åªæ˜¯ key å¯¹è±¡ï¼Œè¿˜éœ€è¦åˆ° map ä¸­äºŒæ¬¡å–å€¼ï¼ˆå¤šä¸€ä¸ªgetæ–¹æ³•çš„è°ƒç”¨ï¼‰ã€‚æ•… entrySet è¦æ¯” keySet å¿«ä¸€å€å·¦å³ã€‚ï¼ˆkeySeté€‚åˆä»…éœ€è¦æ“ä½œkeyæ—¶ä½¿ç”¨ï¼‰<br>ğŸ”— <em>æ‘˜è‡ªï¼š<a href="https://book.douban.com/subject/35187133/">ã€ŠJavaä¿®ç‚¼æŒ‡å—ï¼šé«˜é¢‘æºç è§£æã€‹</a></em></li>
</ul>
</blockquote>
</li>
<li><p><strong>foreach + Lambda è¡¨è¾¾å¼</strong>ï¼ˆJava8 çš„æ–°ç‰¹æ€§ï¼‰</p>
<blockquote>
<ul>
<li>forEach()ï¼šç”¨äºéå†åŠ¨æ€æ•°ç»„ä¸­æ¯ä¸€ä¸ªå…ƒç´ å¹¶æ‰§è¡Œç‰¹å®šæ“ä½œã€‚</li>
<li>Lambda è¡¨è¾¾å¼ï¼šç®­å¤´ç¬¦å· <code>-&gt;</code>ï¼Œå…¶ä¸¤è¾¹è¿æ¥ç€<strong>è¾“å…¥å‚æ•°</strong>å’Œ<strong>å‡½æ•°ä½“</strong>ã€‚</li>
</ul>
</blockquote>
</li>
<li><p><strong>Stream()</strong></p>
<blockquote>
<ul>
<li>å…¶å®ç”¨Iterableæœ¬èº«çš„forEachæ–¹æ³•å³å¯ï¼Œæ²¡æœ‰å¿…è¦ç”¨æµå¼æ“ä½œã€‚StreamApié€‚åˆåœ¨å¯¹é›†åˆè¿›è¡Œå…¶ä»–<strong>æµå¼æ“ä½œ</strong>ä¹‹åä½¿ç”¨ã€‚</li>
<li>è¡¥å……ï¼šç”¨æµè·å–æ˜ å°„å€¼çš„æç«¯æ¡ˆä¾‹ï¼š<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java">Optional&lt;String&gt; value = map<br>    .entrySet()<br>    .stream()<br>    .filter(entry -&gt; entry.getKey().equals(key))<br>    .map(Entry::getValue) <span class="hljs-comment">// åŒå†’å·ï¼šå¼•ç”¨æ–¹æ³•</span><br>    .findFirst();<br></code></pre></td></tr></table></figure>
ğŸ”— <em>æ‘˜è‡ªï¼š<a href="https://book.douban.com/subject/36142061/">ã€Šå¥½ä»£ç ï¼Œåä»£ç ã€‹</a></em></li>
</ul>
</blockquote>
</li>
</ul>
<p>.</p>
<hr>
<h1 id="äºŒã€HashMapæºç "><a href="#äºŒã€HashMapæºç " class="headerlink" title="äºŒã€HashMapæºç "></a>äºŒã€HashMapæºç </h1><blockquote>
<p>æ³¨ï¼šæœ¬æ–‡æºç ç‰ˆæœ¬å‡ä¸ºï¼šJDK 8 </p>
</blockquote>
<h2 id="1-å±æ€§"><a href="#1-å±æ€§" class="headerlink" title="1. å±æ€§"></a>1. å±æ€§</h2><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ğŸ”¹ å¸¸é‡</span><br><span class="hljs-comment">// é»˜è®¤çš„åˆå§‹å®¹é‡å€¼ï¼ˆ16ï¼‰- å¿…é¡»æ˜¯2çš„næ¬¡å¹‚</span><br><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> DEFAULT_INITIAL_CAPACITY = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">4</span>;<br><br><span class="hljs-comment">// æœ€å¤§å®¹é‡ä¸Šé™ï¼ˆ2çš„30æ¬¡æ–¹ï¼‰</span><br><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> MAXIMUM_CAPACITY = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">30</span>;<br><br><span class="hljs-comment">// é»˜è®¤çš„è´Ÿè½½å› æ•°ï¼ˆ0.75ï¼‰</span><br><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">float</span> DEFAULT_LOAD_FACTOR = <span class="hljs-number">0.75f</span>;<br><br><span class="hljs-comment">// æ ‘åŒ–é˜ˆå€¼ï¼šå½“ä¸€ä¸ªæ¡¶ä¸­çš„å…ƒç´ ä¸ªæ•°å¤§äºç­‰äº8æ—¶è¿›è¡Œæ ‘åŒ–</span><br><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> TREEIFY_THRESHOLD = <span class="hljs-number">8</span>;<br><br><span class="hljs-comment">// æ ‘é™çº§ä¸ºé“¾è¡¨çš„ä»“ä½è®¡æ•°é˜ˆå€¼ï¼Œå½“ä¸€ä¸ªæ¡¶ä¸­çš„å…ƒç´ ä¸ªæ•°å°äºç­‰äº6æ—¶æŠŠæ ‘è½¬åŒ–ä¸ºé“¾è¡¨ã€‚</span><br><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> UNTREEIFY_THRESHOLD = <span class="hljs-number">6</span>;<br><br><span class="hljs-comment">// å°†tableæ ‘åŒ–çš„æœ€å°å®¹é‡å€¼ï¼ˆ64ï¼‰ï¼šå½“æ¡¶çš„ä¸ªæ•°è¾¾åˆ°64çš„æ—¶å€™æ‰è¿›è¡Œæ ‘åŒ–ï¼ˆè‡³å°‘åº”ä¸º4*TREEIFY_THRESHOLDï¼Œä»¥é¿å…è°ƒæ•´å¤§å°å’Œæ ‘åŒ–é˜ˆå€¼ä¹‹é—´çš„å†²çªã€‚ï¼‰</span><br><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> MIN_TREEIFY_CAPACITY = <span class="hljs-number">64</span>;<br><br><span class="hljs-comment">// ğŸ”¹ å˜é‡</span><br><span class="hljs-comment">// Nodeæ•°ç»„ï¼Œåˆå«ä½œæ¡¶ï¼ˆbucketï¼‰</span><br><span class="hljs-keyword">transient</span> Node&lt;K,V&gt;[] table;<br><br><span class="hljs-comment">// ä½œä¸ºentrySet()çš„ç¼“å­˜</span><br><span class="hljs-keyword">transient</span> Set&lt;Map.Entry&lt;K,V&gt;&gt; entrySet;<br><br><span class="hljs-comment">// å…ƒç´ çš„æ•°é‡</span><br><span class="hljs-keyword">transient</span> <span class="hljs-keyword">int</span> size;<br><br><span class="hljs-comment">// è®°å½•hashMapçš„ä¿®æ”¹æ¬¡æ•°ï¼ˆæ¯æ¬¡æ‰©å®¹å’Œæ›´æ”¹ map ç»“æ„çš„è®¡æ•°å™¨ï¼‰</span><br><span class="hljs-keyword">transient</span> <span class="hljs-keyword">int</span> modCount;<br><br><span class="hljs-comment">// æ‰©å®¹é˜ˆå€¼ = table.length * loadFactorï¼ˆå½“sizeå¤§äºé˜ˆå€¼æ—¶æ‰©å®¹ï¼‰</span><br><span class="hljs-keyword">int</span> threshold;<br><br><span class="hljs-comment">// è´Ÿè½½å› æ•°ï¼šè¡¨ç¤ºæ•´ä½“ä¸Štableè¢«å ç”¨çš„ç¨‹åº¦</span><br><span class="hljs-keyword">final</span> <span class="hljs-keyword">float</span> loadFactor;<br><br></code></pre></td></tr></table></figure>

<h2 id="2-æ„é€ æ–¹æ³•"><a href="#2-æ„é€ æ–¹æ³•" class="headerlink" title="2. æ„é€ æ–¹æ³•"></a>2. æ„é€ æ–¹æ³•</h2><pre class="mermaid">graph LR

T(("<b>HashMap<br>æ„é€ æ–¹æ³•</b>")):::p
T --> A(["<i>HashMap map1 = new HashMap();</i>"]):::lp
T --> B(["<i>HashMap map2 = new HashMap(30);</i>"]):::lp
T --> C(["<i>HashMap map3 = new HashMap(30, 0.5f);</i>"]):::lp
T --> D(["<i>HashMap map4 = new HashMap(map);</i>"]):::lp

A --- |"æ— å‚æ„é€ æ–¹æ³•"|a("ä¸æŒ‡å®šå®¹é‡ï¼Œé»˜è®¤:16")
B --- |"<i>initialCapacoty</i>"| b("æŒ‡å®šåˆå§‹åŒ–å®¹é‡ï¼š30")
C --- |"<i>initialCapacoty<br>loadFactor</i>"| c("æŒ‡å®šåˆå§‹åŒ–å®¹é‡ã€è´Ÿè½½å› æ•°")
D --- |"<i>Map map</i>"| d("ä»¥æŒ‡å®šmapæ„é€ æ–°map</i>")

D -.- ci("* æ³¨æ„ï¼š<br>ä¸ä¸Šè¿°ä»…åˆ›å»ºç©ºHashMapä¸åŒï¼Œ<br>æ­¤æ–¹æ³•å†…éƒ¨è°ƒç”¨äº†put()å­˜å€¼<br>tableæ‰çœŸæ­£è¿›è¡Œäº†åˆå§‹åŒ–ã€‚"):::info

classDef p fill:#ddaebd
classDef lp fill: #f4e4e9
classDef info fill:#f6f6f7,color:#737379,stroke-dasharray: 3 3, stroke-width: 2px</pre>

<h3 id="ï¼ˆ1ï¼‰HashMap"><a href="#ï¼ˆ1ï¼‰HashMap" class="headerlink" title="ï¼ˆ1ï¼‰HashMap()"></a>ï¼ˆ1ï¼‰HashMap()</h3><ul>
<li>æ— å‚æ•°çš„æ„é€ æ–¹æ³•<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Constructs an empty HashMap with the default initial capacity(16) and the default load factor (0.75).</span><br><span class="hljs-comment"> * ä»¥é»˜è®¤åˆå§‹å®¹é‡(16)å’Œé»˜è®¤è´Ÿè½½å› æ•°(0.75)ï¼Œæ„é€ ä¸€ä¸ªç©ºçš„HashMapã€‚</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">HashMap</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-comment">// ğŸ”» å°†è´Ÿè½½å› æ•°èµ‹ä¸ºé»˜è®¤å€¼ã€‚</span><br>    <span class="hljs-keyword">this</span>.loadFactor = DEFAULT_LOAD_FACTOR; <span class="hljs-comment">// all other fields defaulted</span><br>&#125;<br></code></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="ï¼ˆ2ï¼‰HashMap-20"><a href="#ï¼ˆ2ï¼‰HashMap-20" class="headerlink" title="ï¼ˆ2ï¼‰HashMap(20)"></a>ï¼ˆ2ï¼‰HashMap(20)</h3><ul>
<li>å¸¦åˆå§‹å®¹é‡çš„æ„é€ æ–¹æ³•ï¼š<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Constructs an empty HashMap with the specified initial capacity and the default load factor (0.75).</span><br><span class="hljs-comment"> * ä»¥ç‰¹å®šçš„åˆå§‹å®¹é‡å’Œé»˜è®¤çš„è´Ÿè½½å› æ•°(0.75)ï¼Œæ„é€ ä¸€ä¸ªç©ºçš„HashMap</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span>  initialCapacity åˆå§‹å®¹é‡</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@throws</span> IllegalArgumentException åˆå§‹å®¹é‡ä¸ºè´Ÿå€¼æ—¶æŠ›å‡ºéæ³•æ•°æ®å¼‚å¸¸ã€‚</span><br><span class="hljs-comment"> */</span><br> <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">HashMap</span><span class="hljs-params">(<span class="hljs-keyword">int</span> initialCapacity)</span> </span>&#123;<br>    <span class="hljs-comment">// ğŸ”» è°ƒç”¨äº†å¸¦åˆå§‹å®¹é‡ã€è´Ÿè½½å› æ•°çš„æ„é€ æ–¹æ³•ï¼ˆè¯¦è§ä¸‹æ–‡(3)ï¼‰</span><br>    <span class="hljs-keyword">this</span>(initialCapacity, DEFAULT_LOAD_FACTOR);<br> &#125;<br></code></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="ï¼ˆ3ï¼‰HashMap-20-0-5f"><a href="#ï¼ˆ3ï¼‰HashMap-20-0-5f" class="headerlink" title="ï¼ˆ3ï¼‰HashMap(20, 0.5f)"></a>ï¼ˆ3ï¼‰HashMap(20, 0.5f)</h3><ul>
<li>å¸¦åˆå§‹å®¹é‡ã€è´Ÿè½½å› æ•°çš„æ„é€ æ–¹æ³•<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Constructs an empty HashMap with the specified initial capacity and load factor.</span><br><span class="hljs-comment"> * ä»¥ç‰¹å®šçš„åˆå§‹å®¹é‡å’Œè´Ÿè½½å› æ•°æ„é€ ä¸€ä¸ªç©ºçš„HashMapã€‚</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span>  initialCapacity åˆå§‹åŒ–å®¹é‡</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span>  loadFactor      è´Ÿè½½å› æ•°</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@throws</span> IllegalArgumentException if the initial capacity is negative</span><br><span class="hljs-comment"> *         or the load factor is nonpositive</span><br><span class="hljs-comment"> *         å½“åˆå§‹å®¹é‡ä¸ºè´Ÿå€¼ã€æˆ–è´Ÿè½½å› æ•°ä¸ºéæ­£æ—¶æŠ›å‡ºéæ³•æ•°æ®å¼‚å¸¸ã€‚</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">HashMap</span><span class="hljs-params">(<span class="hljs-keyword">int</span> initialCapacity, <span class="hljs-keyword">float</span> loadFactor)</span> </span>&#123;<br>    <span class="hljs-comment">// ğŸ”´ ä¸€ã€åˆ¤æ–­ä¼ å…¥å‚æ•°çš„åˆæ³•æ€§</span><br>    <span class="hljs-comment">//  ğŸ”¹ åˆå§‹å®¹é‡å€¼éè´Ÿæ•°</span><br>    <span class="hljs-keyword">if</span> (initialCapacity &lt; <span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalArgumentException(<span class="hljs-string">&quot;Illegal initial capacity: &quot;</span> +<br>                                           initialCapacity);       <br>    <span class="hljs-comment">//  ğŸ”¹ åˆå§‹å®¹é‡å€¼ä¸è¶…è¿‡æœ€å¤§å®¹é‡</span><br>    <span class="hljs-keyword">if</span> (initialCapacity &gt; MAXIMUM_CAPACITY)<br>        initialCapacity = MAXIMUM_CAPACITY;<br>    <span class="hljs-comment">//  ğŸ”¹ è´Ÿè½½å› æ•°å¤§äº0ä¸”ä¸ºæ•°å­—</span><br>    <span class="hljs-keyword">if</span> (loadFactor &lt;= <span class="hljs-number">0</span> || Float.isNaN(loadFactor))<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalArgumentException(<span class="hljs-string">&quot;Illegal load factor: &quot;</span> +<br>                                         loadFactor);<br><br>    <span class="hljs-comment">// ğŸ”´ äºŒã€ä¸ºé…ç½®å‚æ•°èµ‹å€¼</span><br>    <span class="hljs-comment">//  ğŸ”¹ ä¸ºè´Ÿè½½å› æ•°èµ‹å€¼</span><br>    <span class="hljs-keyword">this</span>.loadFactor = loadFactor;<br>    <span class="hljs-comment">//  ğŸ”¹ ä¸ºæ‰©å®¹é˜ˆå€¼èµ‹å€¼ï¼šä½¿ç”¨tableSizeFor()å°†ç»™å®šæ•°å€¼è°ƒæ•´ä¸º2çš„æ¬¡å¹‚æ•°ã€‚</span><br>    <span class="hljs-keyword">this</span>.threshold = tableSizeFor(initialCapacity);<br>&#125;<br></code></pre></td></tr></table></figure>



</li>
</ul>
<h3 id="ï¼ˆ4ï¼‰HashMap-map"><a href="#ï¼ˆ4ï¼‰HashMap-map" class="headerlink" title="ï¼ˆ4ï¼‰HashMap(map)"></a>ï¼ˆ4ï¼‰HashMap(map)</h3><h4 id="HashMap"><a href="#HashMap" class="headerlink" title="- HashMap()"></a>- <em>HashMap()</em></h4><ul>
<li>å¸¦mapçš„æ„é€ æ–¹æ³•  <figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Constructs a new HashMap with the same mappings as the specified Map.</span><br><span class="hljs-comment"> * The HashMap is created with default load factor (0.75) and an initial capacity sufficient to hold the mappings in the specified Map.</span><br><span class="hljs-comment"> * ä½¿ç”¨ä¸æŒ‡å®šMapç›¸åŒçš„æ˜ å°„æ„é€ æ–°çš„HashMapã€‚</span><br><span class="hljs-comment"> * æ­¤HashMapç”±ï¼šé»˜è®¤è´Ÿè½½å› æ•°(0.75)ã€è¶³å¤Ÿçš„åˆå§‹å®¹é‡ï¼ˆè¶³ä»¥å­˜ä¸‹æŒ‡å®šMapï¼‰åˆ›å»ºã€‚</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span>   m the map whose mappings are to be placed in this map</span><br><span class="hljs-comment"> * @å‚æ•°ï¼š   mï¼ŒåŸmap</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@throws</span>  NullPointerException if the specified map is null</span><br><span class="hljs-comment"> * @å¼‚å¸¸ï¼š   å½“åŸmapä¸ºç©ºæ—¶æŠ›å‡ºç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">HashMap</span><span class="hljs-params">(Map&lt;? extends K, ? extends V&gt; m)</span> </span>&#123;<br>    <span class="hljs-comment">// ğŸ”» å°†è´Ÿè½½å› æ•°èµ‹ä¸ºé»˜è®¤å€¼ã€‚</span><br>    <span class="hljs-keyword">this</span>.loadFactor = DEFAULT_LOAD_FACTOR;<br>    <span class="hljs-comment">// ğŸ”» è°ƒç”¨putMapEntries()ï¼Œå°†åŸæœ‰mapå­˜å…¥æ–°mapã€‚</span><br>    putMapEntries(m, <span class="hljs-keyword">false</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="putMapEntries"><a href="#putMapEntries" class="headerlink" title="- putMapEntries()"></a>- <em>putMapEntries()</em></h4><ul>
<li>èµ‹å€¼å¹¶åˆå§‹åŒ–å‡½æ•°<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Implements Map.putAll and Map constructor.</span><br><span class="hljs-comment"> * èµ‹å€¼å¹¶æ„é€ å‡½æ•°ã€‚</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> m the map</span><br><span class="hljs-comment"> * @å‚æ•°ï¼š mï¼Œä¼ å…¥çš„map</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> evict false when initially constructing this map, else true (relayed to method afterNodeInsertion).</span><br><span class="hljs-comment"> * @å‚æ•°ï¼š evictï¼Œé¦–æ¬¡åˆ›å»ºæ­¤mapæ—¶è¿”å›falseï¼Œéé¦–æ¬¡åˆ›å»ºè¿”å›trueã€‚</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title">putMapEntries</span><span class="hljs-params">(Map&lt;? extends K, ? extends V&gt; m, <span class="hljs-keyword">boolean</span> evict)</span> </span>&#123;<br>    <span class="hljs-keyword">int</span> s = m.size(); <span class="hljs-comment">// mçš„å…ƒç´ ä¸ªæ•°</span><br>    <span class="hljs-comment">// ğŸ”´ ä¸€ã€è‹¥mä¸­æœ‰å…ƒç´ ï¼Œéœ€è¦æ ¹æ®æ–°Mapçš„åˆå§‹åŒ–æƒ…å†µä¸ºå…¶æ‰©å®¹é˜ˆå€¼èµ‹å€¼ã€‚ ï¼ˆè‹¥mæ— å…ƒç´ åˆ™æ— éœ€èµ‹å€¼ï¼Œç›´æ¥ä½¿ç”¨ç»™å®šçš„è´Ÿè½½å› æ•°å’Œæ‰©å®¹é˜ˆå€¼(lf*cap)å®Œæˆæ„é€ ã€‚ï¼‰</span><br>    <span class="hljs-keyword">if</span> (s &gt; <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-comment">// ğŸ”¹ è‹¥æ•°ç»„æœªåˆå§‹åŒ–ï¼šæ ¹æ®mä¸­å…ƒç´ æ•°é‡å’Œè´Ÿè½½å› æ•°è®¡ç®—æ–°Mapçš„æ‰©å®¹é˜ˆå€¼ã€‚</span><br>        <span class="hljs-keyword">if</span> (table == <span class="hljs-keyword">null</span>) &#123; <span class="hljs-comment">// pre-size</span><br>            <span class="hljs-comment">// mçš„æ‰©å®¹é˜ˆå€¼ = å…ƒç´ æ•°é‡ / è´Ÿè½½å› æ•°ï¼ˆğŸ”¸+1.0Fï¼šå¯¹å°æ•°åšå‘ä¸Šå–æ•´ä»¥å°½å¯èƒ½ä¿è¯æ›´å¤§å®¹é‡ï¼‰</span><br>            <span class="hljs-keyword">float</span> ft = ((<span class="hljs-keyword">float</span>)s / loadFactor) + <span class="hljs-number">1.0F</span>;<br>            <span class="hljs-comment">// å°†mæ‰©å®¹é˜ˆå€¼çš„æ•°æ®ç±»å‹è½¬ä¸ºæ•´å‹ï¼Œå¹¶é™å®šåœ¨é»˜è®¤å®¹é‡ä¸Šé™å†…</span><br>            <span class="hljs-keyword">int</span> t = ((ft &lt; (<span class="hljs-keyword">float</span>)MAXIMUM_CAPACITY) ?<br>                     (<span class="hljs-keyword">int</span>)ft : MAXIMUM_CAPACITY);<br>            <span class="hljs-comment">// è‹¥è®¡ç®—å‡ºmçš„æ‰©å®¹é˜ˆå€¼ &gt; æ–°Mapæ‰©å®¹é˜ˆå€¼ï¼Œè°ƒç”¨tableSizeForæ–¹æ³•ï¼Œå°†æ–°Mapæ‰©å®¹é˜ˆå€¼è®¾ç½®ä¸ºï¼šè¯¥å€¼æœ€æ¥è¿‘å®¹é‡çš„2æ¬¡å¹‚æ•°ã€‚</span><br>            <span class="hljs-keyword">if</span> (t &gt; threshold)<br>                threshold = tableSizeFor(t);<br>        &#125;<br>        <span class="hljs-comment">// ğŸ”¹ è‹¥æ•°ç»„å·²åˆå§‹åŒ–ã€ä¸”Mapä¸­çš„å…ƒç´ æ•°é‡è¶…è¿‡äº†å…¶æ‰©å®¹é˜ˆå€¼ï¼šæ‰©å®¹ã€‚</span><br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (s &gt; threshold)<br>            resize();<br>        <span class="hljs-comment">// ğŸ”´ äºŒã€èµ‹å€¼ï¼šéå†mçš„entryï¼Œé€ä¸ªèµ‹å€¼åˆ°æ–°Mapä¸Šã€‚</span><br>        <span class="hljs-keyword">for</span> (Map.Entry&lt;? extends K, ? extends V&gt; e : m.entrySet()) &#123;<br>            K key = e.getKey();<br>            V value = e.getValue();<br>            <span class="hljs-comment">// ğŸ”¹ è°ƒç”¨putVal()ä¸ºæ¯ä¸ªèŠ‚ç‚¹èµ‹å€¼ï¼ˆæ­¤æ—¶æ–°Mapæ‰çœŸæ­£åˆå§‹åŒ–å®Œæˆï¼‰</span><br>            putVal(hash(key), key, value, <span class="hljs-keyword">false</span>, evict);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><code>((float)s / loadFactor) + 1.0F</code> + 1.0Fï¼šä¸ºäº†è®©æµ®ç‚¹æ•°è¿›è¡Œé™¤æ³•è®¡ç®—åå‘ä¸Šå–æ•´ï¼Œä»¥å°½å¯èƒ½ä¿è¯è¶³å¤Ÿå®¹é‡ã€‚</li>
</ul>
<h2 id="3-é™æ€å®ç”¨ç¨‹åº"><a href="#3-é™æ€å®ç”¨ç¨‹åº" class="headerlink" title="3. é™æ€å®ç”¨ç¨‹åº"></a>3. é™æ€å®ç”¨ç¨‹åº</h2><h3 id="hash"><a href="#hash" class="headerlink" title="- hash()"></a>- <em>hash()</em></h3><ul>
<li><strong>è®¡ç®—key.hashCode()</strong><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/* ---------------- Static utilities -------------- */</span><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Computes key.hashCode() and spreads (XORs) higher bits of hash to lower. </span><br><span class="hljs-comment"> * è®¡ç®—key.hashCode()å¹¶å°†å“ˆå¸Œçš„é«˜ä½æ‰©å±•ï¼ˆå¼‚æˆ–è¿ç®—ï¼‰åˆ°ä½ä½ã€‚</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> <span class="hljs-title">hash</span><span class="hljs-params">(Object key)</span> </span>&#123;<br>    <span class="hljs-keyword">int</span> h;<br>    <span class="hljs-keyword">return</span> (key == <span class="hljs-keyword">null</span>) ? <span class="hljs-number">0</span> : (h = key.hashCode()) ^ (h &gt;&gt;&gt; <span class="hljs-number">16</span>);<br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><code>(h=key.hashCode()) ^ (h &gt;&gt;&gt;16)</code><blockquote>
<p><strong>hash(Object) æ–¹æ³•é€šè¿‡ä»¥ä¸Šè¡¨è¾¾å¼å¾—åˆ°æŒ‡å®šå¯¹è±¡çš„Hashå€¼</strong>ã€‚<br>è¿™é‡Œæ˜¯å–å¾—å½“å‰å¯¹è±¡çš„Hashå€¼ï¼Œé¦–å…ˆè¿›è¡Œ<strong><em>å¸¦ç¬¦å·ä½çš„å³ç§»16ä½</em></strong>æ“ä½œï¼ˆè¿™æ—¶å€™å¯¹è±¡Hashå€¼çš„é«˜ä½æ®µå°±å˜æˆäº†ä½ä½æ®µï¼‰ï¼Œç„¶åä¸å¯¹è±¡åŸæ¥çš„Hashå€¼è¿›è¡Œ<strong><em>å¼‚æˆ–è¿ç®—</em></strong>ã€‚</p>
</blockquote>
</li>
<li><strong>å¼‚æˆ–çš„åŸå› </strong>ï¼š<blockquote>
<p>å› ä¸ºæ•°ç»„å®¹é‡æ€»æ˜¯2çš„næ¬¡å¹‚æ•°ï¼Œè®¡ç®—ç´¢å¼•ä½ç½®æ—¶ï¼Œæ•£åˆ—çœŸæ­£ç”Ÿæ•ˆçš„åªæ˜¯ä½<strong><em>n</em></strong>bitçš„æœ‰æ•ˆä½ï¼Œå¾ˆå®¹æ˜“å‘ç”Ÿç¢°æ’ã€‚å› æ­¤ï¼ŒæŠŠé«˜16bitå’Œä½16bitå¼‚æˆ–ä¸€ä¸‹ï¼Œæ—¢å‡å°‘äº†ç³»ç»Ÿçš„å¼€é”€ï¼Œä¹Ÿä¸ä¼šé€ æˆå› ä¸ºé«˜ä½æ²¡æœ‰å‚ä¸ä¸‹æ ‡çš„è®¡ç®—(tableé•¿åº¦æ¯”è¾ƒå°)æ—¶ï¼Œå¼•èµ·ç¢°æ’ã€‚</p>
</blockquote>
</li>
</ul>
<h3 id="tableSizeFor"><a href="#tableSizeFor" class="headerlink" title="- tableSizeFor()"></a>- <em>tableSizeFor()</em></h3><ul>
<li><strong>è¿”å›æœ€æ¥è¿‘ç»™å®šç›®æ ‡å®¹é‡çš„äºŒæ¬¡å¹‚æ•°å€¼</strong><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Returns a power of two size for the given target capacity.</span><br><span class="hljs-comment"> * è¿”å›ç»™å®šç›®æ ‡å®¹é‡çš„äºŒæ¬¡å¹‚æ•°ã€‚</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> <span class="hljs-title">tableSizeFor</span><span class="hljs-params">(<span class="hljs-keyword">int</span> cap)</span> </span>&#123;<br>    <span class="hljs-keyword">int</span> n = cap - <span class="hljs-number">1</span>;<br>    n |= n &gt;&gt;&gt; <span class="hljs-number">1</span>;<br>    n |= n &gt;&gt;&gt; <span class="hljs-number">2</span>;<br>    n |= n &gt;&gt;&gt; <span class="hljs-number">4</span>;<br>    n |= n &gt;&gt;&gt; <span class="hljs-number">8</span>;<br>    n |= n &gt;&gt;&gt; <span class="hljs-number">16</span>;<br>    <span class="hljs-keyword">return</span> (n &lt; <span class="hljs-number">0</span>) ? <span class="hljs-number">1</span> : (n &gt;= MAXIMUM_CAPACITY) ? MAXIMUM_CAPACITY : n + <span class="hljs-number">1</span>;<br>&#125;<br><br><br><span class="hljs-comment">/* ä»¥ä¸‹ä¸ºå¤‡æ³¨ï¼š</span><br><span class="hljs-comment">    -------------------------------------------------</span><br><span class="hljs-comment">      * è¯¥ä½è¿ç®—ç”¨äºæ±‚å‡ºé«˜ä½1ä¹‹åæ¯ä½éƒ½ä¸º1çš„ç»“æœã€‚</span><br><span class="hljs-comment">        å› ä¸ºå°†æ¯ä½å˜ä¸º1ï¼Œåˆ™åŠ ä¸Š1ååˆšå¥½æ˜¯ä¸€ä¸ªäºŒæ¬¡å¹‚æ•°ã€‚</span><br><span class="hljs-comment">        å¦‚(0000 1000)ï¼Œä½¿å…¶ç¬¬ä¸€ä½1åé¢éƒ½ä¸º1ï¼Œå³(0000 1111)</span><br><span class="hljs-comment">    ------------------------------------------------- */</span><br><br>        <span class="hljs-comment">// å¦‚ï¼ŒinitialCapacity = 9</span><br>        <span class="hljs-comment">// ğŸ”´ å°† n - 1</span><br>	<span class="hljs-keyword">int</span> n = cap -<span class="hljs-number">1</span>; <span class="hljs-comment">// n = 8	</span><br><br>        <span class="hljs-comment">// ğŸ”´ ä½œä½è¿ç®—ï¼š1. æ— ç¬¦å·ä½ç§» 2. ä¸nä½œæˆ–çš„ä½è¿ç®—ã€‚</span><br>	n |= n &gt;&gt;&gt; <span class="hljs-number">1</span>; <br>	n = <span class="hljs-number">0000</span> <span class="hljs-number">1000</span><br>	n = <span class="hljs-number">0000</span> <span class="hljs-number">0100</span><br>	n = <span class="hljs-number">0000</span> <span class="hljs-number">1100</span>  <br><br>	n |= n &gt;&gt;&gt; <span class="hljs-number">2</span>;<br>	n = <span class="hljs-number">0000</span> <span class="hljs-number">1100</span><br>	n = <span class="hljs-number">0000</span> <span class="hljs-number">0011</span><br>	n = <span class="hljs-number">0000</span> <span class="hljs-number">1111</span>  <span class="hljs-comment">// =15</span><br><br>	n |= n &gt;&gt;&gt; <span class="hljs-number">4</span>;<br>	n = <span class="hljs-number">0000</span> <span class="hljs-number">1111</span><br>	n = <span class="hljs-number">0000</span> <span class="hljs-number">0000</span>  <br>	n = <span class="hljs-number">0000</span> <span class="hljs-number">1111</span>  <br><br>	n |= n &gt;&gt;&gt; <span class="hljs-number">8</span>;<br>	n = <span class="hljs-number">0000</span> <span class="hljs-number">1111</span><br>	n = <span class="hljs-number">0000</span> <span class="hljs-number">0000</span><br>	n = <span class="hljs-number">0000</span> <span class="hljs-number">1111</span>  <br><br>	n |= n &gt;&gt;&gt; <span class="hljs-number">16</span>;	<br>        <span class="hljs-comment">// ğŸ”¸ å› ä¸ºintæ˜¯32ä½çš„ï¼Œæ‰€ä»¥æ‰§è¡Œåˆ°16å³å¯.</span><br><br><br>        <span class="hljs-comment">// ğŸ”´ è¿”å›ä½ç§»ç»“æœn + 1</span><br>	<span class="hljs-keyword">return</span> (n &lt; <span class="hljs-number">0</span>) ? <span class="hljs-number">1</span> : (n &gt;= MAXIMUM_CAPACITY) ? MAXIMUN_CAPACITY : n + <span class="hljs-number">1</span>;<br>	 n &lt; <span class="hljs-number">0</span>, åˆ™è¿”å› n = <span class="hljs-number">1</span> <br>	 n &gt;= <span class="hljs-number">0</span>, ä¸” n &gt;= æœ€å¤§å®¹é‡, åˆ™è¿”å›æœ€å¤§å®¹é‡ <br>	 n &gt;= <span class="hljs-number">0</span>, ä¸” n &lt; æœ€å¤§å®¹é‡, åˆ™è¿”å› n + <span class="hljs-number">1</span> ï¼ˆ=<span class="hljs-number">16</span>ï¼‰<br><br>     <br></code></pre></td></tr></table></figure></li>
<li><strong>ä¸ºä»€ä¹ˆå…ˆè¿›è¡Œ<code>n-1</code>æ“ä½œï¼š</strong>ä¸ºäº†å¤„ç†nåˆšå¥½æ˜¯äºŒæ¬¡å¹‚æ•°çš„æƒ…å†µã€‚<blockquote>
<p>ğŸ¦‹ è‹¥nå·²ç»æ˜¯2çš„næ¬¡å¹‚äº†ï¼ŒæŒ‰ç…§é€»è¾‘å˜1ä¹‹åå†åŠ 1ï¼Œç»“æœå°±ä¼šå˜æˆnçš„2å€äº†ï¼Œä¸åº”æœ‰çš„ç»“æœä¸ä¸€è‡´ã€‚å¦‚ï¼Œn=16ï¼ˆ0001 0000ï¼‰ï¼Œä½è¿ç®—å n=31ï¼ˆ0001 1111ï¼‰ã€‚</p>
</blockquote>
</li>
</ul>
<h3 id="Comparable"><a href="#Comparable" class="headerlink" title="- Comparable"></a>- <em>Comparable</em></h3><ul>
<li><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Returns x&#x27;s Class if it is of the form &quot;class C implements</span><br><span class="hljs-comment"> * Comparable&lt;C&gt;&quot;, else null.</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">static</span> Class&lt;?&gt; comparableClassFor(Object x) &#123;<br>    <span class="hljs-keyword">if</span> (x <span class="hljs-keyword">instanceof</span> Comparable) &#123;<br>        Class&lt;?&gt; c; Type[] ts, as; Type t; ParameterizedType p;<br>        <span class="hljs-keyword">if</span> ((c = x.getClass()) == String.class) <span class="hljs-comment">// bypass checks</span><br>            <span class="hljs-keyword">return</span> c;<br>        <span class="hljs-keyword">if</span> ((ts = c.getGenericInterfaces()) != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; ts.length; ++i) &#123;<br>                <span class="hljs-keyword">if</span> (((t = ts[i]) <span class="hljs-keyword">instanceof</span> ParameterizedType) &amp;&amp;<br>                    ((p = (ParameterizedType)t).getRawType() ==<br>                     Comparable.class) &amp;&amp;<br>                    (as = p.getActualTypeArguments()) != <span class="hljs-keyword">null</span> &amp;&amp;<br>                    as.length == <span class="hljs-number">1</span> &amp;&amp; as[<span class="hljs-number">0</span>] == c) <span class="hljs-comment">// type arg is c</span><br>                    <span class="hljs-keyword">return</span> c;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Returns k.compareTo(x) if x matches kc (k&#x27;s screened comparable</span><br><span class="hljs-comment"> * class), else 0.</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@SuppressWarnings(&#123;&quot;rawtypes&quot;,&quot;unchecked&quot;&#125;)</span> <span class="hljs-comment">// for cast to Comparable</span><br><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">compareComparables</span><span class="hljs-params">(Class&lt;?&gt; kc, Object k, Object x)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> (x == <span class="hljs-keyword">null</span> || x.getClass() != kc ? <span class="hljs-number">0</span> :<br>            ((Comparable)k).compareTo(x));<br>&#125;<br></code></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="4-å®ç°æ–¹æ³•"><a href="#4-å®ç°æ–¹æ³•" class="headerlink" title="4. å®ç°æ–¹æ³•"></a>4. å®ç°æ–¹æ³•</h2><h3 id="ï¼ˆ1ï¼‰Get-è·å–"><a href="#ï¼ˆ1ï¼‰Get-è·å–" class="headerlink" title="ï¼ˆ1ï¼‰Get() - è·å–"></a>ï¼ˆ1ï¼‰Get() - è·å–</h3><pre class="mermaid">%%{
    init: {
    'themeVariables': {
        'fontSize': '13px'
    }
}   
}%%
graph TD
T(["<b>å¦‚ä½•ä»HashMap<br>è·å–å…ƒç´ ï¼Ÿ</b>"]):::p
T --> B("å…ˆæ ¹æ®keyæ‰¾åˆ°æ¡¶ä½")
B --> A(["åˆ¤æ–­å½“å‰ä½ç½®çš„å…ƒç´ <br>æ˜¯å¦å°±è¦æ‰¾çš„å€¼"]):::lp
A --> |"<b>æ˜¯</b>"| C2["æ ¸å¯¹k-vå€¼åè¿”å›"]:::b
A --> |"<b>å¦</b><br><i>ï¼ˆæœ‰hashå†²çªï¼‰</i>"| C(["åˆ¤æ–­ä¸ºé“¾è¡¨æˆ–çº¢é»‘æ ‘"]):::lp
C -.-> |"<b>é“¾è¡¨</b>"|a["éå†é“¾è¡¨ã€<br>æ ¸å¯¹k-vå€¼åè¿”å›"]:::b
C -.-> |"<b>çº¢é»‘æ ‘</b>"|b["ä»æ ‘çš„æ ¹èŠ‚ç‚¹æŸ¥æ‰¾ã€<br>æ ¸å¯¹k-vå€¼åè¿”å›"]:::b

classDef p fill:#ddaebd
classDef b fill:#d9dfeb
classDef lp fill: #f4e4e9</pre>

<h4 id="get"><a href="#get" class="headerlink" title="- get()"></a>- <em>get()</em></h4><ul>
<li>é€šè¿‡keyè·å–value<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Returns the value to which the specified key is mapped,</span><br><span class="hljs-comment"> * or null if this map contains no mapping for the key.</span><br><span class="hljs-comment"> * è¿”å›æŒ‡å®škeyæ‰€æ˜ å°„çš„valueå€¼ã€‚è‹¥æ‰¾ä¸åˆ°å¯¹åº”valueæ—¶è¿”å›nullã€‚</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * ä½†è¿”å›nullä¸ä¸€å®šä»£è¡¨ä¸å­˜åœ¨è¯¥keyæ˜ å°„çš„å€¼ï¼Œæœ‰å¯èƒ½æ˜¯è¯¥keyä¿å­˜çš„valueå€¼æ­£æ˜¯&quot;null&quot;ã€‚</span><br><span class="hljs-comment"> * å¯ä»¥ä½¿ç”¨containsKey()æ¥è¯†åˆ«ã€‚</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> V <span class="hljs-title">get</span><span class="hljs-params">(Object key)</span> </span>&#123;<br>    <span class="hljs-comment">// Node</span><br>    Node&lt;K,V&gt; e;<br>    <span class="hljs-comment">// ğŸ”» ä½¿ç”¨keyå’Œå…¶hashå€¼è°ƒç”¨getNode()æ–¹æ³•ï¼Œè¿”å›Nodeçš„valueå€¼ã€‚</span><br>    <span class="hljs-keyword">return</span> (e = getNode(hash(key), key)) == <span class="hljs-keyword">null</span> ? <span class="hljs-keyword">null</span> : e.value;<br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><code>null ? null : e.value</code>ï¼šè‹¥è¯¥å€¼ä¸ºnullï¼Œè¿”å›nullï¼›è‹¥è¯¥å€¼ä¸ä¸ºnullï¼Œè¿”å›e.value</li>
</ul>
<h4 id="getNode"><a href="#getNode" class="headerlink" title="- getNode()"></a>- <em>getNode()</em></h4><ul>
<li>è·å–Node<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Implements Map.get and related methods.</span><br><span class="hljs-comment"> * å®ç°äº†Map.get()å’Œç›¸å…³æ–¹æ³•</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> hash keyçš„hashå€¼</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> key key</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> è¿”å›è¯¥keyå¯¹åº”çš„Nodeï¼Œè‹¥æ— è¿”å›null</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">final</span> Node&lt;K,V&gt; <span class="hljs-title">getNode</span><span class="hljs-params">(<span class="hljs-keyword">int</span> hash, Object key)</span> </span>&#123;<br>    Node&lt;K,V&gt;[] tab; <span class="hljs-comment">// Nodeæ•°ç»„</span><br>    Node&lt;K,V&gt; first, e; <span class="hljs-comment">// Node</span><br>    <span class="hljs-keyword">int</span> n; <span class="hljs-comment">// æ•°ç»„é•¿åº¦</span><br>    K k; <span class="hljs-comment">// key</span><br>    <span class="hljs-comment">// ğŸ”» åˆ¤æ–­è¯¥æ•°ç»„éç©º</span><br>    <span class="hljs-comment">//   å¹¶æ ¹æ®ä¼ å…¥keyçš„hashå€¼è®¡ç®—å‡ºè¯¥hashå€¼å¯¹åº”çš„Nodeçš„ä¸‹æ ‡ï¼Œå°†è¯¥æ•°ç»„ä¸‹æ ‡å¯¹åº”çš„å€¼èµ‹å€¼ç»™first-Nodeï¼ˆæ„ä¸ºhashå†²çªæ—¶ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼‰</span><br>    <span class="hljs-keyword">if</span> ((tab = table) != <span class="hljs-keyword">null</span> &amp;&amp; (n = tab.length) &gt; <span class="hljs-number">0</span> &amp;&amp;<br>        (first = tab[(n - <span class="hljs-number">1</span>) &amp; hash]) != <span class="hljs-keyword">null</span>) &#123;<br>        <span class="hljs-comment">// ğŸ”¹ å…ˆåˆ¤æ–­è‹¥firståˆšå¥½æ˜¯æˆ‘ä»¬è¦æ‰¾çš„Nodeæ—¶ï¼šç›´æ¥è¿”å›first</span><br>        <span class="hljs-keyword">if</span> (first.hash == hash &amp;&amp; <span class="hljs-comment">// always check first node</span><br>            ((k = first.key) == key || (key != <span class="hljs-keyword">null</span> &amp;&amp; key.equals(k))))<br>            <span class="hljs-keyword">return</span> first;<br>        <span class="hljs-comment">// ğŸ”¹ å½“firstå°¾éƒ¨è¿˜æœ‰å…ƒç´ ï¼ˆå³æœ‰hashå†²çªï¼‰æ—¶ï¼Œæ ¹æ®Nodeçš„ç»“æ„å–å€¼ã€‚</span><br>        <span class="hljs-keyword">if</span> ((e = first.next) != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-comment">// ğŸ”¸ çº¢é»‘æ ‘ï¼šå°†Nodeè½¬ä¸ºTreeNodeç±»å‹ï¼Œå¹¶è°ƒç”¨getTreeNode()å–å€¼ã€‚</span><br>            <span class="hljs-keyword">if</span> (first <span class="hljs-keyword">instanceof</span> TreeNode)<br>                <span class="hljs-keyword">return</span> ((TreeNode&lt;K,V&gt;)first).getTreeNode(hash, key);<br>            <span class="hljs-comment">// ğŸ”¸ é“¾è¡¨ï¼šéå†å–å€¼ã€‚</span><br>            <span class="hljs-keyword">do</span> &#123;<br>                <span class="hljs-keyword">if</span> (e.hash == hash &amp;&amp; <span class="hljs-comment">// åˆ¤æ–­hashå€¼å’Œkeyå€¼éƒ½ç›¸åŒ</span><br>                    ((k = e.key) == key || (key != <span class="hljs-keyword">null</span> &amp;&amp; key.equals(k))))<br>                    <span class="hljs-keyword">return</span> e;<br>            &#125; <span class="hljs-keyword">while</span> ((e = e.next) != <span class="hljs-keyword">null</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">// ğŸ”» æ•°ç»„ä¸ºç©ºï¼Œè¿”å›null</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>&#125;<br></code></pre></td></tr></table></figure>


</li>
</ul>
<h3 id="ï¼ˆ2ï¼‰Remove-åˆ é™¤"><a href="#ï¼ˆ2ï¼‰Remove-åˆ é™¤" class="headerlink" title="ï¼ˆ2ï¼‰Remove() - åˆ é™¤"></a>ï¼ˆ2ï¼‰Remove() - åˆ é™¤</h3><pre class="mermaid">%%{
    init: {
    'themeVariables': {
        'fontSize': '13px'
    }
}   
}%%
graph TD
T(["<b>å¦‚ä½•ä»HashMap<br>åˆ é™¤å…ƒç´ ï¼Ÿ</b>"]):::p
T --> B("å…ˆæ ¹æ®keyæ‰¾åˆ°æ¡¶ä½")
B --> A(["åˆ¤æ–­å½“å‰ä½ç½®çš„å…ƒç´ <br>æ˜¯å¦å°±è¦åˆ é™¤çš„å€¼"]):::lp
A --> |"<b>æ˜¯</b>"| C2["ç›´æ¥åˆ é™¤è¯¥å…ƒç´ "]:::b
A --> |"<b>å¦</b><br><i>ï¼ˆæœ‰hashå†²çªï¼‰</i>"| C(["åˆ¤æ–­ä¸ºé“¾è¡¨æˆ–çº¢é»‘æ ‘"]):::lp
C --> |"<b>é“¾è¡¨</b>"|a["å°†ä¸Šä¸ªä½ç½®çš„æŒ‡é’ˆ<br>ï¼ˆè·³è¿‡è¯¥å€¼ï¼‰æŒ‡å‘ä¸‹ä¸ªä½ç½®"]:::b
C --> |"<b>çº¢é»‘æ ‘</b>"|b["å»æ‰å½“å‰èŠ‚ç‚¹åè‡ªå¹³è¡¡"]:::b
b -.- bt["<i>ï¼ˆæ ‘é•¿åº¦å°äº6æ—¶è½¬ä¸ºé“¾è¡¨ï¼‰</i>"]:::info

classDef info fill:#f6f6f7,color:#737379stroke-width: 3px, stroke-dasharray: 3 3
classDef p fill:#ddaebd
classDef b fill:#d9dfeb
classDef lp fill: #f4e4e9</pre>

<h4 id="remove"><a href="#remove" class="headerlink" title="- remove()"></a>- <em>remove()</em></h4><ul>
<li>åˆ é™¤å…ƒç´   <figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Removes the mapping for the specified key from this map if present.</span><br><span class="hljs-comment"> * æ ¹æ®æŒ‡å®škeyåˆ é™¤æ˜ å°„ã€‚</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span>  key è¦ä»mapä¸­åˆ é™¤æ˜ å°„çš„é”®</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> è¿”å›ä¸é”®å…³è”çš„å‰å€¼ï¼Œè‹¥å‰å€¼ä¸ºç©ºè¿”å›null</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> V <span class="hljs-title">remove</span><span class="hljs-params">(Object key)</span> </span>&#123;<br>    Node&lt;K,V&gt; e;<br>    <span class="hljs-comment">// ğŸ”» è°ƒç”¨removeNode()åˆ é™¤è¯¥é”®æ˜ å°„ï¼Œè‹¥å‰å€¼ä¸ºç©ºè¿”å›nullï¼Œè‹¥å‰å€¼éç©ºè¿”å›å‰å€¼ã€‚</span><br>    <span class="hljs-keyword">return</span> (e = removeNode(hash(key), key, <span class="hljs-keyword">null</span>, <span class="hljs-keyword">false</span>, <span class="hljs-keyword">true</span>)) == <span class="hljs-keyword">null</span> ?<br>        <span class="hljs-keyword">null</span> : e.value;<br>&#125;<br></code></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="removeNode"><a href="#removeNode" class="headerlink" title="- removeNode()"></a>- <em>removeNode()</em></h4><ul>
<li>åˆ é™¤Node  <figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Implements Map.remove and related methods.</span><br><span class="hljs-comment"> * å®ç°åˆ é™¤å’Œç›¸å…³æ–¹æ³•ã€‚</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> hash       keyçš„hashå€¼</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> key        key</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> value      è‹¥æœ‰å€¼æ—¶åŒ¹é…è¯¥å€¼</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> matchValue è‹¥ä¸ºçœŸï¼šä»…å€¼ç›¸ç­‰æ—¶åˆ é™¤</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> movable    ä¸ºfalse:åˆ é™¤æ—¶ä¸ç§»åŠ¨å…¶ä»–å€¼</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> è¿”å›Nodeï¼Œè‹¥æ— è¯¥Nodeè¿”å›null</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">final</span> Node&lt;K,V&gt; <span class="hljs-title">removeNode</span><span class="hljs-params">(<span class="hljs-keyword">int</span> hash, Object key, Object value,</span></span><br><span class="hljs-params"><span class="hljs-function">                           <span class="hljs-keyword">boolean</span> matchValue, <span class="hljs-keyword">boolean</span> movable)</span> </span>&#123;<br>    Node&lt;K,V&gt;[] tab; <span class="hljs-comment">// Nodeæ•°ç»„ï¼ˆå¼•ç”¨å½“å‰hashMapçš„æ•£åˆ—è¡¨ï¼‰</span><br>    Node&lt;K,V&gt; p;     <span class="hljs-comment">// å½“å‰Nodeå…ƒç´ ï¼šp</span><br>    <span class="hljs-keyword">int</span> n, index;    <span class="hljs-comment">// nï¼šæ•°ç»„é•¿åº¦ï¼Œindexï¼šæ•°ç»„ä¸‹æ ‡</span><br>    <span class="hljs-comment">// æ•°ç»„éç©ºã€å½“å‰ç´¢å¼•ä½ç½®çš„Nodeå…ƒç´ péç©º</span><br>    <span class="hljs-keyword">if</span> ((tab = table) != <span class="hljs-keyword">null</span> &amp;&amp; (n = tab.length) &gt; <span class="hljs-number">0</span> &amp;&amp;<br>        (p = tab[index = (n - <span class="hljs-number">1</span>) &amp; hash]) != <span class="hljs-keyword">null</span>) &#123;<br>        Node&lt;K,V&gt; node = <span class="hljs-keyword">null</span>, e; <span class="hljs-comment">// è¦åˆ é™¤çš„Nodeå…ƒç´ ï¼šnodeï¼›å½“å‰èŠ‚ç‚¹çš„ä¸‹ä¸ªèŠ‚ç‚¹ï¼še(=p.next)</span><br>        K k; V v; <span class="hljs-comment">// å½“å‰å…ƒç´ pçš„keyå’Œvalueå€¼</span><br>        <span class="hljs-comment">// ğŸ”¹ ç¬¬ä¸€ä¸ªä½ç½®åˆšå¥½æ˜¯è¦åˆ é™¤çš„å…ƒç´ ï¼šèµ‹å€¼ç»™nodeï¼Œæ‰§è¡Œä¸‹æ–¹ä¿®æ”¹æŒ‡é’ˆçš„ä»£ç </span><br>        <span class="hljs-keyword">if</span> (p.hash == hash &amp;&amp;<br>            ((k = p.key) == key || (key != <span class="hljs-keyword">null</span> &amp;&amp; key.equals(k))))<br>            node = p;<br>        <span class="hljs-comment">// ğŸ”¹ å­˜åœ¨å“ˆå¸Œå†²çªæ—¶ï¼šæ ¹æ®é“¾è¡¨æˆ–çº¢é»‘æ ‘ç»“æ„è·å–è¦åˆ é™¤çš„å…ƒç´ node</span><br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((e = p.next) != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-comment">// ğŸ”¸ çº¢é»‘æ ‘ï¼šä½¿ç”¨getTreeNode()è·å–å…ƒç´ ï¼Œèµ‹å€¼ç»™nodeã€‚</span><br>            <span class="hljs-keyword">if</span> (p <span class="hljs-keyword">instanceof</span> TreeNode)<br>                node = ((TreeNode&lt;K,V&gt;)p).getTreeNode(hash, key);<br>            <span class="hljs-comment">// ğŸ”¸ é“¾è¡¨ï¼šç”¨hashå€¼å’Œé”®å€¼å¯¹éå†ï¼šèµ‹å€¼ç»™nodeã€‚</span><br>            <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">do</span> &#123;<br>                    <span class="hljs-keyword">if</span> (e.hash == hash &amp;&amp;<br>                        ((k = e.key) == key ||<br>                         (key != <span class="hljs-keyword">null</span> &amp;&amp; key.equals(k)))) &#123;<br>                        node = e;<br>                        <span class="hljs-keyword">break</span>;<br>                    &#125;<br>                    p = e;<br>                &#125; <span class="hljs-keyword">while</span> ((e = e.next) != <span class="hljs-keyword">null</span>);<br>            &#125;<br>        &#125;<br>        <span class="hljs-comment">// ğŸ”´ æ ¹æ®å…ƒç´ (node)çš„ç»“æ„åˆ é™¤</span><br>        <span class="hljs-keyword">if</span> (node != <span class="hljs-keyword">null</span> &amp;&amp; (!matchValue || (v = node.value) == value ||<br>                             (value != <span class="hljs-keyword">null</span> &amp;&amp; value.equals(v)))) &#123;<br>            <span class="hljs-comment">// ğŸ”¹ è‹¥è¦åˆ é™¤æ ‘ç»“æ„èŠ‚ç‚¹ï¼šä½¿ç”¨removeTreeNode()ç§»é™¤æ ‘èŠ‚ç‚¹</span><br>            <span class="hljs-keyword">if</span> (node <span class="hljs-keyword">instanceof</span> TreeNode)<br>                ((TreeNode&lt;K,V&gt;)node).removeTreeNode(<span class="hljs-keyword">this</span>, tab, movable);<br>            <span class="hljs-comment">// ğŸ”¹ è‹¥è¦åˆ é™¤NodeèŠ‚ç‚¹ä¸Šçš„å…ƒç´ ï¼ˆåˆšå¥½æ˜¯ç¬¬ä¸€ä¸ªå…ƒç´ ï¼‰ï¼šå°†è¯¥èŠ‚ç‚¹èµ‹å€¼ä¸ºä¸‹ä¸ªå…ƒç´ </span><br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (node == p)<br>                tab[index] = node.next;<br>            <span class="hljs-comment">// ğŸ”¹ è‹¥è¦åˆ é™¤é“¾è¡¨èŠ‚ç‚¹ï¼šæŒ‡å‘å…¶ä¸‹ä¸ªå…ƒç´ çš„nextï¼Œå°†é“¾è¡¨é“¾æ¥èµ·æ¥ã€‚</span><br>            <span class="hljs-keyword">else</span><br>                p.next = node.next;<br>            ++modCount; <span class="hljs-comment">// è®°å½•ä¿®æ”¹æ¬¡æ•°ï¼ˆå¯ä»¥åˆ¤æ–­æ˜¯å¦ä¿®æ”¹æˆåŠŸï¼‰</span><br>            --size; <span class="hljs-comment">// æ•°ç»„é•¿åº¦è‡ªå‡</span><br>            afterNodeRemoval(node);<br>            <span class="hljs-keyword">return</span> node;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>&#125;<br></code></pre></td></tr></table></figure>


</li>
</ul>
<h3 id="ï¼ˆ3ï¼‰Put-æ·»åŠ "><a href="#ï¼ˆ3ï¼‰Put-æ·»åŠ " class="headerlink" title="ï¼ˆ3ï¼‰Put() - æ·»åŠ "></a>ï¼ˆ3ï¼‰Put() - æ·»åŠ </h3><pre class="mermaid">%%{
    init: {
    'themeVariables': {
        'fontSize': '13px'
    }
}   
}%%
graph TD
T(["<b>å¦‚ä½•å‘HashMap<br>æ·»åŠ å…ƒç´ ï¼Ÿ</b>"]):::p
T --> B("å…ˆæ ¹æ®keyæ‰¾åˆ°æ¡¶ä½")
B --> A(["åˆ¤æ–­å½“å‰ç´¢å¼•æ˜¯å¦<br>å°±æ˜¯è¦æ·»åŠ å…ƒç´ çš„ä½ç½®"]):::lp
A --> |"<b>æ— å…ƒç´ </b>"| C2["ç›´æ¥å°†å…ƒç´ æ·»åŠ åˆ°è¯¥ä½ç½®"]:::b
A --> |"<b>æœ‰å…ƒç´ </b><br><i>ï¼ˆæœ‰hashå†²çªï¼‰</i>"| C(["åˆ¤æ–­ä¸ºé“¾è¡¨æˆ–çº¢é»‘æ ‘"]):::lp
C --> |"<b>é“¾è¡¨</b>"|a["å°†å…ƒç´ æ·»åŠ åˆ°é“¾è¡¨å°¾éƒ¨"]:::b
C --> |"<b>çº¢é»‘æ ‘</b>"|b["å°†å…ƒç´ æ·»åŠ åˆ°æ ‘å°¾éƒ¨"]:::b
a -.- at["<i>é“¾è¡¨é•¿åº¦è¶…è¿‡8ã€ä¸”æ¡¶æ•°é‡å¤§äº64æ—¶è½¬ä¸ºæ ‘<br>ï¼ˆ*æ¡¶æ•°å°äº64æ—¶ä¸ä¼šæ ‘åŒ–ï¼Œåªä¼šæ‰©å®¹ï¼‰</i>"]:::info

classDef info fill:#f6f6f7,color:#737379stroke-width: 3px, stroke-dasharray: 3 3

classDef p fill:#ddaebd
classDef b fill:#d9dfeb
classDef lp fill: #f4e4e9</pre>
<h4 id="put"><a href="#put" class="headerlink" title="+ put()"></a>+ <em>put()</em></h4><ul>
<li>æ·»åŠ å…ƒç´ <figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Associates the specified value with the specified key in this map. If the map previously contained a mapping for the key, the old value is replaced.</span><br><span class="hljs-comment"> * å­˜å€¼ï¼šå°†æŒ‡å®šå€¼ä¸æ­¤æ˜ å°„ä¸­çš„æŒ‡å®šé”®ç›¸å…³è”ã€‚å¦‚æœæ˜ å°„å…ˆå‰åŒ…å«é”®çš„æ˜ å°„ï¼Œåˆ™å°†æ›¿æ¢æ—§å€¼ã€‚</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> key </span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> value </span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> è¿”å›è¢«æ›¿æ¢çš„åŸå€¼</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> V <span class="hljs-title">put</span><span class="hljs-params">(K key, V value)</span> </span>&#123;<br>    <span class="hljs-comment">// è°ƒç”¨putVal()æ–¹æ³•å­˜å€¼</span><br>    <span class="hljs-keyword">return</span> putVal(hash(key), key, value, <span class="hljs-keyword">false</span>, <span class="hljs-keyword">true</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="putVal"><a href="#putVal" class="headerlink" title="- putVal()"></a>- <em>putVal()</em></h4><ul>
<li>èµ‹å€¼æ–¹æ³•ï¼ˆè‹¥keyå·²æœ‰å€¼æ—¶é»˜è®¤æ›¿æ¢ï¼‰<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment">    * Implements Map.put and related methods.</span><br><span class="hljs-comment">    * å®ç°äº†Mapèµ‹å€¼ä»¥åŠç›¸å…³æ–¹æ³•ã€‚</span><br><span class="hljs-comment">    *</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@param</span> hash         keyçš„hashå€¼</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@param</span> key          keyå€¼</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@param</span> value        éœ€è¦èµ‹çš„å€¼</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@param</span> onlyIfAbsent æ˜¯å¦ä¿ç•™åŸå€¼ï¼ˆé»˜è®¤ä¸ºfalseï¼šä¼šæ›¿æ¢åŸå€¼ï¼‰</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@param</span> evict        false:è¡¨å¤„äºåˆ›å»ºçŠ¶æ€</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@return</span> è¿”å›å‰å€¼ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä¸ºç©º</span><br><span class="hljs-comment">    */</span><br><span class="hljs-function"><span class="hljs-keyword">final</span> V <span class="hljs-title">putVal</span><span class="hljs-params">(<span class="hljs-keyword">int</span> hash, K key, V value, <span class="hljs-keyword">boolean</span> onlyIfAbsent,</span></span><br><span class="hljs-params"><span class="hljs-function">                <span class="hljs-keyword">boolean</span> evict)</span> </span>&#123;<br>    Node&lt;K,V&gt;[] tab; <span class="hljs-comment">// Nodeæ•°ç»„</span><br>    Node&lt;K,V&gt; p; <span class="hljs-comment">// Node</span><br>    <span class="hljs-keyword">int</span> n, i; <span class="hljs-comment">// nï¼šæ•°ç»„é•¿åº¦ï¼Œ iï¼šæ•°ç»„ç´¢å¼•</span><br>    <span class="hljs-comment">// ğŸ”´ ä¸€ã€è‹¥ç©ºæ•°ç»„ï¼šåˆå§‹åŒ–</span><br>    <span class="hljs-comment">//       å½“æ•°ç»„ä¸ºç©ºã€é•¿åº¦ä¸º0æ—¶ï¼šæ‰©å®¹ï¼Œå¹¶è·å¾—Nodeæ•°ç»„é•¿åº¦nï¼ˆå®¹é‡ï¼‰</span><br>    <span class="hljs-keyword">if</span> ((tab = table) == <span class="hljs-keyword">null</span> || (n = tab.length) == <span class="hljs-number">0</span>)<br>        n = (tab = resize()).length;<br>    <span class="hljs-comment">// ğŸ”´ äºŒã€è‹¥ç©ºç´¢å¼•ï¼šç›´æ¥å­˜</span><br>    <span class="hljs-comment">//       è‹¥ä¼ å…¥çš„keyè®¡ç®—å‡ºçš„ç´¢å¼•ä½ç½®æ— å…ƒç´ ï¼Œåˆ™ä½¿ç”¨é”®å€¼å¯¹åœ¨è¯¥ä½ç½®ä¸Šåˆ›å»ºNodeï¼ŒputVal()å®Œæˆã€‚</span><br>    <span class="hljs-keyword">if</span> ((p = tab[i = (n - <span class="hljs-number">1</span>) &amp; hash]) == <span class="hljs-keyword">null</span>)<br>        tab[i] = newNode(hash, key, value, <span class="hljs-keyword">null</span>);<br>    <span class="hljs-comment">// ğŸ”´ ä¸‰ã€è‹¥ç´¢å¼•éç©ºï¼šæ ¹æ®æƒ…å†µå­˜å€¼</span><br>    <span class="hljs-comment">//       å¯èƒ½æœ‰hashå†²çªï¼Œåˆ¤æ–­è¯¥Nodeæ˜¯å¦ä¸ºé“¾è¡¨æˆ–çº¢é»‘æ ‘è¿›è¡Œå­˜å€¼ã€‚</span><br>    <span class="hljs-keyword">else</span> &#123;<br>        Node&lt;K,V&gt; e; <span class="hljs-comment">// node</span><br>        K k; <span class="hljs-comment">// key</span><br>        <span class="hljs-comment">// ğŸ”¹ è‹¥påˆšå¥½åœ¨å½“å‰ç´¢å¼•ä½ç½®çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ä¸Šï¼ˆæœªæ¶‰åŠåˆ°é“¾è¡¨æˆ–çº¢é»‘æ ‘ï¼‰ï¼Œå°†è¯¥Nodeèµ‹å€¼ç»™eä»¥å¤‡å­˜å€¼ï¼ˆå½“å‰Nodeçš„keyå€¼å’Œä¼ å…¥çš„keyå€¼ç›¸ç­‰ï¼‰</span><br>        <span class="hljs-keyword">if</span> (p.hash == hash &amp;&amp;<br>            ((k = p.key) == key || (key != <span class="hljs-keyword">null</span> &amp;&amp; key.equals(k))))<br>            e = p;<br>        <span class="hljs-comment">// ğŸ”¹ TreeNodeç±»å‹ï¼šé€šè¿‡putTreeVal()æ–¹æ³•åœ¨çº¢é»‘æ ‘ä¸Šæ’å…¥é”®å€¼å¯¹ï¼Œèµ‹å€¼ç»™eä»¥å¤‡å­˜å€¼ã€‚</span><br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (p <span class="hljs-keyword">instanceof</span> TreeNode)<br>            e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(<span class="hljs-keyword">this</span>, tab, hash, key, value);<br>        <span class="hljs-comment">// ğŸ”¹ é“¾è¡¨ç±»å‹ï¼šå¾ªç¯ç›´åˆ°å°†å…ƒç´ æ’å…¥é“¾è¡¨å°¾éƒ¨ï¼Œèµ‹å€¼ç»™eä»¥å¤‡å­˜å€¼ã€‚</span><br>        <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> binCount = <span class="hljs-number">0</span>; ; ++binCount) &#123; <span class="hljs-comment">// binCountï¼šé“¾è¡¨èŠ‚ç‚¹ä¸ªæ•°</span><br>                <span class="hljs-comment">// ğŸ”¸ è‹¥å·²éå†åˆ°é“¾è¡¨å°¾éƒ¨ï¼šä½¿ç”¨newNode()åœ¨å°¾éƒ¨å†æ·»åŠ ä¸€ä¸ªæ–°èŠ‚ç‚¹å¹¶å­˜å€¼ã€‚</span><br>                <span class="hljs-keyword">if</span> ((e = p.next) == <span class="hljs-keyword">null</span>) &#123;<br>                    p.next = newNode(hash, key, value, <span class="hljs-keyword">null</span>);<br>                    <span class="hljs-comment">// * è‹¥æ·»åŠ èŠ‚ç‚¹åé“¾è¡¨çš„é•¿åº¦è¶…è¿‡æ ‘åŒ–é˜ˆå€¼ï¼š</span><br>                    <span class="hljs-comment">//   é€šè¿‡treeifyBin()å°†é“¾è¡¨è½¬åŒ–ä¸ºçº¢é»‘æ ‘ï¼Œè·³å‡ºå¾ªç¯ï¼ŒputVal()å®Œæˆã€‚</span><br>                    <span class="hljs-keyword">if</span> (binCount &gt;= TREEIFY_THRESHOLD - <span class="hljs-number">1</span>) <span class="hljs-comment">// -1 for 1st</span><br>                        treeifyBin(tab, hash);<br>                    <span class="hljs-keyword">break</span>;<br>                &#125;<br>                <span class="hljs-comment">// ğŸ”¸ è‹¥è¿˜æœªéå†åˆ°å°¾éƒ¨ã€ä¸”è¯¥èŠ‚ç‚¹çš„keyå€¼ä¸ä¼ å…¥keyå€¼ç›¸ç­‰ï¼š</span><br>                <span class="hljs-comment">//    åˆ™è·³å‡ºå¾ªç¯ï¼Œæ‰§è¡Œä¸‹æ–¹æ›¿æ¢åŸå€¼çš„åˆ¤æ–­ã€‚</span><br>                <span class="hljs-keyword">if</span> (e.hash == hash &amp;&amp;<br>                    ((k = e.key) == key || (key != <span class="hljs-keyword">null</span> &amp;&amp; key.equals(k))))<br>                    <span class="hljs-keyword">break</span>;<br>                <span class="hljs-comment">// ğŸ”¸ ç»§ç»­å¾ªç¯éå†é“¾è¡¨</span><br>                p = e;<br>            &#125;<br>        &#125;<br>        <span class="hljs-comment">// ğŸ”» æ›¿æ¢å¹¶è¾“å‡ºåŸå€¼ï¼ˆkeyå·²æœ‰å€¼æ—¶ï¼‰</span><br>        <span class="hljs-keyword">if</span> (e != <span class="hljs-keyword">null</span>) &#123; <span class="hljs-comment">// existing mapping for key</span><br>            V oldValue = e.value;<br>            <span class="hljs-comment">// è‹¥è®¾ç½®äº†æ›¿æ¢åŸå€¼ã€æˆ–åŸå€¼ä¸ºç©ºæ—¶ï¼šå­˜å€¼</span><br>            <span class="hljs-keyword">if</span> (!onlyIfAbsent || oldValue == <span class="hljs-keyword">null</span>)<br>                e.value = value;<br>            afterNodeAccess(e); <span class="hljs-comment">// è®¿é—®åå›è°ƒï¼ˆâ“</span><br>            <span class="hljs-keyword">return</span> oldValue;<br>        &#125;<br>    &#125;<br>    ++modCount; <span class="hljs-comment">// è®°å½•ä¿®æ”¹æ¬¡æ•°ï¼ˆæ–¹ä¾¿åœ¨è¿­ä»£ä¸­æ£€æµ‹ç»“æ„æ€§å˜åŒ–ï¼‰</span><br>    <span class="hljs-comment">// ğŸ”» è‹¥å­˜å€¼åå…ƒç´ æ•°é‡å¤§äºæ‰©å®¹é˜ˆå€¼ï¼Œåˆ™æ‰©å®¹ã€‚</span><br>    <span class="hljs-keyword">if</span> (++size &gt; threshold) <br>        resize();<br>    afterNodeInsertion(evict); <span class="hljs-comment">// æ’å…¥åå›è°ƒï¼ˆâ“</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><strong>æ¯”è¾ƒæ—¶å…ˆæ¯”è¾ƒhashå€¼ï¼Œhashç›¸åŒçš„æ—¶å€™ï¼Œå†ä½¿ç”¨equalsæ–¹æ³•è¿›è¡Œæ¯”è¾ƒ</strong>ï¼š<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">if</span>(e.hash == hash &amp;&amp; ((k = e.key) == key || key.equals(k)))<br></code></pre></td></tr></table></figure>
å› ä¸ºhashæ˜¯æ•´æ•°ï¼Œæ¯”è¾ƒçš„æ€§èƒ½ä¸€èˆ¬è¦æ¯”<code>equals()</code>é«˜å¾ˆå¤šï¼Œä½¿ç”¨çŸ­è·¯ä¸ï¼šhashä¸åŒï¼Œå°±æ²¡æœ‰å¿…è¦è°ƒç”¨equalsæ–¹æ³•äº†ï¼Œè¿™æ ·æ•´ä½“ä¸Šå¯ä»¥æé«˜æ¯”è¾ƒæ€§èƒ½ã€‚</li>
</ul>
<h4 id="putIfAbsent"><a href="#putIfAbsent" class="headerlink" title="+ putIfAbsent()"></a>+ <em>putIfAbsent()</em></h4><ul>
<li>èµ‹å€¼ï¼Œä¸”å·²æœ‰å€¼æ—¶ä¸è¿›è¡Œè¦†ç›–<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> V <span class="hljs-title">putIfAbsent</span><span class="hljs-params">(K key, V value)</span> </span>&#123;<br>    <span class="hljs-comment">// ğŸ”» ä¸é»˜è®¤çš„put()åŒºåˆ«åœ¨äºç¬¬å››ä¸ªå‚æ•°ï¼šonlyIfAbsentï¼ˆä¸ºtrueæ—¶ä¸è¦†ç›–åŸå€¼ï¼‰</span><br>    <span class="hljs-keyword">return</span> putVal(hash(key), key, value, <span class="hljs-keyword">true</span>, <span class="hljs-keyword">true</span>);<br>&#125;<br></code></pre></td></tr></table></figure>


</li>
</ul>
<h3 id="ï¼ˆ4ï¼‰-Resize-æ‰©å®¹"><a href="#ï¼ˆ4ï¼‰-Resize-æ‰©å®¹" class="headerlink" title="ï¼ˆ4ï¼‰*Resize() - æ‰©å®¹"></a>ï¼ˆ4ï¼‰*Resize() - æ‰©å®¹</h3><h4 id="â‘ -ä½•æ—¶æ‰©å®¹"><a href="#â‘ -ä½•æ—¶æ‰©å®¹" class="headerlink" title="â‘  ä½•æ—¶æ‰©å®¹"></a>â‘  ä½•æ—¶æ‰©å®¹</h4><pre class="mermaid">%%{
    init: {
        'themeVariables': {
            'fontSize': '14px'
        }
    }
}%%
graph TD
T(["<b>HashMapä½•æ—¶éœ€è¦æ‰©å®¹ï¼Ÿ</b>"]):::p
T --> |"<b>1. åˆå§‹åŒ–</b>"| A("1. tableä¸ºnull æˆ–é•¿åº¦ä¸º0æ—¶"):::lp
T --> |"<b>2. å­˜å€¼</b>"| B("2. æ·»åŠ å…ƒç´ ä¸”å…ƒç´ æ•°é‡å³å°†è¶…è¿‡<br>æ‰©å®¹é˜ˆå€¼ï¼ˆthresholdï¼‰æ—¶"):::lp
B -.- |"<i>hreshold å¯ä»¥ç”± tableSizeFor() è®¡ç®—å¾—åˆ°</i>"| b["tableSizeFor()ï¼šå¯ä»¥è®¡ç®—å‡ºå¤§äºå½“å‰æ–¹æ³•å…¥å‚å€¼ï¼Œ<br>å¹¶ä¸”å’Œå½“å‰æ–¹æ³•å…¥å‚å€¼æœ€æ¥è¿‘çš„2çš„å¹‚æ•°ã€‚"]:::info
classDef p fill: #ddaebd
classDef lp fill: #f4e4e9
classDef lb fill: #d9dfeb
classDef info fill:#f6f6f7,color:#737379, stroke-width: 2px, stroke-dasharray: 3 3</pre>

<h4 id="â‘¡-å¦‚ä½•æ‰©å®¹"><a href="#â‘¡-å¦‚ä½•æ‰©å®¹" class="headerlink" title="â‘¡ å¦‚ä½•æ‰©å®¹"></a>â‘¡ å¦‚ä½•æ‰©å®¹</h4><ul>
<li><pre class="mermaid">%%{
  init: {
      'themeVariables': {
          'fontSize': '14px'
      }
  }
}%%
graph TD
T(["<b>HashMapå¦‚ä½•æ‰©å®¹ï¼Ÿ</b>"]):::p
T --> A("<b>2å€æ‰©å®¹ï¼Œåˆ›å»ºæ–°æ•°ç»„</b>")
A --> B("<b>ç§»åŠ¨å…ƒç´ åˆ°æ–°æ•°ç»„</b><br><i>ï¼ˆé‡æ–°è®¡ç®—hashï¼‰</i>")
B --> b(["åˆ¤æ–­å…ƒç´ ç±»å‹è°ƒæ•´ä½ç½®"]):::lp
b -.-|"<b>å•ä¸ªå€¼</b>"| b1["â‘ åŸä½ç½®<br>â‘¡ åŸä½ç½® + åŸå®¹é‡"]:::lb
b -.-|"<b>çº¢é»‘æ ‘</b>"| b2["<i><b>split()åˆ†å‰²æ ‘</b></i><br>â‘ ä¸€æ£µï¼šåŸä½ç½®<br>â‘¡å¦ä¸€æ£µï¼šåŸä½ç½® + åŸå®¹é‡"]:::lb
b -.-|"<b>é“¾è¡¨</b>"| b3["â‘ ä½ä½é“¾è¡¨ï¼šåŸä½ç½®<br>â‘¡é«˜ä½é“¾è¡¨ï¼šåŸä½ç½® + åŸå®¹é‡"]:::lb
b2 -.- b2t["è‹¥æ ‘èŠ‚ç‚¹æ•°é‡â‰¤6ï¼šè½¬é“¾è¡¨"]:::info
classDef p fill: #ddaebd
classDef lp fill: #f4e4e9
classDef lb fill: #d9dfeb
classDef info fill:#f6f6f7,color:#737379, stroke-width: 2px, stroke-dasharray: 3 3</pre></li>
<li><strong>è°ƒæ•´ä½ç½®çš„åŸå› </strong>ï¼š<blockquote>
<p> å› ä¸ºHashMapè®¡ç®—ç´¢å¼•ä½ç½®æ˜¯æ ¹æ®<code>hashå€¼ &amp; (å½“å‰å®¹é‡ -1)</code>ï¼Œå› æ­¤å½“å®¹é‡æ”¹å˜æ—¶ï¼Œä¸€äº›åŸæœ¬çš„ç´¢å¼•ä½ç½®ä¹Ÿä¼šå‘ç”Ÿæ”¹å˜ã€‚æ‰©å®¹çš„åŒæ—¶é‡æ–°è°ƒæ•´å…ƒç´ ä½ç½®ï¼Œå–å€¼æ—¶æ‰èƒ½æ­£ç¡®åŒ¹é…åˆ°ç›¸åº”çš„é”®å€¼å¯¹ã€‚</p>
</blockquote>
</li>
</ul>
<h4 id="â‘¢-å¦‚ä½•è°ƒæ•´ä½ç½®"><a href="#â‘¢-å¦‚ä½•è°ƒæ•´ä½ç½®" class="headerlink" title="â‘¢ å¦‚ä½•è°ƒæ•´ä½ç½®"></a>â‘¢ å¦‚ä½•è°ƒæ•´ä½ç½®</h4><ul>
<li><p><strong>å…ƒç´ ä½ç½®å¦‚ä½•æ”¹å˜ï¼Ÿ</strong></p>
<pre class="mermaid">%%{
  init: {
      'themeVariables': {
          'fontSize': '14px'
      }
  }
}%%
graph TD 
T(["<b>å…ƒç´ ä½ç½®å¦‚ä½•æ”¹å˜ï¼Ÿ</b>"]):::p
T --> A("<b>hashå€¼ & åŸé•¿åº¦</b>"):::lb
A --> a["ç»“æœä¸º0ï¼Œä½ç½®ä¸å˜"]:::lp
A --> b["ç»“æœä¸º1ï¼Œåœ¨æ–°ä½ç½®"]:::lp
a -.- at["<i>å¦‚ï¼ŒåŸhashå€¼=3ï¼ˆ<b>åŸä½ç½®=3</b>ï¼‰ï¼Œ<br>æ•°ç»„é•¿åº¦16ï¼Œ hash & 16ï¼š</i><br> 0000 0011 // 3 <br> 0001 0000 // 16 <br> <b>0000 0000 // =0</b><br>åˆ™ï¼Œæ–°ä½ç½® = åŸä½ç½® = 3"]:::info
b -.- bt["<i>å¦‚ï¼ŒåŸhashå€¼=19ï¼ˆ<b>åŸä½ç½®=3</b>ï¼‰ï¼Œ<br>æ•°ç»„é•¿åº¦16ï¼Œhash & 16ï¼š</i><br> 0001 0011 // 19 <br> 0001 0000 // 16 <br> <b>0001 0000 // =1</b><br>åˆ™ï¼Œæ–°ä½ç½® = åŸä½ç½® + åŸå®¹é‡ = 19"]:::info
classDef p fill: #ddaebd
classDef lp fill: #f4e4e9
classDef lb fill: #d9dfeb
classDef info fill:#f6f6f7,color:#737379, stroke-width: 2px, stroke-dasharray: 3 3</pre>
<p>  <strong>æ»¡è¶³â€œ<code>(e.hash &amp; oldCap)==0</code>â€æ¡ä»¶çš„èŠ‚ç‚¹å¯ä»¥ç»§ç»­åœ¨åŸç´¢å¼•ä½ä¸Šå­˜å‚¨ï¼Œä¸æ»¡è¶³è¯¥æ¡ä»¶çš„èŠ‚ç‚¹åˆ™éœ€è¦è¿›è¡Œç§»åŠ¨æ“ä½œã€‚</strong></p>
<blockquote>
<p> HashMapä¸­ï¼Œtableæ•°ç»„éƒ½æ˜¯ä»¥2çš„å¹‚æ•°è¿›è¡Œæ‰©å®¹æ“ä½œçš„ï¼Œå°±æ˜¯å°†åŸå®¹é‡å€¼å·¦ç§»1ä½ã€‚<br>  å› æ­¤è¿›è¡Œæ‰©å®¹æ“ä½œåï¼Œå„ä¸ªK-Vé”®å€¼å¯¹èŠ‚ç‚¹æ˜¯å¦ä»èƒ½åœ¨åŸç´¢å¼•ä½ä¸Šï¼Œå–å†³äºæ–°å¢çš„ä¸€ä½ï¼ˆoldCapçš„å€¼ï¼‰åœ¨è¿›è¡Œä¸è¿ç®—æ—¶æ˜¯å¦ä¸º0ã€‚</p>
</blockquote>
</li>
<li><p><strong><u>é“¾è¡¨å…ƒç´ ç§»åŠ¨</u>ï¼š</strong><br><img src="https://equne.oss-cn-hangzhou.aliyuncs.com/typora/%E6%89%A9%E5%AE%B9%E7%A4%BA%E6%84%8F%E5%9B%BE.jpeg" alt="æ‰©å®¹ç¤ºæ„å›¾"></p>
<ol>
<li>æ»¡è¶³â€œ<code>(e.hash &amp; oldCap)==0</code>â€æ¡ä»¶çš„èŠ‚ç‚¹ä¼šæ„æˆæ–°çš„å•å‘é“¾è¡¨ï¼Œè¿™ä¸ªé“¾è¡¨ä¸­çš„èŠ‚ç‚¹ä¼šæŒ‰ç…§<strong><u>åŸç´¢å¼•ä½</u></strong>é¡ºåºå­˜å‚¨äºæ–°çš„HashMapé›†åˆçš„tableæ•°ç»„ä¸­ï¼›</li>
<li>æ»¡è¶³â€œ<code>(e.hash &amp;oldCap) !=0</code>â€æ¡ä»¶çš„èŠ‚ç‚¹ä¼šæ„æˆå¦ä¸€ä¸ªæ–°çš„å•å‘é“¾è¡¨ï¼Œå¹¶ä¸”å°†<strong><em>åŸç´¢å¼•å€¼+åŸæ•°ç»„é•¿åº¦</em></strong>çš„è®¡ç®—ç»“æœä½œä¸º<strong><u>æ–°çš„ç´¢å¼•å€¼</u></strong>å­˜å‚¨äºæ–°çš„HashMapé›†åˆçš„tableæ•°ç»„ä¸­ã€‚</li>
</ol>
</li>
<li><p><strong><u>çº¢é»‘æ ‘å…ƒç´ ç§»åŠ¨</u>ï¼š</strong><br><img src="https://equne.oss-cn-hangzhou.aliyuncs.com/typora/42265-00-198-2.jpeg" alt="42265-00-198-2"></p>
<ul>
<li><strong>å°†è¿™æ£µçº¢é»‘æ ‘æ‹†åˆ†æˆä¸¤æ£µæ–°çš„çº¢é»‘æ ‘</strong>ï¼šï¼ˆè‹¥çº¢é»‘æ ‘ä¸­èŠ‚ç‚¹æ•°â‰¤6ï¼Œä¼šå°†æ ‘ç»“æ„è½¬ä¸ºé“¾è¡¨ç»“æ„ï¼‰<br>â‘  ä¸€æ£µçº¢é»‘æ ‘ï¼ˆæˆ–é“¾è¡¨ï¼‰ç•™åœ¨<strong><u>åŸç´¢å¼•ä½</u></strong>ä¸Šï¼Œ<br>â‘¡ å¦ä¸€æ£µçº¢é»‘æ ‘ï¼ˆæˆ–é“¾è¡¨ï¼‰æ”¾åˆ°<strong><em>åŸç´¢å¼•å€¼+åŸæ•°ç»„å®¹é‡å€¼</em></strong>è®¡ç®—ç»“æœå¯¹åº”çš„<strong><u>æ–°ç´¢å¼•ä½</u></strong>ä¸Šã€‚</li>
</ul>
</li>
</ul>
<h4 id="resize"><a href="#resize" class="headerlink" title="- resize()"></a><em>- resize()</em></h4><ul>
<li>æ‰©å®¹<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Initializes or doubles table size.  If null, allocates in accord with initial capacity target held in field threshold.</span><br><span class="hljs-comment"> * Otherwise, because we are using power-of-two expansion, the elements from each bin must either stay at same index, or move with a power of two offset in the new table.</span><br><span class="hljs-comment"> * åˆå§‹åŒ–æˆ–äºŒå€æ‰©å®¹ã€‚è‹¥ä¸ºç©ºï¼Œæ ¹æ®é˜ˆå€¼å’Œåˆå§‹å®¹é‡åˆ†é…ã€‚</span><br><span class="hljs-comment"> * ç”±äºä½¿ç”¨2æ¬¡å¹‚æ‰©å®¹ï¼Œå› æ­¤æ¯ä¸ªå…ƒç´ ä¿æŒç›¸åŒç´¢å¼•ï¼Œæˆ–åœ¨æ–°è¡¨ä¸­ä»¥äºŒæ¬¡å¹‚åç§»é‡ç§»åŠ¨ã€‚</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> table</span><br><span class="hljs-comment">*/</span><br><span class="hljs-keyword">final</span> Node&lt;K,V&gt;[] resize() &#123;<br>    Node&lt;K,V&gt;[] oldTab = table; <span class="hljs-comment">// åŸtable</span><br>    <span class="hljs-keyword">int</span> oldCap = (oldTab == <span class="hljs-keyword">null</span>) ? <span class="hljs-number">0</span> : oldTab.length; <span class="hljs-comment">// æ‰©å®¹å‰çš„tableé•¿åº¦ï¼Œè‹¥æ— å…ƒç´ è¿”å›0</span><br>    <span class="hljs-keyword">int</span> oldThr = threshold; <span class="hljs-comment">// åŸé˜ˆå€¼</span><br>    <span class="hljs-keyword">int</span> newCap, newThr = <span class="hljs-number">0</span>; <span class="hljs-comment">// æ–°é•¿åº¦ã€æ–°é˜ˆå€¼</span><br>    <span class="hljs-comment">// ğŸ”´ ä¸€ã€è®¾ç½®æ‰©å®¹é˜ˆå€¼</span><br>    <span class="hljs-comment">//  ğŸ”¹ â‘  è‹¥å·²åˆå§‹åŒ–(åŸæ•°ç»„æœ‰å…ƒç´ )ï¼šæ£€æŸ¥æ•°ç»„é•¿åº¦å¹¶è®¾ç½®2å€æ‰©å®¹é˜ˆå€¼ã€‚</span><br>    <span class="hljs-keyword">if</span> (oldCap &gt; <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-comment">//  ğŸ”¸ è‹¥åŸæ•°ç»„é•¿åº¦è¶…è¿‡æœ€å¤§å®¹é‡å€¼ï¼šâ€”&gt; å·²åˆ°è¾¾å®¹é‡ä¸Šå€¼ï¼Œæ— æ³•å†æ‰©å®¹ï¼Œè¿”å›åŸè¡¨ã€‚</span><br>        <span class="hljs-keyword">if</span> (oldCap &gt;= MAXIMUM_CAPACITY) &#123;<br>            threshold = Integer.MAX_VALUE;<br>            <span class="hljs-keyword">return</span> oldTab;<br>        &#125;<br>        <span class="hljs-comment">//  ğŸ”¸ è‹¥åŸæ•°ç»„é•¿åº¦2å€æ‰©å®¹åä»æœªè¶…è¿‡å®¹é‡ä¸Šé™ï¼Œä¸”åŸæ•°ç»„é•¿åº¦è¶…è¿‡äº†é»˜è®¤åˆå§‹å®¹é‡ï¼šâ€”&gt; åŸæ‰©å®¹é˜ˆå€¼è®¾ç½®ä¸º2å€ã€‚</span><br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((newCap = oldCap &lt;&lt; <span class="hljs-number">1</span>) &lt; MAXIMUM_CAPACITY &amp;&amp;<br>                    oldCap &gt;= DEFAULT_INITIAL_CAPACITY)<br>            newThr = oldThr &lt;&lt; <span class="hljs-number">1</span>; <span class="hljs-comment">// double threshold</span><br>    &#125;<br>    <span class="hljs-comment">//  ğŸ”¹ â‘¡ è‹¥æœªåˆå§‹åŒ–(åŸæ•°ç»„æ— å…ƒç´ )ï¼Œä½†å·²è®¾ç½®è¿‡æ‰©å®¹é˜ˆå€¼(&gt;0) ï¼šå°†æ–°æ•°ç»„é•¿åº¦è®¾ç½®ä¸ºè¯¥æ‰©å®¹é˜ˆå€¼ã€‚</span><br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (oldThr &gt; <span class="hljs-number">0</span>) <span class="hljs-comment">// initial capacity was placed in threshold</span><br>        newCap = oldThr;<br>    <span class="hljs-comment">//  ğŸ”¹ â‘¢ è‹¥æœªåˆå§‹åŒ–(åŸæ•°ç»„æ— å…ƒç´ )ï¼Œä¸”æœªè®¾ç½®è¿‡æ‰©å®¹é˜ˆå€¼ï¼šä½¿ç”¨ç³»ç»Ÿè®¾ç½®çš„é»˜è®¤æ•°ç»„é•¿åº¦å’Œé»˜è®¤é˜ˆå€¼èµ‹å€¼ã€‚</span><br>    <span class="hljs-keyword">else</span> &#123;               <span class="hljs-comment">// zero initial threshold signifies using defaults</span><br>        newCap = DEFAULT_INITIAL_CAPACITY;<br>        newThr = (<span class="hljs-keyword">int</span>)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);<br>    &#125;<br><br>    <span class="hljs-comment">// ğŸ”´ äºŒã€æ£€æŸ¥æ‰©å®¹é˜ˆå€¼</span><br>    <span class="hljs-comment">// è‹¥æ–°æ‰©å®¹é˜ˆå€¼ä»ä¸º0ï¼šä½¿ç”¨æ–°æ•°ç»„é•¿åº¦è®¡ç®—æ–°çš„æ‰©å®¹é˜ˆå€¼ï¼ˆå¹¶å°†æ•°ç»„é•¿åº¦é™åˆ¶åœ¨æœ€å¤§å®¹é‡ä¸Šé™å†…ï¼‰</span><br>    <span class="hljs-keyword">if</span> (newThr == <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">float</span> ft = (<span class="hljs-keyword">float</span>)newCap * loadFactor;<br>        newThr = (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (<span class="hljs-keyword">float</span>)MAXIMUM_CAPACITY ?<br>                    (<span class="hljs-keyword">int</span>)ft : Integer.MAX_VALUE);<br>    &#125;<br>    <span class="hljs-comment">// è®¾ç½®æ‰©å®¹é˜ˆå€¼</span><br>    threshold = newThr;<br><br>    <span class="hljs-comment">// ğŸ”´ ä¸‰ã€æ‰©å®¹</span><br>    <span class="hljs-meta">@SuppressWarnings(&#123;&quot;rawtypes&quot;,&quot;unchecked&quot;&#125;)</span><br>    <span class="hljs-comment">// ğŸ”¹ æ–°å»ºæ•°ç»„</span><br>    Node&lt;K,V&gt;[] newTab = (Node&lt;K,V&gt;[])<span class="hljs-keyword">new</span> Node[newCap]; <span class="hljs-comment">// ä½¿ç”¨æ–°çš„æ•°ç»„é•¿åº¦åˆ›å»ºæ–°æ•°ç»„</span><br>    table = newTab;<br>    <span class="hljs-comment">// ğŸ”¹ ç§»åŠ¨å…ƒç´ åˆ°æ–°æ•°ç»„</span><br>    <span class="hljs-comment">//   - è‹¥åŸæ•°ç»„ä¸ºç©ºï¼Œæ— éœ€ç§»åŠ¨ï¼Œç›´æ¥è¿”å›è¯¥æ•°ç»„ã€‚</span><br>    <span class="hljs-comment">//   - è‹¥åŸæ•°ç»„éç©ºï¼šç§»åŠ¨æ•°æ®åˆ°æ–°æ•°ç»„ã€‚</span><br>    <span class="hljs-keyword">if</span> (oldTab != <span class="hljs-keyword">null</span>) &#123;<br>        <span class="hljs-comment">// ğŸ”¸ å¤–å±‚å¾ªç¯ï¼šéå†åŸæ•°ç»„å…ƒç´ </span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; oldCap; ++j) &#123;<br>            Node&lt;K,V&gt; e;<br>            <span class="hljs-keyword">if</span> ((e = oldTab[j]) != <span class="hljs-keyword">null</span>) &#123;<br>                <span class="hljs-comment">// æ¸…ç©ºåŸå€¼ï¼Œä¾¿äºGCå›æ”¶ã€‚</span><br>                oldTab[j] = <span class="hljs-keyword">null</span>;<br>                <span class="hljs-comment">// â‘  å•ä¸ªå€¼</span><br>                <span class="hljs-keyword">if</span> (e.next == <span class="hljs-keyword">null</span>)<br>                    newTab[e.hash &amp; (newCap - <span class="hljs-number">1</span>)] = e; <span class="hljs-comment">// åŸä½ æˆ– +æ—§å®¹é‡oldCap</span><br>                <span class="hljs-comment">// â‘¡ çº¢é»‘æ ‘ï¼šåˆ†å‰²</span><br>                <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (e <span class="hljs-keyword">instanceof</span> TreeNode)<br>                    ((TreeNode&lt;K,V&gt;)e).split(<span class="hljs-keyword">this</span>, newTab, j, oldCap);<br>                <span class="hljs-comment">// â‘¢ é“¾è¡¨ï¼š</span><br>                <span class="hljs-keyword">else</span> &#123; <span class="hljs-comment">// preserve order</span><br>                    <span class="hljs-comment">// ä½ä½é“¾è¡¨ï¼šä½ç½®ä¸å˜</span><br>                    Node&lt;K,V&gt; loHead = <span class="hljs-keyword">null</span>, loTail = <span class="hljs-keyword">null</span>; <br>                    <span class="hljs-comment">// é«˜ä½é“¾è¡¨ï¼šä½ç½® + å®¹é‡</span><br>                    Node&lt;K,V&gt; hiHead = <span class="hljs-keyword">null</span>, hiTail = <span class="hljs-keyword">null</span>;<br>                    Node&lt;K,V&gt; next;<br>                    <span class="hljs-comment">// ğŸ”¸ å†…å±‚å¾ªç¯ï¼šè®¡ç®—æ–°èŠ‚ç‚¹çš„ç´¢å¼•ä½ç½®ã€‚</span><br>                    <span class="hljs-keyword">do</span> &#123;<br>                        next = e.next;<br>                        <span class="hljs-comment">// trueï¼šä½ç½®ä¸å˜ï¼ˆä½ä½é“¾è¡¨ï¼‰</span><br>                        <span class="hljs-keyword">if</span> ((e.hash &amp; oldCap) == <span class="hljs-number">0</span>) &#123;<br>                            <span class="hljs-keyword">if</span> (loTail == <span class="hljs-keyword">null</span>)<br>                                loHead = e;<br>                            <span class="hljs-keyword">else</span><br>                                loTail.next = e;<br>                            loTail = e;<br>                        &#125;<br>                        <span class="hljs-comment">// falseï¼šä½ç½® + å®¹é‡ï¼ˆé«˜ä½é“¾è¡¨ï¼‰</span><br>                        <span class="hljs-keyword">else</span> &#123;<br>                            <span class="hljs-keyword">if</span> (hiTail == <span class="hljs-keyword">null</span>)<br>                                hiHead = e;<br>                            <span class="hljs-keyword">else</span><br>                                hiTail.next = e;<br>                            hiTail = e;<br>                        &#125;<br>                    &#125; <span class="hljs-keyword">while</span> ((e = next) != <span class="hljs-keyword">null</span>);<br>                    <span class="hljs-comment">// ä½ä½é“¾è¡¨èµ‹å€¼</span><br>                    <span class="hljs-keyword">if</span> (loTail != <span class="hljs-keyword">null</span>) &#123;<br>                        loTail.next = <span class="hljs-keyword">null</span>;<br>                        newTab[j] = loHead;<br>                    &#125;<br>                    <span class="hljs-comment">// é«˜ä½é“¾è¡¨èµ‹å€¼</span><br>                    <span class="hljs-keyword">if</span> (hiTail != <span class="hljs-keyword">null</span>) &#123;<br>                        hiTail.next = <span class="hljs-keyword">null</span>;<br>                        newTab[j + oldCap] = hiHead;<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">// ğŸ”¹ è¿”å›æ–°æ•°ç»„</span><br>    <span class="hljs-keyword">return</span> newTab;<br>&#125;<br></code></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="5-å†…éƒ¨ç±»"><a href="#5-å†…éƒ¨ç±»" class="headerlink" title="5. å†…éƒ¨ç±»"></a>5. å†…éƒ¨ç±»</h2><h3 id="ï¼ˆ1ï¼‰Node"><a href="#ï¼ˆ1ï¼‰Node" class="headerlink" title="ï¼ˆ1ï¼‰Node"></a>ï¼ˆ1ï¼‰Node</h3><ul>
<li><p><strong>HashMap.Nodeç±»</strong>ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Basic hash bin node, used for most entries.  (See below for TreeNode subclass, and in LinkedHashMap for its Entry subclass.)</span><br><span class="hljs-comment"> * åŸºæœ¬hashçš„binèŠ‚ç‚¹ï¼Œç”¨äºå¤§éƒ¨åˆ†èŠ‚ç‚¹ã€‚ï¼ˆTreeNodeå­ç±»è§ä¸‹æ–‡ï¼ŒEntryå­ç±»è§LinkedHashMapã€‚ï¼‰</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Node</span>&lt;<span class="hljs-title">K</span>,<span class="hljs-title">V</span>&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title">Map</span>.<span class="hljs-title">Entry</span>&lt;<span class="hljs-title">K</span>,<span class="hljs-title">V</span>&gt; </span>&#123;<br>    <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> hash;<br>    <span class="hljs-keyword">final</span> K key; <span class="hljs-comment">// finalï¼šç”±äºkeyæ˜¯è®¡ç®—å…ƒç´ æ’åˆ—ä½ç½®çš„ä¾æ®ï¼Œå› æ­¤ä¸€æ—¦åˆå§‹åŒ–å°±ä¸å…è®¸æ”¹å˜ã€‚</span><br>    V value;<br>    Node&lt;K,V&gt; next; <span class="hljs-comment">// ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆå› ä¸ºéœ€è¦ç”¨NodeèŠ‚ç‚¹æ„å»ºå•å‘é“¾è¡¨ï¼‰</span><br><br>    Node(<span class="hljs-keyword">int</span> hash, K key, V value, Node&lt;K,V&gt; next) &#123;<br>        <span class="hljs-keyword">this</span>.hash = hash;<br>        <span class="hljs-keyword">this</span>.key = key;<br>        <span class="hljs-keyword">this</span>.value = value;<br>        <span class="hljs-keyword">this</span>.next = next;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> K <span class="hljs-title">getKey</span><span class="hljs-params">()</span>        </span>&#123; <span class="hljs-keyword">return</span> key; &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> V <span class="hljs-title">getValue</span><span class="hljs-params">()</span>      </span>&#123; <span class="hljs-keyword">return</span> value; &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> String <span class="hljs-title">toString</span><span class="hljs-params">()</span> </span>&#123; <span class="hljs-keyword">return</span> key + <span class="hljs-string">&quot;=&quot;</span> + value; &#125;<br><br>    <span class="hljs-comment">// ğŸ”» é‡å†™hashCode()ï¼šå°†keyçš„Hashå€¼ã€valueçš„Hashå€¼è¿›è¡Œå¼‚æˆ–è¿ç®—ã€‚</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> <span class="hljs-title">hashCode</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> Objects.hashCode(key) ^ Objects.hashCode(value);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> V <span class="hljs-title">setValue</span><span class="hljs-params">(V newValue)</span> </span>&#123;<br>        V oldValue = value;<br>        value = newValue;<br>        <span class="hljs-keyword">return</span> oldValue;<br>    &#125;<br><br>    <span class="hljs-comment">// ğŸ”» é‡å†™equals()</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">equals</span><span class="hljs-params">(Object o)</span> </span>&#123;<br>        <span class="hljs-comment">// ğŸ”¹ â‘  åˆ¤æ–­ä¸¤ä¸ªèŠ‚ç‚¹çš„å†…å­˜èµ·å§‹åœ°å€ç›¸åŒ</span><br>        <span class="hljs-keyword">if</span> (o == <span class="hljs-keyword">this</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>        <span class="hljs-comment">// ğŸ”¹ â‘¡ åˆ¤æ–­ä¸¤ä¸ªMapç±»å‹èŠ‚ç‚¹çš„keyå’Œvalueå€¼éƒ½ç›¸ç­‰</span><br>        <span class="hljs-keyword">if</span> (o <span class="hljs-keyword">instanceof</span> Map.Entry) &#123;<br>            Map.Entry&lt;?,?&gt; e = (Map.Entry&lt;?,?&gt;)o;<br>            <span class="hljs-keyword">if</span> (Objects.equals(key, e.getKey()) &amp;&amp;<br>                Objects.equals(value, e.getValue()))<br>                <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p><strong>é‡å†™HashCode()</strong></p>
<blockquote>
<p>Javaå®˜æ–¹å¯¹é‡å†™å¯¹è±¡çš„ <strong>hashCode()</strong> æ–¹æ³•æœ‰ä¸¥æ ¼çš„è¦æ±‚ â€”â€” <b><em>è‹¥é‡å†™ <strong>hashCode()</strong> æ–¹æ³•ï¼Œåˆ™éœ€è¦é‡å†™ç›¸åº”çš„ <strong>equals()</strong> æ–¹æ³•</em></b>ã€‚</p>
</blockquote>
</li>
<li><p><strong>è¡¥å……ï¼šObjectså·¥å…·ç±»</strong></p>
<pre class="mermaid">graph LR
T(["<b>Objects<br>å·¥å…·ç±»</b>"]):::p
T --> A("æä¾›äº†è¿›è¡Œå¯¹è±¡æ¯”è¾ƒã€<br>æ£€éªŒçš„åŸºæœ¬æ“ä½œ"):::lb
A --> 1(["compare(T, S, Comparator)"]):::lp
A --> 2(["<b>hashCode(Object)</b>"]):::lp
A --> 3(["hashCode(Object[])"]):::lp
A --> 4("isNull(Object)ã€<br>nonNull(Object)ã€<br>requireNonNull(Object)ç­‰"):::lp
A --> 5(["toString(Object)"]):::lp
1 -.- 1t["ä¸¤ä¸ªå¯¹è±¡çš„æ¯”è¾ƒæ“ä½œ"]
2 -.- 2t["è®¡ç®—å¯¹è±¡Hashå€¼"]
3 -.- 3t["è®¡ç®—å¤šä¸ªå¯¹è±¡çš„Hashå€¼ç»„åˆ"]
4 -.- 4t["æ ¡éªŒæˆ–ç¡®è®¤å½“å‰å¯¹è±¡æ˜¯å¦ä¸ºç©º"]
5 -.- 5t["è¿”å›å¯¹è±¡çš„å­—ç¬¦ä¸²ä¿¡æ¯"]
classDef p fill: #ddaebd
classDef lp fill: #f4e4e9
classDef lb fill: #d9dfeb</pre></li>
<li><p><strong><u>æ ¹æ®å“ˆå¸Œå€¼å­˜å–å¯¹è±¡ã€æ¯”è¾ƒå¯¹è±¡</u>æ˜¯è®¡ç®—æœºç¨‹åºä¸­ä¸€ç§é‡è¦çš„æ€ç»´æ–¹å¼ã€‚</strong></p>
<blockquote>
<p>å®ƒä½¿å¾—å­˜å–å¯¹è±¡ä¸»è¦ä¾èµ–äºè‡ªèº«Hashå€¼ï¼Œè€Œä¸æ˜¯ä¸å…¶ä»–å¯¹è±¡è¿›è¡Œæ¯”è¾ƒï¼Œå­˜å–æ•ˆç‡ä¹Ÿä¸é›†åˆå¤§å°æ— å…³ï¼Œé«˜è¾¾O(1)ï¼Œå³ä½¿è¿›è¡Œæ¯”è¾ƒï¼Œä¹Ÿåˆ©ç”¨Hashå€¼æé«˜æ¯”è¾ƒæ€§èƒ½ã€‚</p>
</blockquote>
</li>
</ul>
<h3 id="ï¼ˆ2ï¼‰TreeNode"><a href="#ï¼ˆ2ï¼‰TreeNode" class="headerlink" title="ï¼ˆ2ï¼‰TreeNode"></a>ï¼ˆ2ï¼‰TreeNode</h3><ul>
<li>TreeNode ç»§æ‰¿è‡ª <strong>LinkedHashMap.Entry</strong> ç±»ã€‚</li>
<li>HashMapé›†åˆä½¿ç”¨ <strong>HashMap.TreeNode</strong> ç±»çš„å¯¹è±¡è¡¨ç¤ºçº¢é»‘æ ‘ä¸­çš„èŠ‚ç‚¹ï¼Œæ¥æ„æˆçº¢é»‘æ ‘ã€‚<blockquote>
<p>â‘  å½“æŸä¸ªç´¢å¼•ä½ä¸Šçš„é“¾è¡¨é•¿åº¦è¾¾åˆ°æŒ‡å®šçš„é˜ˆå€¼ï¼ˆé»˜è®¤ä¸ºå•å‘é“¾è¡¨é•¿åº¦è¶…è¿‡8ï¼‰æ—¶ï¼Œå•å‘é“¾è¡¨ä¼šè½¬åŒ–ä¸ºçº¢é»‘æ ‘ï¼›<br>â‘¡ å½“çº¢é»‘æ ‘ä¸­çš„èŠ‚ç‚¹è¶³å¤Ÿå°‘ï¼ˆé»˜è®¤ä¸ºçº¢é»‘æ ‘ä¸­çš„èŠ‚ç‚¹æ•°é‡å°‘äº6ä¸ªï¼‰æ—¶ï¼Œçº¢é»‘æ ‘ä¼šè½¬æ¢ä¸ºå•å‘é“¾è¡¨ã€‚</p>
</blockquote>
<h4 id="å±æ€§"><a href="#å±æ€§" class="headerlink" title="- å±æ€§"></a>- <em>å±æ€§</em></h4><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TreeNode</span>&lt;<span class="hljs-title">K</span>,<span class="hljs-title">V</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title">LinkedHashMap</span>.<span class="hljs-title">Entry</span>&lt;<span class="hljs-title">K</span>,<span class="hljs-title">V</span>&gt; </span>&#123;<br>    <span class="hljs-comment">// çˆ¶èŠ‚ç‚¹</span><br>    TreeNode&lt;K,V&gt; parent;  <span class="hljs-comment">// red-black tree links</span><br>    <span class="hljs-comment">// å·¦èŠ‚ç‚¹</span><br>    TreeNode&lt;K,V&gt; left;  <br>    <span class="hljs-comment">// å³èŠ‚ç‚¹</span><br>    TreeNode&lt;K,V&gt; right;  <br>    <span class="hljs-comment">// å‰èŠ‚ç‚¹ï¼šåˆ é™¤æ—¶éœ€è¦å–æ¶ˆé“¾æ¥&quot;next&quot;</span><br>    TreeNode&lt;K,V&gt; prev;    <span class="hljs-comment">// needed to unlink next upon deletion</span><br>    <span class="hljs-comment">// èŠ‚ç‚¹é¢œè‰²ï¼štrueçº¢è‰²ï¼›falseé»‘è‰² </span><br>    <span class="hljs-keyword">boolean</span> red;<br><br>    <span class="hljs-comment">// æ„é€ æ–¹æ³•ï¼Œå‚æ•°ï¼šhashå€¼ã€keyã€valueã€ä¸‹ä¸€ä¸ªNodeèŠ‚ç‚¹</span><br>    TreeNode(<span class="hljs-keyword">int</span> hash, K key, V val, Node&lt;K,V&gt; next) &#123;<br>        <span class="hljs-keyword">super</span>(hash, key, val, next);<br>    &#125;<br><br>    <span class="hljs-comment">// ...</span><br>    <span class="hljs-comment">// è¿˜æœ‰æ„å»ºçº¢é»‘æ ‘ã€è§£æ„çº¢é»‘æ ‘ã€æ·»åŠ èŠ‚ç‚¹ã€ç§»é™¤èŠ‚ç‚¹ç­‰æ–¹æ³•</span><br>&#125;<br></code></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="getTreeNode"><a href="#getTreeNode" class="headerlink" title="- getTreeNode()"></a>- <em>getTreeNode()</em></h4><ul>
<li>è·å–çº¢é»‘æ ‘èŠ‚ç‚¹  <figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"> <span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Calls find for root node. </span><br><span class="hljs-comment"> * è°ƒç”¨æŸ¥æ‰¾æ ¹èŠ‚ç‚¹</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">final</span> TreeNode&lt;K,V&gt; <span class="hljs-title">getTreeNode</span><span class="hljs-params">(<span class="hljs-keyword">int</span> h, Object k)</span> </span>&#123;<br>    <span class="hljs-comment">// ğŸ”» è°ƒç”¨find()æŸ¥æ‰¾èŠ‚ç‚¹</span><br>    <span class="hljs-keyword">return</span> ((parent != <span class="hljs-keyword">null</span>) ? root() : <span class="hljs-keyword">this</span>).find(h, k, <span class="hljs-keyword">null</span>);<br>    <span class="hljs-comment">// è‹¥æ ¹èŠ‚ç‚¹ä¸ä¸ºç©ºï¼Œè°ƒç”¨rootèŠ‚ç‚¹æŸ¥æ‰¾ï¼›è‹¥æ ¹èŠ‚ç‚¹ä¸ºç©ºï¼Œä½¿ç”¨thisæŸ¥æ‰¾ã€‚</span><br>&#125;<br></code></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="find"><a href="#find" class="headerlink" title="- find()"></a>- <em>find()</em></h4><ul>
<li>æŸ¥æ‰¾æ ‘èŠ‚ç‚¹  <figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Finds the node starting at root p with the given hash and key. The kc argument caches comparableClassFor(key) upon first use comparing keys.</span><br><span class="hljs-comment"> * ä½¿ç”¨ç»™å®šçš„keyå’Œhashå€¼æŸ¥æ‰¾ä»æ ¹på¼€å§‹çš„èŠ‚ç‚¹ã€‚</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">final</span> TreeNode&lt;K,V&gt; <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-keyword">int</span> h, Object k, Class&lt;?&gt; kc)</span> </span>&#123;<br>    TreeNode&lt;K,V&gt; p = <span class="hljs-keyword">this</span>; <span class="hljs-comment">// å½“å‰æ ‘å½¢Nodeï¼šp</span><br>    <span class="hljs-comment">// éå†æ•´æ ‘ï¼š</span><br>    <span class="hljs-keyword">do</span> &#123;<br>        <span class="hljs-keyword">int</span> ph, dir; <br>        K pk;<br>        TreeNode&lt;K,V&gt; pl = p.left, pr = p.right, q; <span class="hljs-comment">// å½“å‰Nodeå·¦èŠ‚ç‚¹ã€å³èŠ‚ç‚¹ã€</span><br>        <span class="hljs-comment">// è‹¥å½“å‰èŠ‚ç‚¹hashå€¼è¾ƒå¤§ï¼špå–å…¶å·¦èŠ‚ç‚¹</span><br>        <span class="hljs-keyword">if</span> ((ph = p.hash) &gt; h)<br>            p = pl;<br>        <span class="hljs-comment">// è‹¥å½“å‰èŠ‚ç‚¹hashå€¼è¾ƒå°ï¼špå–å…¶å³èŠ‚ç‚¹</span><br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ph &lt; h)<br>            p = pr;<br>        <span class="hljs-comment">// è‹¥å½“å‰èŠ‚ç‚¹keyå€¼ç­‰äºç»™å®škeyå€¼ï¼Œè¿”å›å½“å‰èŠ‚ç‚¹</span><br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((pk = p.key) == k || (k != <span class="hljs-keyword">null</span> &amp;&amp; k.equals(pk)))<br>            <span class="hljs-keyword">return</span> p;<br>        <span class="hljs-comment">// è‹¥å·¦èŠ‚ç‚¹ä¸ºç©ºï¼Œpå–å…¶å³èŠ‚ç‚¹</span><br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (pl == <span class="hljs-keyword">null</span>)<br>            p = pr;<br>        <span class="hljs-comment">// è‹¥å³èŠ‚ç‚¹ä¸ºç©ºï¼Œpå–å…¶å·¦èŠ‚ç‚¹</span><br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (pr == <span class="hljs-keyword">null</span>)<br>            p = pl;<br>        <span class="hljs-comment">// æ ¹æ®compareToæ¯”è¾ƒ</span><br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((kc != <span class="hljs-keyword">null</span> ||<br>                    (kc = comparableClassFor(k)) != <span class="hljs-keyword">null</span>) &amp;&amp;<br>                    (dir = compareComparables(kc, k, pk)) != <span class="hljs-number">0</span>)<br>            p = (dir &lt; <span class="hljs-number">0</span>) ? pl : pr;<br>        <span class="hljs-comment">// æ ¹æ®compareToçš„ç»“æœï¼Œè‹¥å³èŠ‚ç‚¹èƒ½æ‰¾åˆ°ï¼šè¿”å›å³èŠ‚ç‚¹</span><br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((q = pr.find(h, k, kc)) != <span class="hljs-keyword">null</span>)<br>            <span class="hljs-keyword">return</span> q;<br>        <span class="hljs-comment">// è‹¥compareToçš„ç»“æœåœ¨å·¦èŠ‚ç‚¹ä¸Šï¼šç»§ç»­æŸ¥æ‰¾</span><br>        <span class="hljs-keyword">else</span><br>            p = pl;<br>    &#125; <span class="hljs-keyword">while</span> (p != <span class="hljs-keyword">null</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="split"><a href="#split" class="headerlink" title="- split()"></a><em>- split()</em></h4><ul>
<li>åˆ†å‰²æ ‘ç»“æ„ï¼ˆHashMapæ‰©å®¹æ—¶ä½¿ç”¨åˆ°çš„æ–¹æ³•ï¼‰<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment">    * Splits nodes in a tree bin into lower and upper tree bins, or untreeifies if now too small. Called only from resize; see above discussion about split bits and indices.</span><br><span class="hljs-comment">    * åˆ†å‰²è¯¥æ ‘ä¸ºä¸¤æ£µæ ‘ï¼Œè‹¥æ ‘å¤ªå°åˆ™é“¾åŒ–ã€‚</span><br><span class="hljs-comment">    *</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@param</span> map </span><br><span class="hljs-comment">    * <span class="hljs-doctag">@param</span> tab table</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@param</span> index è¢«åˆ†å‰²æ ‘çš„ç´¢å¼•ä½ç½®</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@param</span> bit æ‰©å®¹å‰çš„åŸæ•°ç»„å®¹é‡</span><br><span class="hljs-comment">    */</span><br><span class="hljs-function"><span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title">split</span><span class="hljs-params">(HashMap&lt;K,V&gt; map, Node&lt;K,V&gt;[] tab, <span class="hljs-keyword">int</span> index, <span class="hljs-keyword">int</span> bit)</span> </span>&#123;<br>    TreeNode&lt;K,V&gt; b = <span class="hljs-keyword">this</span>; <span class="hljs-comment">// å½“å‰æ ‘èŠ‚ç‚¹</span><br>    <span class="hljs-comment">// Relink into lo and hi lists, preserving order</span><br>    TreeNode&lt;K,V&gt; loHead = <span class="hljs-keyword">null</span>, loTail = <span class="hljs-keyword">null</span>;<br>    TreeNode&lt;K,V&gt; hiHead = <span class="hljs-keyword">null</span>, hiTail = <span class="hljs-keyword">null</span>;<br>    <span class="hljs-keyword">int</span> lc = <span class="hljs-number">0</span>, hc = <span class="hljs-number">0</span>; <span class="hljs-comment">// éå†æ—¶è®¡ç®—é“¾è¡¨çš„é•¿åº¦</span><br>    <span class="hljs-comment">// ğŸ”´ ä¸€ã€é‡æ–°è®¡ç®—ç´¢å¼•ä½ç½®ï¼ˆéå†åŒå‘é“¾è¡¨ç»“æ„ï¼‰</span><br>    <span class="hljs-keyword">for</span> (TreeNode&lt;K,V&gt; e = b, next; e != <span class="hljs-keyword">null</span>; e = next) &#123;<br>        <span class="hljs-comment">// ğŸ”» æ‹†åˆ†ï¼šå‰²æ–­å½“å‰èŠ‚ç‚¹çš„nextå¼•ç”¨ã€‚</span><br>        next = (TreeNode&lt;K,V&gt;)e.next;<br>        e.next = <span class="hljs-keyword">null</span>;<br>        <span class="hljs-comment">// ğŸ”¹ åŸä½ç½®ï¼š</span><br>        <span class="hljs-keyword">if</span> ((e.hash &amp; bit) == <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-comment">// æ— éœ€ç§»åŠ¨å…ƒç´ å³å¯ç»„æˆæ–°é“¾è¡¨ï¼š</span><br>            <span class="hljs-keyword">if</span> ((e.prev = loTail) == <span class="hljs-keyword">null</span>)<br>                loHead = e;<br>            <span class="hljs-keyword">else</span><br>                loTail.next = e;<br>            loTail = e;<br>            ++lc; <span class="hljs-comment">// è®°å½•é“¾è¡¨é•¿åº¦</span><br>        &#125;<br>        <span class="hljs-comment">// ğŸ”¹ æ–°ä½ç½®ï¼š</span><br>        <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">if</span> ((e.prev = hiTail) == <span class="hljs-keyword">null</span>)<br>                hiHead = e;<br>            <span class="hljs-keyword">else</span><br>                hiTail.next = e;<br>            hiTail = e;<br>            ++hc; <span class="hljs-comment">// è®°å½•é•¿åº¦</span><br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">// ğŸ”´ äºŒã€ç§»åŠ¨å…ƒç´ ï¼ˆå°†ä¸¤ä¸ªæ–°é“¾è¡¨æ ‘åŒ–æˆ–å–æ¶ˆæ ‘åŒ–ï¼‰</span><br>    <span class="hljs-comment">//  ğŸ”¹ 0ï¼šåŸä½ç½®</span><br>    <span class="hljs-keyword">if</span> (loHead != <span class="hljs-keyword">null</span>) &#123;<br>        <span class="hljs-comment">// ğŸ”¸ è‹¥èŠ‚ç‚¹â‰¤æ ‘åŒ–é˜ˆå€¼ï¼šå–æ¶ˆæ ‘åŒ–ï¼Œè½¬ä¸ºé“¾è¡¨</span><br>        <span class="hljs-keyword">if</span> (lc &lt;= UNTREEIFY_THRESHOLD)<br>            tab[index] = loHead.untreeify(map);<br>        <span class="hljs-comment">// ğŸ”¸ è‹¥èŠ‚ç‚¹â‰¥æ ‘åŒ–é˜ˆå€¼ï¼šæ ‘åŒ–</span><br>        <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">// å°†é“¾è¡¨å­˜å…¥tableç´¢å¼•ä½ç½®</span><br>            tab[index] = loHead;<br>            <span class="hljs-comment">// ç¡®è®¤é“¾è¡¨å­˜åœ¨å…ƒç´ åæ ‘åŒ–</span><br>            <span class="hljs-keyword">if</span> (hiHead != <span class="hljs-keyword">null</span>) <span class="hljs-comment">// (else is already treeified)</span><br>                loHead.treeify(tab);<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">// ğŸ”¹ 1ï¼šæ–°ä½ç½®ï¼ˆåŸä½ç½® + åŸå®¹é‡ï¼‰ï¼šåŒä¸Š</span><br>    <span class="hljs-keyword">if</span> (hiHead != <span class="hljs-keyword">null</span>) &#123;<br>        <span class="hljs-keyword">if</span> (hc &lt;= UNTREEIFY_THRESHOLD)<br>            tab[index + bit] = hiHead.untreeify(map);<br>        <span class="hljs-keyword">else</span> &#123;<br>            tab[index + bit] = hiHead;<br>            <span class="hljs-keyword">if</span> (loHead != <span class="hljs-keyword">null</span>)<br>                hiHead.treeify(tab);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><strong>ğŸ¦‹ çº¢é»‘æ ‘ä¸­éšå«çš„åŒå‘é“¾è¡¨ç»“æ„</strong>ï¼š<br>  â‘  åœ¨å°†çº¢é»‘æ ‘ç»“æ„<strong>è½¬æ¢ä¸ºé“¾è¡¨ç»“æ„</strong>çš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦ä½¿ç”¨è¿™ä¸ªéšå«çš„åŒå‘é“¾è¡¨è¿›è¡Œéå†ï¼›<br>  â‘¡ åœ¨çº¢é»‘æ ‘ç»“æ„çš„<strong>æ‹†åˆ†</strong>è¿‡ç¨‹ä¸­ï¼Œä¹Ÿéœ€è¦ä½¿ç”¨è¿™ä¸ªéšå«çš„åŒå‘é“¾è¡¨è¿›è¡Œéå†ã€‚</li>
</ul>
<h3 id="ï¼ˆ3ï¼‰Iterators"><a href="#ï¼ˆ3ï¼‰Iterators" class="headerlink" title="ï¼ˆ3ï¼‰Iterators"></a>ï¼ˆ3ï¼‰Iterators</h3><h4 id="nextNode"><a href="#nextNode" class="headerlink" title="- nextNode()"></a>- <em>nextNode()</em></h4><ul>
<li><p><strong>HashMapå®ç°äº†Iterator(è¿­ä»£å™¨)æ¥å£ã€‚</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HashIterator</span> </span>&#123;<br>        Node&lt;K,V&gt; next;        <span class="hljs-comment">// å°†è¿”å›çš„ä¸‹ä¸ªentry</span><br>        Node&lt;K,V&gt; current;     <span class="hljs-comment">// å½“å‰ entry</span><br>        <span class="hljs-keyword">int</span> expectedModCount;  <span class="hljs-comment">// ç”¨äºå¿«é€Ÿå¤±è´¥çš„å±æ€§</span><br>        <span class="hljs-keyword">int</span> index;             <span class="hljs-comment">// å½“å‰ç´¢å¼•</span><br>    <br>    HashIterator() &#123;<br>        expectedModCount = modCount;<br>        Node&lt;K,V&gt;[] t = table;<br>        current = next = <span class="hljs-keyword">null</span>;<br>        index = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">if</span> (t != <span class="hljs-keyword">null</span> &amp;&amp; size &gt; <span class="hljs-number">0</span>) &#123; <span class="hljs-comment">// advance to first entry</span><br>            <span class="hljs-keyword">do</span> &#123;&#125; <span class="hljs-keyword">while</span> (index &lt; t.length &amp;&amp; (next = t[index++]) == <span class="hljs-keyword">null</span>);<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-function"><span class="hljs-keyword">final</span> Node&lt;K,V&gt; <span class="hljs-title">nextNode</span><span class="hljs-params">()</span> </span>&#123;<br>        Node&lt;K,V&gt;[] t;<br>        Node&lt;K,V&gt; e = next;<br>        <span class="hljs-comment">// è‹¥modCountä¸ç­‰äºexpectedModCountï¼šæŠ›å‡ºå¼‚å¸¸</span><br>        <span class="hljs-keyword">if</span> (modCount != expectedModCount)<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ConcurrentModificationException();<br>        <span class="hljs-comment">// è‹¥æŒ‡å®šNodeä¸ºç©ºï¼šæŠ›å‡ºå¼‚å¸¸</span><br>        <span class="hljs-keyword">if</span> (e == <span class="hljs-keyword">null</span>)<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NoSuchElementException();<br>        <span class="hljs-comment">// è‹¥nextæŒ‡å‘çš„Nodeï¼ˆå³å½“å‰Nodeçš„nextçš„å€¼ï¼‰ä¸ä¸ºç©ºï¼Œä¸”æ•°ç»„ä¸ä¸ºç©ºï¼š</span><br>        <span class="hljs-keyword">if</span> ((next = (current = e).next) == <span class="hljs-keyword">null</span> &amp;&amp; (t = table) != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-comment">// é™å®šç´¢å¼•ä¸è¶…å‡ºé•¿åº¦ã€ä¸”ä¸‹ä¸ªä½ç½®ä»æœ‰å…ƒç´ ã€‚</span><br>            <span class="hljs-keyword">do</span> &#123;&#125; <span class="hljs-keyword">while</span> (index &lt; t.length &amp;&amp; (next = t[index++]) == <span class="hljs-keyword">null</span>);<br>        &#125;<br>        <span class="hljs-keyword">return</span> e;<br>    &#125;<br>    <span class="hljs-comment">// ... </span><br>    <span class="hljs-comment">// EntryIteratorï¼Œç»§æ‰¿è‡ªHashIterator</span><br>    <span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EntryIterator</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HashIterator</span></span><br><span class="hljs-class">        <span class="hljs-keyword">implements</span> <span class="hljs-title">Iterator</span>&lt;<span class="hljs-title">Map</span>.<span class="hljs-title">Entry</span>&lt;<span class="hljs-title">K</span>,<span class="hljs-title">V</span>&gt;&gt; </span>&#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> Map.<span class="hljs-function">Entry&lt;K,V&gt; <span class="hljs-title">next</span><span class="hljs-params">()</span> </span>&#123; <span class="hljs-keyword">return</span> nextNode(); &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p><strong>éå†å…ƒç´ æ—¶ä½¿ç”¨<code>modCount</code>å±æ€§åˆ¤æ–­HashMapæ˜¯å¦å‘ç”Ÿç»“æ„æ€§å˜åŒ–</strong></p>
<blockquote>
<p>ğŸ”¹ <strong>å±æ€§</strong>ï¼š<br><strong>- <u>modCount</u></strong>ï¼šHashMapç±»ä¸­çš„ä¸€ä¸ªæˆå‘˜å˜é‡ï¼Œè¡¨ç¤ºå¯¹HashMapçš„ä¿®æ”¹æ¬¡æ•°ã€‚ï¼ˆä¸ArrayListå’ŒLinkedListç›¸åŒï¼‰<br><strong>- <u>expectedModCount</u></strong>ï¼šè¡¨ç¤ºå¯¹hashMapä¿®æ”¹æ¬¡æ•°çš„æœŸæœ›å€¼ï¼Œå®ƒçš„åˆå§‹å€¼ä¸ºmodCountã€‚<br><strong>- <u>ConcurrentModificationException()</u>å¼‚å¸¸</strong>ï¼šæ­¤å¼‚å¸¸ä¸ºäº†é˜²æ­¢åœ¨ä½¿ç”¨Iteratoréå†å®¹å™¨çš„åŒæ—¶åˆå¯¹å®¹å™¨ä½œå¢åŠ æˆ–åˆ é™¤æ“ä½œï¼Œæˆ–è€…ä½¿ç”¨å¤šçº¿ç¨‹æ“ä½œã€‚</p>
</blockquote>
<blockquote>
<p>ğŸ”¹ <strong>è¯´æ˜</strong>ï¼š<br>HashMapçš„<strong>Iterator</strong>æ˜¯<strong><em>fail-fast</em></strong>è¿­ä»£å™¨ã€‚æ¯æ¬¡å‘ç”Ÿç»“æ„æ€§å˜åŒ–æ—¶modCountéƒ½ä¼šå¢åŠ ï¼Œè€Œæ¯æ¬¡è¿­ä»£å™¨æ“ä½œæ—¶éƒ½ä¼šæ£€æŸ¥expectedModCountæ˜¯å¦ä¸modCountç›¸åŒï¼Œè¿™æ ·å°±èƒ½æ£€æµ‹å‡ºç»“æ„æ€§å˜åŒ–ã€‚å½“æœ‰å…¶ä»–çº¿ç¨‹æ”¹å˜äº†HashMapçš„ç»“æ„ï¼ˆå¢åŠ ã€åˆ é™¤ã€ä¿®æ”¹å…ƒç´ ï¼‰ï¼Œå°†ä¼šæŠ›å‡ºConcurrentModificationExceptidonã€‚</p>
</blockquote>
<blockquote>
<p>ğŸ”¹ <strong>è§£å†³æ–¹æ³•</strong>ï¼š<br>åœ¨éå†çš„è¿‡ç¨‹ä¸­æŠŠéœ€è¦åˆ é™¤çš„å¯¹è±¡ä¿å­˜åˆ°ä¸€ä¸ªé›†åˆä¸­ï¼Œç­‰éå†ç»“æŸåå†è°ƒç”¨removeAllæ–¹æ³•æ¥åˆ é™¤ï¼Œæˆ–è€…é€šè¿‡Iteratorçš„remove()æ–¹æ³•ç§»é™¤å…ƒç´ ã€‚</p>
</blockquote>
</li>
</ul>
<p>ã€€ã€€</p>
<hr>
<p>å‚è€ƒï¼š</p>
<ul>
<li>HashMapæ‰©å®¹éƒ¨åˆ†ï¼š<a href="https://book.douban.com/subject/35689618/">ã€ŠJavaé«˜å¹¶å‘ä¸é›†åˆæ¡†æ¶ï¼šJCFå’ŒJUCæºç åˆ†æä¸å®ç°ã€‹</a></li>
<li>å†…å­˜ç»“æ„ç¤ºæ„å›¾éƒ¨åˆ†ï¼š<a href="https://book.douban.com/subject/30133440/">ã€ŠJavaç¼–ç¨‹çš„é€»è¾‘ã€‹</a></li>
</ul>
</div></article><div class="post-view__sidebar"><div class="sidebar"><div class="tocbot"><h2>Toc</h2><div class="toc__content"></div></div><h2>Links</h2><div class="sidebar__link"><ul><li><a href="https://github.com/equnee">Github</a></li><li><a href="https://codepen.io/equne">Codepen</a></li><li><a href="mailto:equne@qq.com">Mail</a></li></ul></div><h2>Friends</h2><div class="sidebar__friend"></div><h2>Archives</h2><div class="sidebar__archives"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/">2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/">2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/">2020</a></li></ul></div><h2>Categories</h2><div class="sidebar__categories"><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Java%E5%9F%BA%E7%A1%80/">JavaåŸºç¡€</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%B7%A5%E5%85%B7/">å·¥å…·</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">æ•°æ®ç»“æ„</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">è®¾è®¡æ¨¡å¼</a></li></ul></div><h2>Tags</h2><div class="sidebar__tags"><ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Chain/" rel="tag">Chain</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HashMap/" rel="tag">HashMap</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/I-O/" rel="tag">I/O</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mac/" rel="tag">Mac</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Markdown/" rel="tag">Markdown</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mermaid/" rel="tag">Mermaid</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/singleton/" rel="tag">singleton</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/windows/" rel="tag">windows</a></li></ul></div></div></div></div><div class="horizontal-line" style="height: 1px"></div><div class="main__bottom"><div class="pre-next"><a class="pre-button" href="/note/Basics/IO/IO_RandomAccessFile/">IO - RandomAccessFile ä»»æ„è®¿é—®æ–‡ä»¶</a><a class="next-button" href="/note/Design-pattern/design-pattern_Chain_of_Responsibility/">ğŸŒ·ã€Šç§’æ‡‚è®¾è®¡æ¨¡å¼ã€‹â€”â€” è´£ä»»é“¾æ¨¡å¼</a></div><div id="comments"></div></div></div></div><div class="footer"><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span>Â©ï¸2019-2023 Author By  <b><a class="link" href="https://github.com/equnee">equne</a></b></span><span>&nbsp;Powered By <b><a class="link" href="https://hexo.io/zh-cn/">hexo  </a></b></span><script type="text/javascript" id="maid-script" src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script><script>if (window.mermaid) {
  var options = JSON.parse(document.getElementById('maid-script').getAttribute('mermaidoptioins'));
  mermaid.initialize({
    theme: 'neutral',
    fontFamily: 'Noto Serif SC',
    startOnLoad: 'true'
  });
}</script></div><div class="darkmode-mask" id="darkmode-mask"></div><div class="sidebar__button"></div></body></html>