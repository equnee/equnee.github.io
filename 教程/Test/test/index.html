<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=0"><meta name="description" content="在Mac上使用 Microsoft Remote Desktop 连接到windows计算机 [ PEACH ] "><meta name="theme-color"><title>在Mac上使用 Microsoft Remote Desktop 连接到windows计算机 [ PEACH ] </title><link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/css/index.css"><script src="https://cdn.bootcss.com/highlight.js/9.6.0/highlight.min.js" defer></script><script src="/js/paper.js" defer></script><script src="https://www.googletagmanager.com/gtag/js?id=G-5GZQ6P3RMX" async></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-5GZQ6P3RMX');</script><script src="https://www.unpkg.com/valine/dist/Valine.min.js" defer></script><script>window.addEventListener('DOMContentLoaded', () => {
  new Valine({
    el: '#comments',
    appId: 'MJAdR7lH7cWVJLyn1Tgnw5Sj-gzGzoHsz',
    appKey: 'de2VP0VpE5bWgR2aA8wkwxn2',
    notify: false,
    verify: false,
    avatar: 'mp',
    placeholder: 'say something',
  })
})</script><script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js" defer></script><script>window.addEventListener('DOMContentLoaded', () => {
  tocbot.init({
    // Where to render the table of contents.
    tocSelector: '.toc__content',
    // Where to grab the headings to build the table of contents.
    contentSelector: '.article__content',
    // Which headings to grab inside of the contentSelector element.
    headingSelector: 'h1, h2, h3, h4, h5, h6',
    // For headings inside relative or absolute positioned containers within content.
    hasInnerContainers: true,
    orderedList: false,
    collapseDepth: 2,
  });
})</script><link rel="preload" href="https://cdn.bootcss.com/highlight.js/9.6.0/styles/github.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><link rel="stylesheet" href="https://cdn.bootcss.com/highlight.js/9.6.0/styles/github.min.css"><link rel="preload" href="https://fonts.googleapis.com/css?family=Abril+Fatface&amp;display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface&amp;display=swap"><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css"><meta name="generator" content="Hexo 5.4.0"></head><body><div class="mask-border"></div><div class="head"><div class="head__inner"><h1><a href="/">PEACH</a></h1><p>equne</p></div></div><div class="paper-container"><div class="main"><div class="location-bar"><div class="line-1"><div class="horizontal-line" style="height: 3px"></div></div><div class="line-2"><div class="horizontal-line" style="height: 1px"></div></div><p class="text">在Mac上使用 Microsoft Remote Desktop 连接到windows计算机</p><div class="switch-button"><input class="container_toggle" type="checkbox" id="switch" name="mode"><label for="switch">Toggle</label></div><div class="line-3"><div class="horizontal-line" style="height: 1px"></div></div></div><div class="main__2-col"><article class="post-view__article"><div class="article__infomation"><div class="posts-item"><h2 class="posts-item__title"><a href="">在Mac上使用 Microsoft Remote Desktop 连接到windows计算机</a></h2><span class="post__date">2022-04-12</span><a href="/tags/windows/"><span class="post__tags">#windows</span></a><a href="/tags/Mac/"><span class="post__tags">#Mac</span></a></div></div><div class="article__content"><blockquote>
<p><strong>摘要</strong>: 同时带两台电脑出门很麻烦，于是选择在Mac上使用 Microsoft Remote Desktop 远程连接使用不带出门的 Windows，从此只需要把Windows连接电源和wifi一直放着就行！顺便整理了一些别人遇到的错误和解决方法。</p>
<p><strong>参考:</strong>  <a target="_blank" rel="noopener" href="https://www.v2ex.com/t/629651"><strong>参考1</strong></a> 、<a target="_blank" rel="noopener" href="https://blog.csdn.net/javanbme/article/details/114988821"><strong>参考2</strong></a></p>
<p>*<em>日期 *</em>: 2021/3/25 </p>
<p><strong>环境</strong> : MacOS 11.2.2 + Windows10 <em>（ 本文介绍 mac 控制 windows, 其他系统同理**）</em></p>
</blockquote>
<hr>
<h1 id="一、下载和安装"><a href="#一、下载和安装" class="headerlink" title="一、下载和安装"></a>一、下载和安装</h1><h3 id="1-下载"><a href="#1-下载" class="headerlink" title="1. 下载"></a>1. 下载</h3><blockquote>
<p>下载 Microsoft Remote Desktop，根据情况下载对应版本的app：</p>
</blockquote>
<ol>
<li>使用 <strong>Windows</strong> 控制 windows：&gt;<a target="_blank" rel="noopener" href="https://www.microsoft.com/en-us/download/confirmation.aspx?id=50042">&gt; 官网下载</a></li>
<li>使用 <strong>Mac</strong> 控制 windows：<ul>
<li>App Store 下载，仅国外的应用商店提供下载，因此只能使用国外的 AppleID，可参考&gt; <a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/49754407?utm_source=com.vivo.favorite">&gt; 国外AppleID申请方法</a>。</li>
<li>其他渠道下载（俺也没试过</li>
</ul>
</li>
</ol>
<h3 id="2-安装"><a href="#2-安装" class="headerlink" title="2. 安装"></a>2. 安装</h3><p>过程略。</p>
<hr>
<h1 id="二、连接"><a href="#二、连接" class="headerlink" title="二、连接"></a>二、连接</h1><h3 id="1-Windows-配置"><a href="#1-Windows-配置" class="headerlink" title="1. Windows 配置"></a>1. Windows 配置</h3><blockquote>
<p>首先确保将被控制的 Windows 开启了远程桌面连接配置：</p>
</blockquote>
<h4 id="1-1-设置了系统属性为允许远程桌面连接"><a href="#1-1-设置了系统属性为允许远程桌面连接" class="headerlink" title="1.1 设置了系统属性为允许远程桌面连接"></a>1.1 <strong>设置了系统属性为允许远程桌面连接</strong></h4><p>若选项都是灰色无法允许远程连接，<a target="_blank" rel="noopener" href="https://answers.microsoft.com/zh-hans/windows/forum/all/win10专业版远程/55314ea4-0198-4df2-9378-7130b62d80b9">参考这里</a>。</p>
<h4 id="1-2-设置了防火墙允许远程桌面通过防火墙通信"><a href="#1-2-设置了防火墙允许远程桌面通过防火墙通信" class="headerlink" title="1.2 设置了防火墙允许远程桌面通过防火墙通信"></a>1.2 <strong>设置了防火墙允许远程桌面通过防火墙通信</strong></h4><h4 id="1-3-开启了用于远程桌面连接的服务端口"><a href="#1-3-开启了用于远程桌面连接的服务端口" class="headerlink" title="1.3 开启了用于远程桌面连接的服务端口"></a>1.3 <strong>开启了用于远程桌面连接的服务端口</strong></h4><ul>
<li>查看默认端口号3389是否开启：cmd中输入 <code>netstat -aon|findstr 3389</code></li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/1300106/1617099886709-c74312d0-4cba-426e-b36a-2806e5a3575f.png" alt="img"></p>
<ul>
<li>若端口号未开启，则打开服务，开启下面两项服务。（第三个可播放声音)</li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/1300106/1616606429680-5b49936f-40ba-489f-81aa-c45d8e24c4d5.png" alt="img"></p>
<ul>
<li>​    （若修改过或无法查询到3389端口，<a target="_blank" rel="noopener" href="https://my.oschina.net/xxxasec/blog/4837755">参考这里</a>。）</li>
</ul>
<ol start="4">
<li><strong>设置本地策略非来宾</strong></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><code class="hljs plaintext">*gpedit.msc*<br></code></pre></td></tr></table></figure>

<p><img src="https://cdn.nlark.com/yuque/0/2021/png/1300106/1616612670866-7ae21008-7851-4f4c-8681-51fcea3be2b2.png" alt="img"></p>
<ol start="5">
<li><p><strong>关闭了设置内 仅允许 Windows hello 登录</strong></p>
<p>(未设置可忽略。) Windows Hello：使您可以使用脸部，虹膜，指纹或PIN登录设备，应用程序，在线服务和网络。<img src="https://cdn.nlark.com/yuque/0/2021/png/1300106/1616608073990-ba76da08-c50e-4066-b486-1150ee16d177.png" alt="img"></p>
</li>
<li><p><strong>确保不是通过</strong> <strong>Microsoft Authenticator ，而是通过手动输入密码进行验证登录的</strong></p>
<p>因为 Microsoft Authenticator 登录使用的认证方式与其他域不互通，就不能直接开启连接啦。</p>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/1300106/1617098381888-06a4fd88-6d57-429a-9129-68e15a23da35.png" alt="img"></p>
</li>
</ol>
<h3 id="2-添加计算机"><a href="#2-添加计算机" class="headerlink" title="2. 添加计算机"></a>2. 添加计算机</h3><blockquote>
<p>配置Windows允许远程桌面连接后，使用Mac准备开始连接，在Microsoft Remote Desktop中添加PC，输入主机名 + 用户账号信息。</p>
</blockquote>
<ul>
<li><p><strong>PC name</strong>：IP地址。</p>
<p>查看方法：在 Windows 的命令提示符(win+R 键打开的运行窗口输入cmd) 输入命令 <code>ipconfig</code>，可查看ipv4地址。</p>
</li>
<li><p><strong>User account</strong>：登录该PC的账号密码。建议选择 Ask when required，先不输入账号密码，在连接时输入，确保能连接成功后再添加记录，防止这里保存的账号密码有误，后面怎么都连不上。</p>
</li>
</ul>
</div></article><div class="post-view__sidebar"><div class="sidebar"><div class="tocbot"><h2>Toc</h2><div class="toc__content"></div></div><h2>Links</h2><div class="sidebar__link"><ul><li><a target="_blank" rel="noopener" href="https://github.com/equnee">Github</a></li><li><a target="_blank" rel="noopener" href="http://equne.zcool.com.cn/">ZCool</a></li><li><a target="_blank" rel="noopener" href="https://codepen.io/equne">Codepen</a></li><li><a target="_blank" rel="noopener" href="https://dribbble.com/equnee">Dribbble</a></li><li><a target="_blank" rel="noopener" href="https://juejin.im/user/4051036080446142">掘金</a></li><li><a href="mailto:equne@qq.com">Mail</a></li></ul></div><h2>Friends</h2><div class="sidebar__friend"><ul><li><a target="_blank" rel="noopener" href="http://wh1te.fun/">white</a></li><li><a target="_blank" rel="noopener" href="https://tujiaoblog.com/">tujiao</a></li></ul></div><h2>Archives</h2><div class="sidebar__archives"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/">2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/">2020</a></li></ul></div><h2>Categories</h2><div class="sidebar__categories"><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/wp/">wp</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%99%E7%A8%8B/">教程</a></li></ul></div><h2>Tags</h2><div class="sidebar__tags"><ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mac/" rel="tag">Mac</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/" rel="tag">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/windows/" rel="tag">windows</a></li></ul></div></div></div></div><div class="horizontal-line" style="height: 1px"></div><div class="main__bottom"><div class="pre-next"><a class="pre-button">没有更多</a><a class="next-button" href="/wp/Java/Java_Notebook/">Java_Notebook</a></div><div id="comments"></div></div></div></div><div class="footer"><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span>©️2019-2022  equne</span></div><div class="darkmode-mask" id="darkmode-mask"></div><div class="sidebar__button"></div></body></html>